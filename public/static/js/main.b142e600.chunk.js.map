{"version":3,"sources":["common/localizations/localization_it.js","common/localizations/localization_en.js","services/http_operations.js","config.js","common/locale.ts","components/languageSelector/languageSelector.tsx","components/authPage/authPage.comp.jsx","components/homePage/homePage.tsx","components/notFoundPage/notFoundPage.tsx","services/userRolesManagement.js","services/misc_functions.js","components/navigation/navigation.comp.jsx","components/actionsManager/actionsManager.jsx","components/contentTable/contentTable.jsx","components/page/page.jsx","components/profilePage/profilePage.jsx","components/unauthorizedPage/unauthorizedPage.tsx","context.jsx","components/notificationBar/notificationBar.jsx","components/horizontalNavigationBar/horizontalNavigationBar.jsx","components/formManager/formManager.jsx","services/objects_manipulation.js","components/editContentPage/editContentPage.jsx","components/formFileComp/formFile.jsx","components/addPage/addPage.jsx","components/addExperimentPage/addExperimentPage.jsx","components/addMeasurementsPage/addMeasurementsPage.jsx","App.tsx","index.js"],"names":["localization_it","username","password","tenant","keep_logged","select","language","welcome","role","session_expire_in","resources","notifications","file_content","clear_all","enter","username_suggestion","password_suggestion","tenant_suggestion","add_tenant","welcome_hp","left_bar_descr_hp","right_bar_descr_hp","session_expire_info_hp","github_page_hp","github_issue_page_hp","profile_page_desc","pass_change_confirm","pass_not_match","old_pass_empty","old_pass_wrong","pass_not_null","password_changed","oh_no","broken_link","submit","cancel","login","logout","repeat","close","login_error","unauthorised_user","session_expired","no_file","duplicate_error","localization_en","axios","require","default","https","instance","create","httpsAgent","Agent","notificationManager","PushNotification","obj","RemoveNotification","id","ClearNotifications","saveToken","body","options","headers","url_string","api_url","Promise","resolve","reject","post","then","response","localStorage","setItem","data","token","token_expiration_time","user","type","Date","getTime","toString","catch","error","refreshToken","Authorization","GetToken","put","post_file_generic","resource_type","formData","a","additionalHeader","undefined","console","log","tempH","Object","entries","forEach","k","v","name","time","toTimeString","msg","post_generic","put_generic","padStart","length","JSON","stringify","message","delete_generic","delete","statusCode","get_generic","qs","url","filter","concat","limit","page","json","get","docs","totalDocs","totalPages","pagingCounter","hasPrevPage","hasNextPage","prevPage","nextPage","getItem","website_name","languages","layout","pages","aliasPages","pageActions","viewFields","editFields","_id","description","state","NaN","startDate","endDate","manager","place","metadata","value","tags","visibility","addFields","organization","address","email","phone","admin_username","admin_password","passwordhash","topics","fields","editFieldsSpecifier","addTypes","fetchedPageTypes","status","field","fetchedPageData","guidelines","locale","tkn","navigator","substring","LanguageSelector","setSessionLanguage","window","location","reload","includes","Button","variant","onClick","userRef","React","createRef","pswRef","tenantRef","AuthPage","useState","setMsg","e","preventDefault","current","psw","replace","details","className","Form","onSubmit","Group","controlId","Label","Control","ref","placeholder","style","color","to","size","title","width","height","marginRight","opacity","HomePage","useEffect","href","target","rel","NotFoundPage","canDo","userRole","resource","action","isDefault","isNaN","Array","isArray","def","elem","constructor","nonDefaultLength","removeDefaultElements","entr","i","j","splice","subEntr","areEqual","obj1","obj2","k1","keys","k2","values","capitalize","s","toUpperCase","slice","fontawesome","library","add","faTimes","faBars","faUserTie","faUserGraduate","faUserCog","faUserTag","faUser","faCheck","intervalRef","loginTime","remainingSeconds","duration","Navigation","isOpened","setIsOpened","usr","rl","tn","CalcEnding","t0","remainingSec","retryLoginTime","parseInt","now","exp","endsWith","DurationToMilliSeconds","clearInterval","setInterval","clear","paddingLeft","paddingBottom","document","Fragment","map","navData","isActive","ActionContent","props","toShow","resType","subK","row","f","UnrollView","item","Accordion","defaultActiveKey","Children","toArray","key","Item","eventKey","Header","Body","some","single","Table","responsive","striped","bordered","hover","join","ActionManager","res","setRes","viewPopover","Popover","minWidth","test","userAgent","as","OverlayTrigger","trigger","placement","overlay","rootClose","takeSingle","confirm","removeSingle","ContentTable","header","actions","index","faEye","faPencilAlt","faCopy","faPlusCircle","Page","params","useParams","useSearchParams","searchParams","setSearchParams","setResource","setHeader","setActions","pageNum","setPageNum","pageLimit","setPageLimit","hasNext","setHasNext","hasPrev","setHasPrev","setPrevPage","setNextPage","setTotalPages","fetchData","num","RenderPagination","prevEllipsis","nextEllipsis","display","Pagination","alignSelf","marginLeft","First","disabled","Prev","Ellipsis","Next","Last","find","r","tmp","el","ProfilePage","setUsername","setRole","setTenant","oldPassword","setOldPassword","setPassword","passwordConfirm","setPasswordConfirm","submitPassword","Container","fluid","Row","Col","xs","onChange","Text","muted","UnauthorizedPage","AppContext","createContext","oldNotifications","NotificationBar","show","setShow","highlight","setHighlight","layoutRef","useRef","myNotifications","useContext","handleClose","setTimeout","errorNot","textDecoration","Badge","pill","bg","Offcanvas","backgroundColor","onHide","scroll","backdrop","keyboard","Title","ToastContainer","notification","Toast","animation","onClose","src","alt","HorizontalNavigationBar","padding","justifyContent","alignItems","FormManager","myFetched","context","fetched","disabledFields","functionalFields","submitFunction","backFunction","handleChangesCallback","arrayDeleteCallback","types","val","borderBottomStyle","borderBottomWidth","marginBottom","sm","borderRightStyle","borderRightWidth","Select","SelectFormRow","Autocomplete","newValue","renderInput","TextField","label","md","ArrayStringFormRow","idx","_k","_v","ArrayObjectFormRow","NumericFormRow","alias","FetchedFormRow","StringFormRow","cloneDeep","sortObject","template","sortingKeys","ob","indexOf","sort","b","reduce","accumulator","maintainEmptyElements","original","fieldSpecifier","copy","maintainEmptyElement","path","tmpPtr","fieldSpecifierCpy","tmpPath","push","EditContentPage","setOriginal","navigate","useNavigate","setValues","deleted","setDisabledFields","UpdateData","tmpValues","evaluateSpecifiers","_key","specsEntries","policy","resp","fst","tmpOrig","toSend","remove","update","origArr","indexes","removed","statusText","tmpVals","valuesPtr","lastIndexNumber","elements","minDel","Infinity","FormFile","setContentHeader","setContentPlain","setContentBody","setFile","contentBody","contentPlain","contentHeader","select_file","accept","file","files","fileReader","FileReader","onloadend","content","result","regex","RegExp","splitted","split","parse","readAsText","overflow","h","cols","rows","readOnly","AddPage","postType","setPostType","isError","setIsError","back","postBody","det","postFile","FormData","append","Nav","justify","onSelect","Link","borderRadius","borderStyle","borderColor","borderWidth","margin","AddExperimentPage","protocols","setProtocols","fetchDataDuplicate","tmpDisabled","handleProtocolChange","selectedProtocol","protocol","AddMeasurementsPage","samples","setSamples","items","setItems","formValues","setFormValues","features","setFeatures","feature","setFeature","handleFeatureChange","selectedFeature","addSample","tmpSample","dimension","enumValues","range","tmpSamples","sample","sampl","formValuesPtr","App","setNotifications","setTypes","setData","prev","notificationManagement","fetchTypes","fetchedManagement","element","Provider","paddingRight","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b142e600.chunk.js","sourcesContent":["const localization_it = {\r\n  username: \"Nome utente\",\r\n  password: \"Password\",\r\n  tenant: \"Organizzazione\",\r\n  keep_logged: \"Mantieni Accesso\",\r\n  select: \"Seleziona\",\r\n  language: \"Lingua\",\r\n  welcome: \"Bentornato\",\r\n  role: \"Ruolo\",\r\n  session_expire_in: \"La sessione scadrà in \",\r\n  resources: \"Risorse\",\r\n  notifications: \"Notifiche\",\r\n  file_content: \"Contenuto del file\",\r\n\r\n  clear_all: \"Cancella tutto\",\r\n\r\n  ///Completamento campi\r\n  enter: \"Inserisci\",\r\n  username_suggestion: \"Inserisci il nome utente\",\r\n  password_suggestion: \"Inserisci la password\",\r\n  tenant_suggestion: \"Inserisci la tua organizzazione\",\r\n  add_tenant: \"Aggiungi organizzazione\",\r\n\r\n  //Homepage\r\n  welcome_hp: \"Benvenuto nel pannello di controllo di Measurify!\",\r\n  left_bar_descr_hp:\r\n    \"Nella barra a sinistra sono presenti le informazioni relative al tuo account e i collegamenti alle pagine.\",\r\n  right_bar_descr_hp:\r\n    'La barra a destra può essere aperta cliccando sul pulsante \"Notifiche\" per mostrare la lista delle notifiche.',\r\n  session_expire_info_hp: ``,\r\n  github_page_hp: \"Pagina Github di Measurify\",\r\n  github_issue_page_hp: \"Segnala bug o problemi\",\r\n\r\n  //profile page\r\n  profile_page_desc:\r\n    \"questa è la pagina in cui puoi visionare il tuo profilo o modificare la password\",\r\n  pass_change_confirm: \"La password verrà modificata, procedere?\",\r\n  pass_not_match:\r\n    \"La password inserita e la conferma non combaciano, si prega di reinserirle\",\r\n  old_pass_empty: \"Per favore, inserire la vecchia password\",\r\n  old_pass_wrong: \"La vecchia password è sbagliata\",\r\n  pass_not_null: \"La password non può essere vuota\",\r\n  password_changed: \"Password cambiata\",\r\n\r\n  //404\r\n  oh_no: \"Oh No!\",\r\n  broken_link:\r\n    \"Sembra che tu abbia utilizzato un collegamento non funzionante.\",\r\n\r\n  ///Azioni\r\n  submit: \"Invio\",\r\n  cancel: \"Annulla\",\r\n  login: \"Accedi\",\r\n  logout: \"Esci\",\r\n  repeat: \"Ripeti\",\r\n  close: \"Chiudi\",\r\n\r\n  ///Errori\r\n  login_error: \"Login errata!\",\r\n  unauthorised_user: \"Non sei abilitato a utilizzare questa pagina\",\r\n  session_expired: \"Sessione scaduta\",\r\n  no_file: \"Si prega di selezionare un file\",\r\n  duplicate_error: \"Nel database è già presente una risorsa con\",\r\n};\r\n\r\nexport default localization_it;\r\n","const localization_en = {\r\n  username: \"Username\",\r\n  password: \"Password\",\r\n  tenant: \"Tenant\",\r\n  keep_logged: \"Keep Logged In\",\r\n\r\n  select: \"Select\",\r\n  language: \"Language\",\r\n  welcome: \"Welcome back\",\r\n  role: \"Role\",\r\n  session_expire_in: \"Session will expire in \",\r\n  resources: \"Resources\",\r\n  notifications: \"Notifications\",\r\n  file_content: \"File content\",\r\n\r\n  clear_all: \"Clear all\",\r\n\r\n  enter: \"Enter\",\r\n  username_suggestion: \"Insert your username\",\r\n  password_suggestion: \"Insert your password\",\r\n  tenant_suggestion: \"Insert your tenant\",\r\n  add_tenant: \"Add tenant\",\r\n\r\n  //Homepage\r\n  welcome_hp: \"Welcome to the Administration dashboard!\",\r\n  left_bar_descr_hp:\r\n    \"The left bar contains the information about your account and  the list of tabs\",\r\n  right_bar_descr_hp:\r\n    'The right bar contains the notification bar (Click on \"Notifications\" to open).',\r\n  session_expire_info_hp: \"\",\r\n  github_page_hp: \"\",\r\n  github_issue_page_hp: \"Report bugs or issues\",\r\n\r\n  //profile page\r\n  profile_page_desc:\r\n    \"from this page you can view your own profile or change the password\",\r\n  pass_change_confirm: \"Password will be changed, do you confirm?\",\r\n  pass_not_match:\r\n    \"Provided password and the confirmation do not match. Please insert them again\",\r\n  old_pass_empty: \"Please. enter old password\",\r\n  old_pass_wrong: \"The old password is wrong\",\r\n  pass_not_null: \"Password cannot be empty\",\r\n  password_changed: \"Password changed\",\r\n\r\n  //404\r\n  oh_no: \"Oh No!\",\r\n  broken_link: \"It looks like you have clicked on a broken link.\",\r\n\r\n  ///Actions\r\n  submit: \"Submit\",\r\n  cancel: \"Cancel\",\r\n  login: \"Login\",\r\n  logout: \"Logout\",\r\n  repeat: \"Repeat\",\r\n  close: \"Close\",\r\n\r\n  ///Errors\r\n  login_error: \"Wrong login!\",\r\n  unauthorised_user: \"You are not allowed to use this page\",\r\n  session_expired: \"Session expired\",\r\n  no_file: \"Please, select a file\",\r\n  duplicate_error: \"The database already contains a resource with\",\r\n};\r\n\r\nexport default localization_en;\r\n","import { api_url } from \"../config\";\r\n\r\nconst axios = require(\"axios\").default;\r\n\r\nconst https = require(\"https\");\r\n\r\nconst instance = axios.create({\r\n  httpsAgent: new https.Agent({\r\n    //unsafe, delete in prod\r\n    //rejectUnauthorized: false,\r\n  }),\r\n});\r\n\r\nexport let notificationManager = {\r\n  PushNotification: (obj) => {},\r\n  RemoveNotification: (id) => {},\r\n  ClearNotifications: () => {},\r\n};\r\n\r\n//login\r\nexport function login(username, password, tenant, saveToken = true) {\r\n  const body = {\r\n    username: `${username}`,\r\n    password: `${password}`,\r\n    tenant: `${tenant}`,\r\n  };\r\n  const options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      //Authorization: GetToken(),\r\n    },\r\n  };\r\n\r\n  const url_string = api_url + \"/login\";\r\n\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .post(url_string, body, options)\r\n      .then((response) => {\r\n        if (saveToken === true) {\r\n          localStorage.setItem(\"token\", response.data.token);\r\n          localStorage.setItem(\r\n            \"token-expiration-time\",\r\n            response.data.token_expiration_time\r\n          );\r\n          localStorage.setItem(\"username\", response.data.user.username);\r\n          localStorage.setItem(\"user-role\", response.data.user.type);\r\n          localStorage.setItem(\"user-tenant\", tenant);\r\n          localStorage.setItem(\"login-time\", new Date().getTime().toString());\r\n        }\r\n        resolve(response);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n}\r\n\r\n//refresh token\r\nexport function refreshToken() {\r\n  const options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      Authorization: GetToken(),\r\n    },\r\n  };\r\n\r\n  const url_string = api_url + \"/login\";\r\n\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .put(url_string, {}, options)\r\n      .then((response) => {\r\n        localStorage.setItem(\"token\", response.data.token);\r\n        localStorage.setItem(\"login-time\", new Date().getTime().toString());\r\n        localStorage.setItem(\r\n          \"token-expiration-time\",\r\n          response.data.token_expiration_time\r\n        );\r\n        resolve(response);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n}\r\n\r\n//this function post a single thing inside the DB\r\nexport function postThing(thingId, pt_options = {}) {\r\n  const body = { _id: thingId };\r\n  return new Promise((resolve, reject) => {\r\n    post_generic(\"things\", body, pt_options)\r\n      .then((response) => {\r\n        resolve(response);\r\n      })\r\n      .catch((error) => {\r\n        reject(error);\r\n      });\r\n  });\r\n}\r\n\r\n// This function checks if a thing (i.e., trip) is already in the DB\r\n// If not in, create one\r\nexport function checkThingAlreadyIn(thingId) {\r\n  const url = api_url + \"/things/\" + thingId;\r\n  const options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      \"cache-control\": \"no-cache\",\r\n      Authorization: GetToken(),\r\n    },\r\n  };\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .get(url, options)\r\n      .then((request) => {\r\n        //thing found in database\r\n        if (request.status === 200) resolve({ found: true });\r\n      })\r\n      .catch((error) => {\r\n        //thing not found in database\r\n        if (error.response.status === 404) {\r\n          resolve({ found: false });\r\n        }\r\n        /*else {\r\n          reject(false);\r\n        }*/\r\n      });\r\n  });\r\n}\r\n\r\nexport async function post_file_generic(\r\n  resource_type,\r\n  formData,\r\n  additionalHeader = {},\r\n  token = undefined\r\n) {\r\n  if (token === undefined) token = GetToken();\r\n  const url_string = api_url + \"/\" + resource_type + \"/file\";\r\n\r\n  console.log(\"POST file:\" + url_string);\r\n\r\n  const tempH = {\r\n    \"Content-Type\": \"multipart/form-data\",\r\n    \"Cache-Control\": \"no-cache\",\r\n    Authorization: token,\r\n  };\r\n\r\n  Object.entries(additionalHeader).forEach(([k, v]) => {\r\n    tempH[k] = v;\r\n  });\r\n  const options = {\r\n    headers: tempH,\r\n  };\r\n\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .post(url_string, formData, options)\r\n      .then((response) => {\r\n        notificationManager.PushNotification({\r\n          name: \"info\",\r\n          time: new Date().toTimeString(),\r\n          msg: \"Successful POST of file on: \" + resource_type,\r\n        });\r\n\r\n        resolve({ response: response }); //true;\r\n      })\r\n      .catch((error) => {\r\n        notificationManager.PushNotification({\r\n          name: \"error\",\r\n          time: new Date().toTimeString(),\r\n          msg: \"Error doing a POST of file on: \" + resource_type,\r\n        });\r\n        reject({ error: error }); //false;\r\n      });\r\n  });\r\n}\r\n\r\nexport async function post_generic(resource_type, body, token = undefined) {\r\n  if (token === undefined) token = GetToken();\r\n  const url_string = api_url + \"/\" + resource_type + \"/\";\r\n\r\n  console.log(\"POST :\" + url_string);\r\n\r\n  const options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      Authorization: token,\r\n    },\r\n  };\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .post(url_string, body, options)\r\n      .then((response) => {\r\n        notificationManager.PushNotification({\r\n          name: \"info\",\r\n          time: new Date().toTimeString(),\r\n          msg: \"Successful POST of a resource type: \" + resource_type,\r\n        });\r\n\r\n        resolve({ response: response }); //true;\r\n      })\r\n      .catch((error) => {\r\n        notificationManager.PushNotification({\r\n          name: \"error\",\r\n          time: new Date().toTimeString(),\r\n          msg: \"Error doing a POST of a resource type: \" + resource_type,\r\n        });\r\n        reject({ error: error }); //false;\r\n      });\r\n  });\r\n}\r\n\r\nexport async function put_generic(resource_type, body, id, token = undefined) {\r\n  const url_string = api_url + \"/\" + resource_type + \"/\" + id;\r\n  if (token === undefined) token = GetToken();\r\n\r\n  console.log(\"PUT :\" + url_string);\r\n\r\n  const options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      Authorization: token,\r\n    },\r\n  };\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .put(url_string, body, options)\r\n      .then((response) => {\r\n        //obscure password in notification bar\r\n        if (body[\"password\"] !== undefined)\r\n          body[\"password\"] = \"\".padStart(body[\"password\"].length, \"*\");\r\n\r\n        notificationManager.PushNotification({\r\n          name: \"info\",\r\n          time: new Date().toTimeString(),\r\n          msg:\r\n            \"Successful PUT of a resource type: \" +\r\n            resource_type +\r\n            \", id: \" +\r\n            id +\r\n            \", body: \" +\r\n            JSON.stringify(body),\r\n        });\r\n\r\n        resolve({ response: response }); //true;\r\n      })\r\n      .catch((error) => {\r\n        //obscure password in notification bar\r\n        if (body[\"password\"] !== undefined)\r\n          body[\"password\"] = \"\".padStart(body[\"password\"].length, \"*\");\r\n\r\n        notificationManager.PushNotification({\r\n          name: \"error\",\r\n          time: new Date().toTimeString(),\r\n          msg:\r\n            \"Error doing a PUT on resource type: \" +\r\n            resource_type +\r\n            \", id: \" +\r\n            id +\r\n            \", body: \" +\r\n            JSON.stringify(body) +\r\n            \". \" +\r\n            error.message,\r\n        });\r\n\r\n        reject({ error: error }); //false;\r\n      });\r\n  });\r\n}\r\n\r\nexport async function delete_generic(resource_type, id, token = undefined) {\r\n  let url_string = api_url + \"/\" + resource_type;\r\n  if (token === undefined) token = GetToken();\r\n  if (id !== undefined) {\r\n    url_string += \"/\" + id;\r\n  }\r\n  console.log(\"DELETE :\" + url_string);\r\n\r\n  //url: url_string;\r\n  let options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      Authorization: token,\r\n    },\r\n  };\r\n\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .delete(url_string, options)\r\n      .then((response) => {\r\n        if (id !== undefined) {\r\n          notificationManager.PushNotification({\r\n            name: \"info\",\r\n            time: new Date().toTimeString(),\r\n            msg: \"Deleted resource: \" + id + \", of type: \" + resource_type,\r\n          });\r\n        } else {\r\n          notificationManager.PushNotification({\r\n            name: \"info\",\r\n            time: new Date().toTimeString(),\r\n            msg: \"Deleted resources of type: \" + resource_type,\r\n          });\r\n        }\r\n        resolve({ response: response }); //true;\r\n      })\r\n      .catch((error) => {\r\n        notificationManager.PushNotification({\r\n          name: \"error\",\r\n          time: new Date().toTimeString(),\r\n          msg:\r\n            \"error deleting resource: \" +\r\n            id +\r\n            \", of type: \" +\r\n            resource_type +\r\n            \". \" +\r\n            error.message,\r\n        });\r\n        if (error.statusCode === 404) {\r\n          //Not found\r\n          notificationManager.PushNotification({\r\n            name: \"error\",\r\n            time: new Date().toTimeString(),\r\n            msg:\r\n              \"Please check if your user is authorized to delete the resource. \" +\r\n              error.message,\r\n          });\r\n        }\r\n\r\n        reject({ error: error }); //false;\r\n      });\r\n  });\r\n}\r\n\r\nexport async function get_generic(resource_type, qs = {}, token) {\r\n  let url = api_url + \"/\" + resource_type + \"/\";\r\n  if (token === undefined) token = GetToken();\r\n\r\n  if (qs.filter !== undefined) {\r\n    url = url.concat(\"?filter=\" + qs.filter);\r\n  } else {\r\n    url = url.concat(\"?filter=\");\r\n  }\r\n  if (qs.limit !== undefined) {\r\n    url = url.concat(\"&limit=\" + qs.limit);\r\n  }\r\n  if (qs.page !== undefined) {\r\n    url = url.concat(\"&page=\" + qs.page);\r\n  }\r\n\r\n  console.log(\"GET :\" + url);\r\n\r\n  let options = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      \"Cache-Control\": \"no-cache\",\r\n      Authorization: token,\r\n    },\r\n\r\n    json: true,\r\n  };\r\n  return new Promise((resolve, reject) => {\r\n    instance\r\n      .get(url, options)\r\n      .then((response) => {\r\n        resolve({\r\n          response: response,\r\n          docs: response.data.docs,\r\n          totalDocs: response.data.totalDocs,\r\n          limit: response.data.limit,\r\n          totalPages: response.data.totalPages,\r\n          page: response.data.page,\r\n          pagingCounter: response.data.pagingCounter,\r\n          hasPrevPage: response.data.hasPrevPage,\r\n          hasNextPage: response.data.hasNextPage,\r\n          prevPage: response.data.prevPage,\r\n          nextPage: response.data.nextPage,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        /*commons.PushMsg({\r\n          type: \"error\",\r\n          msg:\r\n            \"Error getting resource(s) of type: \" +\r\n            resource_type +\r\n            \", with filter: \" +\r\n            qs.limit +\r\n            \". \" +\r\n            error.message,\r\n        });*/\r\n        reject({ error: error });\r\n      });\r\n  });\r\n}\r\n\r\n//return the login token from the localstorage\r\nfunction GetToken() {\r\n  return localStorage.getItem(\"token\");\r\n}\r\n","import { isFeatureInUse, alwaysTrue } from \"./services/validations\";\r\n\r\n//url of APIs\r\nexport const api_url = \"https://hi-drive.measurify.org/v1\";\r\n//export const api_url = \"https://localhost/v1\";\r\n\r\n//name of this dashboard, shown to users\r\nexport const website_name = \"Admin Dashboard\";\r\n\r\n//languages enabled for this GUI, only english \"en\" and italian \"it\" are supported with this version\r\n//if no languages are enabled, the GUI will be localized in english\r\n//export const languages = [\"en\", \"it\"];\r\nexport const languages = [];\r\n\r\n//gui layout\r\n// options are \"horizontal\" or \"vertical\"\r\nexport const layout = \"vertical\";\r\n\r\n//dictionary of pages: key is the route for the API REST, value is an array that contains the fields shown to users\r\n//action is a special field that will enable actions for each row || still required, future version may have it removed\r\nexport const pages = {};\r\npages[\"users\"] = [\"username\", \"type\", \"actions\"];\r\n//pages[\"tags\"] = [\"_id\", \"actions\"];\r\n//pages[\"things\"] = [\"_id\", \"actions\"];\r\n//pages[\"features\"] = [\"_id\", \"actions\"];\r\n//pages[\"devices\"] = [\"_id\", \"tags\", \"actions\"];\r\npages[\"protocols\"] = [\"_id\", \"description\", \"actions\"];\r\npages[\"experiments\"] = [\"_id\", \"description\", \"protocol\", \"actions\"];\r\n/*pages[\"measurements\"] = [\r\n  \"thing\",\r\n  \"feature\",\r\n  \"device\",\r\n  \"startDate\",\r\n  \"tags\",\r\n  \"actions\",\r\n];*/\r\n\r\n//alias dictionary: key is the page, value are object with pairs of the fields that will be renamed into page table header (\"key\" is renamed as \"value\")\r\nexport const aliasPages = {};\r\n//aliasPages[\"features\"] = { _id: \"Feature Name\", actions: \"Actions\" };\r\n//aliasPages[\"tags\"] = { _id: \"Tag Name\", actions: \"Actions\" };\r\n//aliasPages[\"devices\"] = { _id: \"Device Name\", actions: \"Actions\" };\r\n\r\n//actions dictionary: key is the page, value is an array that contains actions || working actions arae \"view\" | \"edit\" | \"delete\" | \"duplicate\"\r\nexport const pageActions = {};\r\n///pageActions[\"features\"] = [\"view\", \"edit\", \"duplicate\", \"delete\"];\r\npageActions[\"users\"] = [\"view\", \"delete\"];\r\n//pageActions[\"things\"] = [\"view\", \"delete\"];\r\n//pageActions[\"tags\"] = [\"view\", \"edit\", \"delete\"];\r\n//pageActions[\"devices\"] = [\"view\", \"edit\", \"delete\"];\r\npageActions[\"protocols\"] = [\"view\", \"delete\"];\r\npageActions[\"experiments\"] = [\"view\", \"delete\"]; //\"edit\", \"duplicate\",\r\n//pageActions[\"measurements\"] = [\"view\", \"edit\", \"delete\"];\r\n\r\n//view dictionary: key is the page, value is an array that contains the fields shown to the user with \"view\" action\r\nexport const viewFields = {};\r\nviewFields[\"users\"] = [\"username\", \"type\", \"actions\", \"fieldmask\", \"status\"];\r\n/*viewFields[\"features\"] = [\r\n  { items: [\"name\", \"type\", \"unit\", \"dimension\"] },\r\n  \"tags\",\r\n];\r\nviewFields[\"tags\"] = [\"tags\"];\r\nviewFields[\"things\"] = [\"_id\", \"visibility\", \"tags\"];\r\nviewFields[\"devices\"] = [\"_id\", \"features\", \"tags\", \"scripts\"];*/\r\nviewFields[\"protocols\"] = [\"_id\", \"description\", \"metadata\"];\r\nviewFields[\"experiments\"] = [\r\n  \"_id\",\r\n  \"description\",\r\n  \"state\",\r\n  \"startDate\",\r\n  \"endDate\",\r\n  \"manager\",\r\n  \"place\",\r\n  \"protocol\",\r\n  \"metadata\",\r\n];\r\n/*viewFields[\"measurements\"] = [\r\n  \"thing\",\r\n  \"feature\",\r\n  \"device\",\r\n  \"startDate\",\r\n  \"visibility\",\r\n  \"tags\",\r\n  \"samples\",\r\n];*/\r\n\r\n//edit dictionary: key is the page, value is an array that contains the fields that can be edited with \"edit\" action\r\n//fields should be specified in the same format of the object that will be represented:\r\n// - key:\"\" for an string field,\r\n// - key:NaN for a numeric field\r\n// - key:[\"\"] for an array of string\r\n// - key:[{subKey1:\"\",subkey2:\"\"}] for an array of object with 2 keys each whose value is a string\r\n\r\nexport const editFields = {};\r\n\r\neditFields[\"experiments\"] = {\r\n  _id: \"\",\r\n  description: \"\",\r\n  state: NaN,\r\n  startDate: \"\",\r\n  endDate: \"\",\r\n  manager: \"\",\r\n  place: [{ name: \"\" }],\r\n  metadata: [{ name: \"\", value: \"\" }],\r\n  tags: [\"\"],\r\n  visibility: \"\",\r\n};\r\n\r\n/*editFields[\"features\"] = {\r\n  _id: \"\",\r\n  items: [{ name: \"\", type: \"\", unit: \"\", dimension: NaN }],\r\n  tags: [\"\"],\r\n};\r\neditFields[\"tags\"] = {\r\n  tags: [\"\"],\r\n};\r\neditFields[\"devices\"] = { visibility: \"\", tags: [\"\"] };\r\neditFields[\"measurements\"] = { tags: [\"\"] };*/\r\n//add dictionary: key is the page, value is an array that contains the fields that can will be used to post the entity\r\n//fields should be specified in the same format of the objet that will be represented:\r\n// - key:\"\" for an string field,\r\n// - key:NaN for a numeric field\r\n// - key:[\"\"] for an array of string\r\n// - key:[{subKey1:\"\",subkey2:\"\"}] for an array of object with 2 keys each whose value is a string\r\n\r\nexport const addFields = {};\r\naddFields[\"tenants\"] = {\r\n  token: \"\",\r\n  _id: \"\",\r\n  organization: \"\",\r\n  address: \"\",\r\n  email: \"\",\r\n  phone: \"\",\r\n  admin_username: \"\",\r\n  admin_password: \"\",\r\n  passwordhash: \"\",\r\n};\r\n/*addFields[\"tags\"] = { _id: \"\", tags: [\"\"] };\r\naddFields[\"things\"] = { _id: \"\", visibility: \"\", tags: [\"\"] };\r\naddFields[\"features\"] = {\r\n  _id: \"\",\r\n  items: [{ name: \"\", type: \"\", unit: \"\", dimension: NaN, range: [\"\"] }],\r\n  tags: [\"\"],\r\n};\r\n\r\n\r\naddFields[\"devices\"] = {\r\n  _id: \"\",\r\n  features: [\"\"],\r\n};\r\n*/\r\naddFields[\"users\"] = { username: \"\", password: \"\", type: \"\" };\r\naddFields[\"protocols\"] = {\r\n  _id: \"\",\r\n  description: \"\",\r\n  metadata: [\r\n    {\r\n      name: \"\",\r\n      description: \"\",\r\n      type: \"\",\r\n    },\r\n  ],\r\n  topics: [\r\n    {\r\n      name: \"\",\r\n      description: \"\",\r\n      fields: [{ name: \"\", description: \"\", type: \"\" }],\r\n    },\r\n  ],\r\n};\r\n\r\n//NOTE: experiments page works differently, so keep it empty\r\naddFields[\"experiments\"] = {\r\n  _id: \"\",\r\n  description: \"\",\r\n  state: NaN,\r\n  startDate: \"\",\r\n  endDate: \"\",\r\n  manager: \"\",\r\n  place: [{ name: \"\" }],\r\n};\r\n\r\n//NOTE: measurements page works differently, so keep it empty\r\n/*addFields[\"measurements\"] = {\r\n  thing: \"\",\r\n  device: \"\",\r\n  tags: [\"\"],\r\n};*/\r\n\r\n//edit fields specifiers dictionary\r\n//this dictionary allow to specify particular behaviour for input fields, that can be managed by a specific function\r\n// type can be \"disable\" -> policy is applied to fields to be disabled, true when field should be disabled\r\n//\r\nexport const editFieldsSpecifier = {};\r\n/*editFieldsSpecifier[\"features\"] = {\r\n  _id: { type: \"disable\", policy: isFeatureInUse },\r\n  items: { type: \"disable\", policy: isFeatureInUse },\r\n};*/\r\n\r\n//dictionary to select the way to post entity/ies, it's an array which can contain \"form\", \"file\", or both\r\nexport const addTypes = {};\r\n//addTypes[\"tags\"] = [\"form\", \"file\"];\r\n//addTypes[\"things\"] = [\"form\", \"file\"];\r\n//addTypes[\"features\"] = [\"form\", \"file\"];\r\naddTypes[\"users\"] = [\"form\", \"file\"];\r\n//addTypes[\"devices\"] = [\"form\", \"file\"];\r\naddTypes[\"tenants\"] = [\"form\"];\r\naddTypes[\"protocols\"] = [\"form\", \"file\"];\r\naddTypes[\"experiments\"] = [\"form\", \"file\"];\r\n//addTypes[\"measurements\"] = [\"form\"];\r\n\r\n//dictionary for fetched types\r\n//types are fetched on the /types route and matched with fields following this dictionary\r\nexport const fetchedPageTypes = {};\r\nfetchedPageTypes[\"users\"] = { type: \"UserRoles\", status: \"UserStatusTypes\" };\r\n/*fetchedPageTypes[\"devices\"] = {\r\n  measurementBufferPolicy: \"MeasurementBufferPolicyTypes\",\r\n  visibility: \"VisibilityTypes\",\r\n};\r\nfetchedPageTypes[\"things\"] = {\r\n  visibility: \"VisibilityTypes\",\r\n};\r\nfetchedPageTypes[\"tag\"] = {\r\n  visibility: \"VisibilityTypes\",\r\n};\r\nfetchedPageTypes[\"things\"] = {\r\n  visibility: \"VisibilityTypes\",\r\n};\r\nfetchedPageTypes[\"scripts\"] = {\r\n  visibility: \"VisibilityTypes\",\r\n};\r\nfetchedPageTypes[\"rights\"] = {\r\n  type: \"RightTypes\",\r\n};\r\nfetchedPageTypes[\"features\"] = {\r\n  items: { type: \"ItemTypes\" },\r\n};\r\nfetchedPageTypes[\"measurements\"] = {\r\n  visibility: \"VisibilityTypes\",\r\n};\r\nfetchedPageTypes[\"issues\"] = {\r\n  type: \"IssueTypes\",\r\n  status: \"IssueStatusType\",\r\n};*/\r\nfetchedPageTypes[\"protocols\"] = {\r\n  metadata: { type: \"MetadataTypes\" },\r\n  field: { type: \"TopicFieldTypes\" },\r\n};\r\nfetchedPageTypes[\"experiments\"] = {\r\n  visibility: \"VisibilityTypes\",\r\n  //state: \"ExperimentStateTypes\",\r\n};\r\n/*fetchedPageTypes[\"constraints\"] = {\r\n  type1: \"ConstraintTypes\",\r\n  type2: \"ConstraintTypes\",\r\n};*/\r\n\r\n//dictionary for fetched data\r\n//data is fetched on the according resource route and matched with fields following this dictionary\r\n//the value of the specified field is the route to search for data. _ids of that route will be used as options\r\nexport const fetchedPageData = {};\r\n/*fetchedPageData[\"tags\"] = { tags: \"tags\" };\r\nfetchedPageData[\"things\"] = { tags: \"tags\" };\r\nfetchedPageData[\"devices\"] = { features: \"features\" };\r\nfetchedPageData[\"features\"] = { tags: \"tags\" };\r\nfetchedPageData[\"measurements\"] = {\r\n  device: \"devices\",\r\n  thing: \"things\",\r\n  tags: \"tags\",\r\n};*/\r\n\r\nexport const guidelines = {};\r\nguidelines[\"protocols\"] = {\r\n  _id: \"Please, enter protocol's name.\",\r\n  description: \"Please, enter a short protocol's description.\",\r\n};\r\nguidelines[\"experiments\"] = {\r\n  _id: \"Please, enter experiment's name (N.B. don't use the # character in experiment's name).\",\r\n  state: \"Please, enter 0 for ongoing experiment, 1 for finished experiment.\",\r\n  description: \"Please, enter a short experiment's description.\",\r\n  manager: \"Please, enter the experiment's company name (as a short Acronym).\",\r\n  startDate: \"Please, use yyyy/mm/dd format.\",\r\n  endDate: \"Please, use yyyy/mm/dd format.\",\r\n};\r\n","import localization_it from \"./localizations/localization_it\";\r\nimport localization_en from \"./localizations/localization_en\";\r\n\r\nimport { languages } from \"../config\";\r\n\r\ninterface ILocalization {\r\n  username: string;\r\n  password: string;\r\n  tenant: string;\r\n  keep_logged: string;\r\n  select: string;\r\n  language: string;\r\n  welcome: string;\r\n  role: string;\r\n  session_expire_in: string;\r\n  resources: string;\r\n  notifications: string;\r\n  file_content: string;\r\n\r\n  clear_all: string;\r\n\r\n  ///Fields\r\n  enter: string;\r\n  username_suggestion: string;\r\n  password_suggestion: string;\r\n  tenant_suggestion: string;\r\n  add_tenant: string;\r\n\r\n  //homepage\r\n  welcome_hp: string;\r\n  left_bar_descr_hp: string;\r\n  right_bar_descr_hp: string;\r\n  session_expire_info_hp: string;\r\n  github_page_hp: string;\r\n  github_issue_page_hp: string;\r\n\r\n  //profile page\r\n  profile_page_desc: string;\r\n  pass_change_confirm: string;\r\n  pass_not_match: string;\r\n  old_pass_empty: string;\r\n  old_pass_wrong: string;\r\n  pass_not_null: string;\r\n  password_changed: string;\r\n\r\n  //404\r\n  oh_no: string;\r\n  broken_link: string;\r\n\r\n  ///Actions\r\n  submit: string;\r\n  cancel: string;\r\n  login: string;\r\n  logout: string;\r\n  repeat: string;\r\n  close: string;\r\n\r\n  ///Errors\r\n  login_error: string;\r\n  unauthorised_user: string;\r\n  session_expired: string;\r\n  no_file: string;\r\n  duplicate_error: string;\r\n}\r\n\r\nexport default function locale() {\r\n  let tkn = localStorage.getItem(\"language\");\r\n  if (languages.length === 0) {\r\n    return localization_en as ILocalization;\r\n  }\r\n  if (languages.length === 1) {\r\n    tkn = languages[0];\r\n  }\r\n  //let localization : ILocalization;\r\n\r\n  //check token first\r\n  if (tkn === \"it\") {\r\n    return localization_it as ILocalization;\r\n  }\r\n\r\n  if (tkn === \"en\") {\r\n    return localization_en as ILocalization;\r\n  }\r\n\r\n  //then check language from browser\r\n  if (navigator.language.substring(0, 2) === \"it\") {\r\n    return localization_it as ILocalization;\r\n  }\r\n\r\n  if (navigator.language.substring(0, 2) === \"en\") {\r\n    return localization_en as ILocalization;\r\n  }\r\n\r\n  //if the token found or language is not valid -> default language: english\r\n  return localization_en as ILocalization;\r\n}\r\n","import React from \"react\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport locale from \"../../common/locale\";\r\nimport { languages } from \"../../config\";\r\nimport \"./languageSelector.scss\";\r\n\r\nexport const LanguageSelector = () => {\r\n  function setSessionLanguage(language: string) {\r\n    localStorage.setItem(\"language\", language);\r\n    window.location.reload();\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {locale().language}\r\n      <div>\r\n        {languages.includes(\"it\") && (\r\n          <Button\r\n            variant=\"outline-info\"\r\n            onClick={() => setSessionLanguage(\"it\")}\r\n          >\r\n            Ita\r\n          </Button>\r\n        )}\r\n        {languages.includes(\"en\") && (\r\n          <Button\r\n            variant=\"outline-info\"\r\n            onClick={() => setSessionLanguage(\"en\")}\r\n          >\r\n            Eng\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n  //\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport locale from \"../../common/locale\";\r\nimport { login } from \"../../services/http_operations\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { languages } from \"../../config\";\r\nimport \"./authPage.scss\";\r\nimport { LanguageSelector } from \"../languageSelector/languageSelector\";\r\nimport { Form, Container, Row, Col } from \"react-bootstrap\";\r\nconst userRef = React.createRef();\r\nconst pswRef = React.createRef();\r\nconst tenantRef = React.createRef();\r\n\r\nconst AuthPageComp = () => {\r\n  //const { location, replace } = useHistory();\r\n  const [msg, setMsg] = useState(\"\");\r\n\r\n  async function submitForm(e) {\r\n    e.preventDefault();\r\n\r\n    const user = userRef.current.value;\r\n    const psw = pswRef.current.value;\r\n    const tenant = tenantRef.current.value;\r\n    if (user === \"\") {\r\n      setMsg(\"Please, insert your username\");\r\n      return;\r\n    }\r\n    if (psw === \"\") {\r\n      setMsg(\"Please, insert your password\");\r\n      return;\r\n    }\r\n    try {\r\n      await login(user, psw, tenant);\r\n      window.location.replace(\"/\");\r\n    } catch (error) {\r\n      console.log({ error: error.response.data });\r\n      setMsg(error.response.data.message + \" : \" + error.response.data.details);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"auth-page\">\r\n      <div className=\"title-wrapper\">\r\n        <div className=\"title-section\">Measurify</div>\r\n        <br />\r\n        <div className=\"subtitle-section\">From the edge to cloud and back</div>\r\n      </div>\r\n      {languages.length > 1 && (\r\n        <div className=\"language-wrapper\">\r\n          <LanguageSelector />\r\n        </div>\r\n      )}\r\n\r\n      <br />\r\n      <br />\r\n      <div className=\"login-section\">\r\n        <h4>{locale().login}</h4>\r\n        <Form onSubmit={submitForm}>\r\n          <Form.Group className=\"mb-3\" controlId=\"username\">\r\n            <Form.Label>{locale().username}</Form.Label>\r\n            <Form.Control\r\n              ref={userRef}\r\n              type=\"text\"\r\n              placeholder={locale().username_suggestion}\r\n            />\r\n          </Form.Group>\r\n\r\n          <Form.Group className=\"mb-3\" controlId=\"formBasicPassword\">\r\n            <Form.Label>{locale().password}</Form.Label>\r\n            <Form.Control\r\n              type=\"password\"\r\n              ref={pswRef}\r\n              placeholder={locale().password_suggestion}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group className=\"mb-3\" controlId=\"tenant\">\r\n            <Form.Label>{locale().tenant}</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              ref={tenantRef}\r\n              placeholder={locale().tenant_suggestion}\r\n            />\r\n          </Form.Group>\r\n          <Button variant=\"success\" type=\"submit\">\r\n            {locale().submit}\r\n          </Button>\r\n        </Form>\r\n        <br />\r\n        <div style={{ color: \"red\" }}>{msg}</div>\r\n        <br />\r\n        <div className=\"form-row row\">\r\n          <NavLink to={`/add/tenants`}>\r\n            <Button variant=\"outline-success\" size=\"sm\">\r\n              {locale().add_tenant}\r\n              <i\r\n                className=\"fa fa-plus-circle\"\r\n                aria-hidden=\"true\"\r\n                title={\"Add\"}\r\n                style={{\r\n                  width: 30 + \"px\",\r\n                  height: 30 + \"px\",\r\n                  marginRight: 10 + \"px\",\r\n                  opacity: 0.85,\r\n                }}\r\n              ></i>\r\n            </Button>\r\n          </NavLink>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const AuthPage = AuthPageComp;\r\n","import React, { useEffect } from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport { website_name } from \"../../config\";\r\n\r\nimport \"./homePage.scss\";\r\n\r\nconst HomePageComp = () => {\r\n  useEffect(() => {});\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">{website_name}</header>\r\n      <main className=\"page-content\">\r\n        <div className=\"home-page\">\r\n          <div className=\"info-box\">\r\n            <div className=\"info-text\">\r\n              {locale().welcome_hp}\r\n              <br />\r\n              <br />\r\n              {locale().left_bar_descr_hp}\r\n              <br />\r\n              <br />\r\n              {locale().right_bar_descr_hp}\r\n              <br />\r\n              <br />\r\n              {locale().session_expire_info_hp}\r\n              <br />\r\n              <br />\r\n              <a\r\n                href=\"https://github.com/measurify/server/issues\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                title=\"https://github.com/measurify/server/issues\"\r\n              >\r\n                {locale().github_issue_page_hp}\r\n              </a>\r\n              <br />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const HomePage = HomePageComp;\r\n","import React from \"react\";\r\nimport locale from \"../../common/locale\";\r\n\r\nimport \"./notFoundPage.scss\";\r\n\r\nconst notFoundPageComp = () => {\r\n  return (\r\n    <div className=\"notFound-page\">\r\n      {locale().oh_no}\r\n      <br />\r\n      <br />\r\n      {locale().broken_link}\r\n      <br />\r\n      <br />\r\n      <a\r\n        href=\"https://github.com/measurify/server/issues\"\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n        title=\"https://github.com/measurify/server/issues\"\r\n      >\r\n        {locale().github_issue_page_hp}\r\n      </a>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const NotFoundPage = notFoundPageComp;\r\n","//check if an user is allowed to do a specific action\r\n//hardcoder for now, will be implemented through roles route\r\nexport const canDo = (userRole, resource, action) => {\r\n  if (action === \"create\") {\r\n    if (userRole === \"admin\") return true;\r\n    if (userRole === \"provider\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return true;\r\n    }\r\n    if (userRole === \"supplier\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return true;\r\n    }\r\n    if (userRole === \"analyst\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return false;\r\n    }\r\n  }\r\n  if (action === \"read\") {\r\n    if (userRole === \"admin\") return true;\r\n    if (userRole === \"provider\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return true;\r\n    }\r\n    if (userRole === \"supplier\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return false;\r\n    }\r\n    if (userRole === \"analyst\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return true;\r\n    }\r\n  }\r\n  if (action === \"update\") {\r\n    if (userRole === \"admin\") return true;\r\n    if (userRole === \"provider\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return true;\r\n    }\r\n    if (userRole === \"supplier\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return false;\r\n    }\r\n    if (userRole === \"analyst\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return false;\r\n    }\r\n  }\r\n  if (action === \"delete\") {\r\n    if (userRole === \"admin\") return true;\r\n    if (userRole === \"provider\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return true;\r\n    }\r\n    if (userRole === \"supplier\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return false;\r\n    }\r\n    if (userRole === \"analyst\") {\r\n      if (resource === \"users\") return false;\r\n      if (resource === \"protocols\") return false;\r\n      if (resource === \"experiments\") return false;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n","//check if a generic object is default, according to its type\r\nexport const isDefault = (obj) => {\r\n  //undefined is considered default\r\n  if (obj === undefined) return true;\r\n  //null is considered default\r\n  if (obj == null) return true;\r\n  //Nan is default for numbers\r\n  if (typeof obj === \"number\") {\r\n    return isNaN(obj);\r\n  }\r\n\r\n  //default check for strings\r\n  if (typeof obj === \"string\") {\r\n    return obj === \"\";\r\n  }\r\n\r\n  //input field is an array\r\n  if (Array.isArray(obj)) {\r\n    if (obj.length === 0) return true;\r\n    let def = true;\r\n    obj.forEach((elem) => {\r\n      def = def && isDefault(elem);\r\n    });\r\n    return def;\r\n  }\r\n\r\n  //check all values if object\r\n  if (obj.constructor === Object) {\r\n    let def = true;\r\n    Object.entries(obj).forEach(([_, v]) => {\r\n      def = def && isDefault(v);\r\n    });\r\n    return def;\r\n  }\r\n};\r\n\r\n//non-default items lenght\r\nexport const nonDefaultLength = (obj) => {\r\n  if (Array.isArray(obj) === false) return -1;\r\n  return obj.filter((e) => !isDefault(e)).length;\r\n};\r\n\r\n//remove all default or empty field from an object, recursively\r\nexport const removeDefaultElements = (obj) => {\r\n  if (Array.isArray(obj)) {\r\n  }\r\n  if (obj.constructor === Object) {\r\n    const entr = Object.entries(obj);\r\n    for (let i = 0; i < entr.length; i++) {\r\n      //check if value is an array\r\n      if (Array.isArray(entr[i][1])) {\r\n        for (let j = 0; j < entr[i][1].length; j++) {\r\n          if (\r\n            entr[i][1][j].constructor === Object ||\r\n            Array.isArray(entr[i][1][j])\r\n          ) {\r\n            removeDefaultElements(entr[i][1][j]);\r\n            if (isDefault(entr[i][1][j])) {\r\n              entr[i][1].splice(j, 1);\r\n            }\r\n          } else {\r\n            if (isDefault(entr[i][1][j])) {\r\n              entr[i][1].splice(j, 1);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      //check if value is an Object\r\n      if (entr[i][1].constructor === Object) {\r\n        const subEntr = Object.entries(entr[i][1]);\r\n        for (let j = 0; j < subEntr.length; j++) {\r\n          if (\r\n            subEntr[i][1].constructor === Object ||\r\n            Array.isArray(subEntr[i][1])\r\n          ) {\r\n            removeDefaultElements(subEntr[i][1]);\r\n          } else {\r\n            if (isDefault(subEntr[i][1])) delete entr[i][1][subEntr[i][0]];\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return obj;\r\n};\r\n\r\n//check if two objects (arrays, variables or objects) are equal\r\nexport const areEqual = (obj1, obj2) => {\r\n  //undefined check\r\n  if (obj1 === undefined || obj2 === undefined) return false;\r\n  //single value and ref check\r\n  if (obj1 === obj2) return true;\r\n\r\n  if (typeof obj1 !== typeof obj2) return false;\r\n\r\n  //one is array, other isn't\r\n  if (\r\n    (Array.isArray(obj1) && !Array.isArray(obj2)) ||\r\n    (!Array.isArray(obj1) && Array.isArray(obj2))\r\n  )\r\n    return false;\r\n\r\n  //both are array\r\n  if (Array.isArray(obj1) && Array.isArray(obj2)) {\r\n    //different length => not equal\r\n    if (obj1.length !== obj2.length) return false;\r\n    for (let i = 0; i < obj1.length; i++) {\r\n      if (!areEqual(obj1[i], obj2[i])) return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  //one is object, other isn't\r\n  if (\r\n    (obj1.constructor === Object && obj2.constructor !== Object) ||\r\n    (obj1.constructor !== Object && obj2.constructor === Object)\r\n  )\r\n    return false;\r\n\r\n  //both are object\r\n  if (obj1.constructor === Object && obj2.constructor === Object) {\r\n    const k1 = Object.keys(obj1);\r\n    const k2 = Object.keys(obj2);\r\n    if (k1.length !== k2.length) return false;\r\n    if (!areEqual(k1, k2)) return false;\r\n\r\n    const v1 = Object.values(obj1);\r\n    const v2 = Object.values(obj2);\r\n    if (!areEqual(v1, v2)) return false;\r\n\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\n//capitalize the first letter of a string\r\nexport function capitalize(s) {\r\n  return s && s[0].toUpperCase() + s.slice(1);\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nimport { Button } from \"react-bootstrap\";\r\n\r\nimport \"./navigation.scss\";\r\n\r\nimport locale from \"../../common/locale\";\r\nimport { refreshToken } from \"../../services/http_operations\";\r\n\r\nimport fontawesome from \"@fortawesome/fontawesome\";\r\nimport {\r\n  faTimes,\r\n  faBars,\r\n  faUserTie,\r\n  faUserGraduate,\r\n  faUserCog,\r\n  faUserTag,\r\n  faUser,\r\n  faCheck,\r\n} from \"@fortawesome/fontawesome-free-solid\";\r\n\r\nimport { pages, languages, website_name } from \"../../config\";\r\nimport { LanguageSelector } from \"../languageSelector/languageSelector\";\r\nimport { canDo } from \"../../services/userRolesManagement\";\r\nimport { capitalize } from \"../../services/misc_functions\";\r\nfontawesome.library.add(\r\n  faTimes,\r\n  faBars,\r\n  faUserTie,\r\n  faUserGraduate,\r\n  faUserCog,\r\n  faUserTag,\r\n  faUser,\r\n  faCheck\r\n);\r\n\r\nlet intervalRef = React.createRef();\r\nlet loginTime = React.createRef();\r\n\r\nlet remainingSeconds = React.createRef();\r\nlet duration = React.createRef();\r\n\r\nlet role = React.createRef();\r\nlet username = React.createRef();\r\nlet tenant = React.createRef();\r\n\r\nexport default function Navigation() {\r\n  const [isOpened, setIsOpened] = useState(false);\r\n\r\n  const usr = localStorage.getItem(\"username\");\r\n  const rl = localStorage.getItem(\"user-role\");\r\n  const tn = localStorage.getItem(\"user-tenant\");\r\n\r\n  username.current = usr !== null ? usr : \"\";\r\n  role.current = rl !== null ? rl : \"\";\r\n  tenant.current = tn !== null && tn !== \"\" ? tn : \"-\";\r\n\r\n  //useeffect on change time\r\n  useEffect(() => {\r\n    //convert duration time in string format to milliseconds\r\n    function DurationToMilliSeconds() {\r\n      let exp = localStorage.getItem(\"token-expiration-time\");\r\n\r\n      if (exp === null) return 300;\r\n      if (exp.endsWith(\"h\")) {\r\n        return parseInt(exp.slice(0, -1)) * 60 * 60 * 1000;\r\n      } else if (exp.endsWith(\"m\")) {\r\n        return parseInt(exp.slice(0, -1)) * 60 * 1000;\r\n      } else if (exp.endsWith(\"s\")) {\r\n        return parseInt(exp.slice(0, -1)) * 1000;\r\n      }\r\n      //default case, right now the same as seconds\r\n      else {\r\n        return parseInt(exp.slice(0, -1)) * 1000;\r\n      }\r\n    }\r\n\r\n    //calculate remaining seconds and refresh token if required\r\n    function CalcEnding() {\r\n      let t0;\r\n      let remainingSec;\r\n      //if remaining time is already calculated, just decrement that number by 1\r\n      if (remainingSeconds.current !== null) {\r\n        remainingSec = remainingSeconds.current - 1;\r\n      }\r\n      //otherwise, calculate remaining seconds\r\n      else {\r\n        //check if login time is already defined, if it's null get it from localstorage or current time (refresh case)\r\n        if (loginTime.current === null) {\r\n          const retryLoginTime = localStorage.getItem(\"login-time\");\r\n          //if localstorage containst login time, use it and store it into state\r\n          if (retryLoginTime !== null) {\r\n            loginTime.current = retryLoginTime;\r\n            t0 = parseInt(retryLoginTime, 10);\r\n          }\r\n          //otherwise get it from current time and store it into state\r\n          else {\r\n            t0 = Date.now();\r\n            loginTime.current = t0;\r\n          }\r\n        }\r\n        //use logintime stored into state\r\n        else {\r\n          t0 = parseInt(loginTime.current, 10);\r\n        }\r\n        if (duration.current === null)\r\n          duration.current = DurationToMilliSeconds();\r\n        const endTime = t0 + duration.current;\r\n\r\n        remainingSec = (endTime - Date.now()) / 1000;\r\n      }\r\n\r\n      if (remainingSec < 60) {\r\n        clearInterval(intervalRef.current);\r\n        refreshToken().then(() => {\r\n          remainingSeconds.current = null;\r\n          loginTime.current = null;\r\n\r\n          intervalRef.current = setInterval(() => {\r\n            CalcEnding();\r\n          }, 1000);\r\n          return;\r\n        });\r\n      }\r\n      if (remainingSec <= 0) {\r\n        localStorage.clear();\r\n        //session expired, automatically logout\r\n        window.location.replace(\"/\");\r\n        return;\r\n      }\r\n\r\n      //const mins = Math.floor(remainingSec / 60);\r\n      //const secs = Math.floor(remainingSec % 60);\r\n\r\n      remainingSeconds.current = parseInt(remainingSec, 10);\r\n    }\r\n\r\n    intervalRef.current = setInterval(() => {\r\n      CalcEnding();\r\n    }, 1000);\r\n  }, []);\r\n\r\n  function logOut() {\r\n    localStorage.clear();\r\n    document.location.replace(\"/\");\r\n  }\r\n\r\n  function renderIconRole() {\r\n    if (role.current === \"admin\") {\r\n      return (\r\n        <i className=\"fa fa-user-tie\" aria-hidden=\"true\" title=\"Admin\"></i>\r\n      );\r\n    } else if (role.current === \"provider\") {\r\n      return (\r\n        <i\r\n          className=\"fa fa-user-graduate\"\r\n          aria-hidden=\"true\"\r\n          title=\"Provider\"\r\n        ></i>\r\n      );\r\n    } else if (role.current === \"analyst\") {\r\n      return (\r\n        <i className=\"fa fa-user-cog\" aria-hidden=\"true\" title=\"Analyst\"></i>\r\n      );\r\n    } else if (role.current === \"supplier\") {\r\n      return (\r\n        <i className=\"fa fa-user-tag\" aria-hidden=\"true\" title=\"Supplier\"></i>\r\n      );\r\n    } else {\r\n      return (\r\n        <i className=\"fa fa-user\" aria-hidden=\"true\" aria-label=\"User\"></i>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <nav className=\"app-nav\">\r\n      <Button className=\"app-nav-opener\" onClick={() => setIsOpened(!isOpened)}>\r\n        {isOpened ? (\r\n          <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n        ) : (\r\n          <i className=\"fa fa-bars\" aria-hidden=\"true\"></i>\r\n        )}\r\n      </Button>\r\n      <NavLink to=\"/home\" className=\"nav-wrap\">\r\n        {website_name}\r\n      </NavLink>\r\n      <hr />\r\n      <div className={`app-nav-wrapper ${isOpened ? \"opened\" : \"\"}`}>\r\n        <div className=\"app-nav-links\">\r\n          <hr />\r\n          <div className=\"data-wrapper\">\r\n            <NavLink to={`/viewProfile/`} key={`viewProfile`}>\r\n              {locale().welcome + \" \"}\r\n              <b>{username.current}</b>\r\n            </NavLink>\r\n            <div style={{ paddingLeft: 10 + \"px\" }}>\r\n              <h3>\r\n                {locale().role + \" \"}\r\n                {renderIconRole()}\r\n              </h3>\r\n            </div>\r\n            <div style={{ paddingLeft: 10 + \"px\" }}>\r\n              <h3>\r\n                {locale().tenant + \" \"}\r\n                <b>{tenant.current}</b>\r\n              </h3>\r\n            </div>\r\n            <br />\r\n            <div style={{ paddingLeft: 20 + \"px\", paddingBottom: 20 + \"px\" }}>\r\n              <Button variant=\"outline-danger\" onClick={() => logOut()}>\r\n                {locale().logout}\r\n              </Button>\r\n            </div>\r\n            {languages.length > 1 && (\r\n              <React.Fragment>\r\n                <hr />\r\n                <h2>\r\n                  <LanguageSelector />\r\n                </h2>\r\n              </React.Fragment>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"app-nav-text\">{locale().resources}</div>\r\n          <hr />\r\n          {Object.keys(pages).map((k) => {\r\n            //check if user can access to the page\r\n            if (!canDo(role.current, k, \"read\")) {\r\n              return \"\";\r\n            }\r\n            return (\r\n              <NavLink\r\n                to={`/` + k}\r\n                className={(navData) => (navData.isActive ? \"active\" : \"\")}\r\n                //activeClassName=\"active\"\r\n                key={k}\r\n                onClick={() => setIsOpened(false)}\r\n              >\r\n                {capitalize(k)}\r\n              </NavLink>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { viewFields } from \"../../config\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nimport fontawesome from \"@fortawesome/fontawesome\";\r\nimport {\r\n  faEye,\r\n  faPencilAlt,\r\n  faCopy,\r\n} from \"@fortawesome/fontawesome-free-solid\";\r\nimport {\r\n  Button,\r\n  OverlayTrigger,\r\n  Popover,\r\n  Accordion,\r\n  Table,\r\n} from \"react-bootstrap\";\r\n\r\nimport { delete_generic } from \"../../services/http_operations\";\r\n\r\nfontawesome.library.add(faEye, faPencilAlt, faCopy);\r\n\r\nfunction ActionContent(props) {\r\n  const toShow = {};\r\n  viewFields[props.resType].forEach((k) => {\r\n    if (k.constructor === Object) {\r\n      Object.keys(k).forEach((subK) => {\r\n        if (Array.isArray(props.resource[subK])) {\r\n          toShow[subK] = props.resource[subK].map((e) => {\r\n            const row = {};\r\n            k[subK].forEach((f) => {\r\n              row[f] = e[f];\r\n            });\r\n            return row;\r\n          });\r\n        } else {\r\n          toShow[subK] = props.resource[subK];\r\n        }\r\n      });\r\n    } else {\r\n      if (Object.keys(props.resource).includes(k)) {\r\n        toShow[k] = props.resource[k];\r\n      }\r\n    }\r\n  });\r\n\r\n  //render accordion with table when field is array of object\r\n  return UnrollView(toShow);\r\n}\r\n\r\nfunction UnrollView(item) {\r\n  return (\r\n    <Accordion defaultActiveKey={0} size={\"lg\"}>\r\n      {React.Children.toArray(\r\n        Object.entries(item).map(([key, value], i) => {\r\n          return (\r\n            <Accordion.Item eventKey={i}>\r\n              <Accordion.Header>\r\n                <b>{key}</b>\r\n              </Accordion.Header>\r\n              <Accordion.Body>\r\n                {value instanceof Object ? (\r\n                  Array.isArray(value) ? (\r\n                    value[0] !== undefined ? (\r\n                      Object.values(value[0]).some(\r\n                        (e) => e instanceof Object\r\n                      ) ? (\r\n                        React.Children.toArray(\r\n                          value.map((single, i) => {\r\n                            return (\r\n                              <Accordion>\r\n                                <Accordion.Item eventKey=\"0\">\r\n                                  <Accordion.Header>\r\n                                    {key} <i>[{i}]</i>\r\n                                  </Accordion.Header>\r\n                                  <Accordion.Body>\r\n                                    {UnrollView(single)}\r\n                                  </Accordion.Body>\r\n                                </Accordion.Item>\r\n                              </Accordion>\r\n                            );\r\n                          })\r\n                        )\r\n                      ) : value[0] instanceof Object ? (\r\n                        <Table responsive striped bordered hover size=\"sm\">\r\n                          <thead>\r\n                            <tr>\r\n                              {React.Children.toArray(\r\n                                Object.keys(value[0]).map((e) => {\r\n                                  return <th>{e}</th>;\r\n                                })\r\n                              )}\r\n                            </tr>\r\n                          </thead>\r\n                          <tbody>\r\n                            {React.Children.toArray(\r\n                              value.map((row) => {\r\n                                return (\r\n                                  <tr>\r\n                                    {React.Children.toArray(\r\n                                      Object.values(row).map((v) => {\r\n                                        return <td>{v}</td>;\r\n                                      })\r\n                                    )}\r\n                                  </tr>\r\n                                );\r\n                              })\r\n                            )}\r\n                          </tbody>\r\n                        </Table>\r\n                      ) : (\r\n                        \"[ \" + value.join(\" , \") + \" ]\"\r\n                      )\r\n                    ) : (\r\n                      \"[ ]\"\r\n                    )\r\n                  ) : (\r\n                    \"AAAA\"\r\n                  )\r\n                ) : value === undefined || value == null ? (\r\n                  <i>None</i>\r\n                ) : (\r\n                  value\r\n                )}\r\n              </Accordion.Body>\r\n            </Accordion.Item>\r\n          );\r\n        })\r\n      )}\r\n    </Accordion>\r\n  );\r\n}\r\n\r\nexport default function ActionManager(props) {\r\n  const [res, setRes] = useState(undefined);\r\n  useEffect(() => {\r\n    //use effect body\r\n  }, [props]);\r\n\r\n  const viewPopover =\r\n    res !== undefined ? (\r\n      <Popover\r\n        id=\"popover-positioned-left\"\r\n        style={{\r\n          width: 20 + \"vw\",\r\n          minWidth:\r\n            /Mobi/i.test(window.navigator.userAgent) == true ? 250 : 400 + \"px\",\r\n        }}\r\n      >\r\n        <Popover.Header as=\"h3\">View Resource</Popover.Header>\r\n        <Popover.Body>\r\n          <ActionContent resource={res} resType={props.resType} />\r\n        </Popover.Body>\r\n      </Popover>\r\n    ) : (\r\n      <Popover id=\"popover-positioned-left\" style={{ width: 20 + \"vw\" }}>\r\n        <Popover.Header as=\"h3\">\r\n          Loading<Popover.Body></Popover.Body>\r\n        </Popover.Header>\r\n      </Popover>\r\n    );\r\n  if (props.action === \"view\") {\r\n    return (\r\n      <OverlayTrigger\r\n        trigger=\"click\"\r\n        placement=\"left\"\r\n        overlay={viewPopover}\r\n        rootClose={true}\r\n      >\r\n        <Button\r\n          variant=\"link\"\r\n          size=\"sm\"\r\n          onClick={() => {\r\n            setRes(props.takeSingle(props.id));\r\n          }}\r\n        >\r\n          <i\r\n            className=\"fa fa-eye\"\r\n            aria-hidden=\"true\"\r\n            title=\"View\"\r\n            style={{\r\n              width: 30 + \"px\",\r\n              height: 30 + \"px\",\r\n              marginRight: 10 + \"px\",\r\n              opacity: 0.85,\r\n            }}\r\n          ></i>\r\n        </Button>\r\n      </OverlayTrigger>\r\n    );\r\n  }\r\n  if (props.action === \"delete\") {\r\n    return (\r\n      <Button\r\n        variant=\"link\"\r\n        size=\"sm\"\r\n        onClick={async () => {\r\n          const result = window.confirm(\"Want to delete: \" + props.id + \"?\");\r\n          if (result) {\r\n            try {\r\n              const response = await delete_generic(props.resType, props.id);\r\n\r\n              if (response.response.status === 200) {\r\n                props.removeSingle(props.id);\r\n              }\r\n            } catch (error) {\r\n              console.log(error);\r\n            }\r\n          }\r\n        }}\r\n      >\r\n        <i\r\n          className=\"fa fa-times\"\r\n          aria-hidden=\"true\"\r\n          title=\"Delete\"\r\n          style={{\r\n            width: 30 + \"px\",\r\n            height: 30 + \"px\",\r\n            marginRight: 10 + \"px\",\r\n            opacity: 0.85,\r\n          }}\r\n        ></i>\r\n      </Button>\r\n    );\r\n  }\r\n  if (props.action === \"edit\") {\r\n    return (\r\n      <NavLink to={`/edit/` + props.resType + \"/\" + props.id}>\r\n        <Button variant=\"link\" size=\"sm\">\r\n          <i\r\n            className=\"fa fa-pencil-alt\"\r\n            aria-hidden=\"true\"\r\n            title=\"Edit\"\r\n            style={{\r\n              width: 30 + \"px\",\r\n              height: 30 + \"px\",\r\n              marginRight: 10 + \"px\",\r\n              opacity: 0.85,\r\n            }}\r\n          ></i>\r\n        </Button>\r\n      </NavLink>\r\n    );\r\n  }\r\n  if (props.action === \"duplicate\") {\r\n    return (\r\n      <NavLink to={`/add/` + props.resType + \"/?from=\" + props.id}>\r\n        <Button variant=\"link\" size=\"sm\">\r\n          <i\r\n            className=\"fa fa-copy\"\r\n            aria-hidden=\"true\"\r\n            title=\"Duplicate\"\r\n            style={{\r\n              width: 30 + \"px\",\r\n              height: 30 + \"px\",\r\n              marginRight: 10 + \"px\",\r\n              opacity: 0.85,\r\n            }}\r\n          ></i>\r\n        </Button>\r\n      </NavLink>\r\n    );\r\n  }\r\n\r\n  return <div />;\r\n}\r\n","import React from \"react\";\r\nimport { aliasPages } from \"../../config\";\r\n\r\nimport { Table } from \"react-bootstrap\";\r\nimport ActionManager from \"../actionsManager/actionsManager\";\r\nimport { canDo } from \"../../services/userRolesManagement\";\r\n\r\nexport default function ContentTable(props) {\r\n  if (props.header === undefined || props.resources === undefined)\r\n    return <div>Loading</div>;\r\n  if (props.header.includes(\"actions\") && props.actions === undefined)\r\n    return <div>Loading</div>;\r\n\r\n  return (\r\n    <div>\r\n      <Table responsive striped bordered hover>\r\n        <thead>\r\n          <tr key={\"header\"}>\r\n            {React.Children.toArray(\r\n              props.header.map((e) => {\r\n                if (aliasPages[props.resType] !== undefined)\r\n                  if (aliasPages[props.resType][e] !== undefined)\r\n                    return <th>{aliasPages[props.resType][e]}</th>;\r\n                return <th>{e}</th>;\r\n              })\r\n            )}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {React.Children.toArray(\r\n            props.resources.map((row, index) => {\r\n              return (\r\n                <tr>\r\n                  {React.Children.toArray(\r\n                    props.header.map((e) => {\r\n                      if (e === \"actions\") {\r\n                        return (\r\n                          <td>\r\n                            {props.actions.includes(\"view\") ? (\r\n                              <ActionManager\r\n                                resType={props.resType}\r\n                                action=\"view\"\r\n                                k={index + \"_view\"}\r\n                                id={row[\"_id\"]}\r\n                                takeSingle={props.takeSingle}\r\n                              />\r\n                            ) : (\r\n                              \"\"\r\n                            )}\r\n                            {props.actions.includes(\"edit\") &&\r\n                            canDo(props.userRole, props.resType, \"update\") ? (\r\n                              <ActionManager\r\n                                resType={props.resType}\r\n                                action=\"edit\"\r\n                                k={index + \"_edit\"}\r\n                                id={row[\"_id\"]}\r\n                                //takeSingle={props.takeSingle}\r\n                              />\r\n                            ) : (\r\n                              \"\"\r\n                            )}\r\n                            {props.actions.includes(\"duplicate\") &&\r\n                            canDo(props.userRole, props.resType, \"create\") ? (\r\n                              <ActionManager\r\n                                resType={props.resType}\r\n                                action=\"duplicate\"\r\n                                k={index + \"_duplicate\"}\r\n                                id={row[\"_id\"]}\r\n                              />\r\n                            ) : (\r\n                              \"\"\r\n                            )}\r\n                            {props.actions.includes(\"delete\") &&\r\n                            canDo(props.userRole, props.resType, \"delete\") ? (\r\n                              <ActionManager\r\n                                resType={props.resType}\r\n                                action=\"delete\"\r\n                                k={index + \"_delete\"}\r\n                                id={row[\"_id\"]}\r\n                                removeSingle={props.removeSingle}\r\n                              />\r\n                            ) : (\r\n                              \"\"\r\n                            )}\r\n                          </td>\r\n                        );\r\n                      }\r\n                      if (row[e] === undefined) return;\r\n                      if (Array.isArray(row[e]))\r\n                        return <td>{\"[ \" + row[e].join(\" , \") + \" ]\"}</td>;\r\n                      return <td>{row[e]}</td>;\r\n                    })\r\n                  )}\r\n                </tr>\r\n              );\r\n            })\r\n          )}\r\n        </tbody>\r\n      </Table>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport { pages, pageActions, addFields } from \"../../config\";\r\nimport { get_generic } from \"../../services/http_operations\";\r\nimport ContentTable from \"../contentTable/contentTable\";\r\nimport { useParams, useSearchParams } from \"react-router-dom\";\r\nimport { Pagination } from \"react-bootstrap\";\r\nimport \"./page.scss\";\r\n\r\nimport { canDo } from \"../../services/userRolesManagement\";\r\nimport fontawesome from \"@fortawesome/fontawesome\";\r\nimport { faPlusCircle } from \"@fortawesome/fontawesome-free-solid\";\r\nfontawesome.library.add(faPlusCircle);\r\n\r\nlet role = React.createRef();\r\n\r\nexport default function Page(params) {\r\n  const { page } = useParams();\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const [resource, setResource] = useState(undefined);\r\n  const [header, setHeader] = useState(undefined);\r\n  const [actions, setActions] = useState(undefined);\r\n\r\n  const [pageNum, setPageNum] = useState(1);\r\n  const [pageLimit, setPageLimit] = useState(1);\r\n\r\n  const [hasNext, setHasNext] = useState();\r\n  const [hasPrev, setHasPrev] = useState();\r\n\r\n  const [prevPage, setPrevPage] = useState();\r\n  const [nextPage, setNextPage] = useState();\r\n\r\n  const [totalPages, setTotalPages] = useState();\r\n\r\n  const rl = localStorage.getItem(\"user-role\");\r\n\r\n  role.current = rl !== null ? rl : \"\";\r\n\r\n  useEffect(() => {\r\n    // declare the async data fetching function\r\n    const fetchData = async (qs = {}) => {\r\n      // get the data from the api\r\n      try {\r\n        const response = await get_generic(page, qs);\r\n\r\n        // set state with the result\r\n        setHeader(pages[page]);\r\n        setResource(response.docs);\r\n        if (pageActions[page] !== undefined) setActions(pageActions[page]);\r\n\r\n        setHasNext(response.hasNextPage);\r\n        setHasPrev(response.hasPrevPage);\r\n\r\n        setTotalPages(response.totalPages);\r\n\r\n        setPrevPage(response.prevPage);\r\n        setNextPage(response.nextPage);\r\n      } catch (error) {\r\n        console.log(error);\r\n\r\n        setHeader(undefined);\r\n        setResource(undefined);\r\n        setHasNext(undefined);\r\n        setHasPrev(undefined);\r\n        setTotalPages(undefined);\r\n        setPrevPage(undefined);\r\n        setNextPage(undefined);\r\n      }\r\n    };\r\n\r\n    //get params for pagination\r\n    const num =\r\n      searchParams.get(\"page\") !== null ? searchParams.get(\"page\") : 1;\r\n    setPageNum(num);\r\n\r\n    const limit =\r\n      searchParams.get(\"limit\") !== null ? searchParams.get(\"limit\") : 10;\r\n    setPageLimit(limit);\r\n\r\n    const qs = { page: num, limit: limit };\r\n\r\n    // call the function\r\n    fetchData(qs)\r\n      // make sure to catch any error\r\n      .catch(console.error);\r\n  }, [params, page, searchParams]);\r\n\r\n  const takeSingle = (id) => {\r\n    return resource.find((r) => r._id === id);\r\n  };\r\n\r\n  const removeSingle = (id) => {\r\n    let tmp = resource.filter((el) => {\r\n      return el._id !== id;\r\n    });\r\n    setResource(tmp);\r\n  };\r\n\r\n  const RenderPagination = () => {\r\n    const prevEllipsis = parseInt(pageNum, 10) - 2 > 0;\r\n    const nextEllipsis = parseInt(pageNum, 10) + 2 < totalPages;\r\n\r\n    return (\r\n      <div style={{ display: \"inline-flex\", width: 100 + \"%\" }}>\r\n        <Pagination\r\n          style={{\r\n            alignSelf: \"center\",\r\n            marginLeft: \"auto\",\r\n            marginRight: \"auto\",\r\n          }}\r\n        >\r\n          <Pagination.First\r\n            disabled={pageNum === 1}\r\n            onClick={() => setSearchParams({ page: 1, limit: pageLimit })}\r\n          />\r\n          <Pagination.Prev\r\n            disabled={!hasPrev}\r\n            onClick={() =>\r\n              setSearchParams({ page: prevPage, limit: pageLimit })\r\n            }\r\n          />\r\n          {prevEllipsis && <Pagination.Ellipsis />}\r\n          {parseInt(pageNum, 10) - 1 > 0 && (\r\n            <Pagination.Item\r\n              onClick={() =>\r\n                setSearchParams({\r\n                  page: parseInt(pageNum, 10) - 1,\r\n                  limit: pageLimit,\r\n                })\r\n              }\r\n            >\r\n              {parseInt(pageNum, 10) - 1}\r\n            </Pagination.Item>\r\n          )}\r\n          <Pagination.Item>\r\n            <b>{pageNum}</b>\r\n          </Pagination.Item>\r\n          {parseInt(pageNum, 10) + 1 <= totalPages && (\r\n            <Pagination.Item\r\n              onClick={() =>\r\n                setSearchParams({\r\n                  page: parseInt(pageNum, 10) + 1,\r\n                  limit: pageLimit,\r\n                })\r\n              }\r\n            >\r\n              {parseInt(pageNum, 10) + 1}\r\n            </Pagination.Item>\r\n          )}\r\n          {nextEllipsis && <Pagination.Ellipsis />}\r\n\r\n          <Pagination.Next\r\n            disabled={!hasNext}\r\n            onClick={() =>\r\n              setSearchParams({ page: nextPage, limit: pageLimit })\r\n            }\r\n          />\r\n          <Pagination.Last\r\n            disabled={pageNum === totalPages}\r\n            onClick={() =>\r\n              setSearchParams({ page: totalPages, limit: pageLimit })\r\n            }\r\n          />\r\n        </Pagination>\r\n      </div>\r\n    );\r\n  };\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">\r\n        {page}\r\n\r\n        {addFields[page] !== undefined && canDo(role.current, page, \"create\") && (\r\n          <NavLink to={`/add/` + page + \"/\"} key={page + \"_add_navlink\"}>\r\n            <Button variant=\"link\" size=\"sm\" key={page + \"button\"}>\r\n              <i\r\n                key={page + \"icon\"}\r\n                className=\"fa fa-plus-circle\"\r\n                aria-hidden=\"true\"\r\n                title={\"Add\"}\r\n                style={{\r\n                  width: 30 + \"px\",\r\n                  height: 30 + \"px\",\r\n                  marginRight: 10 + \"px\",\r\n                  opacity: 0.85,\r\n                }}\r\n              ></i>\r\n            </Button>\r\n          </NavLink>\r\n        )}\r\n      </header>\r\n      <main className=\"page-content\">\r\n        <ContentTable\r\n          resType={page}\r\n          userRole={role.current}\r\n          header={header}\r\n          resources={resource}\r\n          actions={actions}\r\n          takeSingle={takeSingle}\r\n          removeSingle={removeSingle}\r\n        />\r\n        <RenderPagination />\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Button, Form, Container, Row, Col } from \"react-bootstrap\";\r\nimport locale from \"../../common/locale\";\r\nimport { put_generic, login } from \"../../services/http_operations\";\r\nimport \"../page/page.scss\";\r\n\r\nexport default function ProfilePage(params) {\r\n  //save in status informations of profile\r\n  const [username, setUsername] = useState(\"\");\r\n  const [role, setRole] = useState(\"\");\r\n  const [tenant, setTenant] = useState(\"\");\r\n  const [oldPassword, setOldPassword] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [passwordConfirm, setPasswordConfirm] = useState(\"\");\r\n  const [msg, setMsg] = useState(\"\");\r\n\r\n  function renderIconRole() {\r\n    if (role === \"admin\") {\r\n      return (\r\n        <i className=\"fa fa-user-tie\" aria-hidden=\"true\" title=\"Admin\"></i>\r\n      );\r\n    } else if (role === \"provider\") {\r\n      return (\r\n        <i\r\n          className=\"fa fa-user-graduate\"\r\n          aria-hidden=\"true\"\r\n          title=\"Provider\"\r\n        ></i>\r\n      );\r\n    } else if (role === \"analyst\") {\r\n      return (\r\n        <i className=\"fa fa-user-cog\" aria-hidden=\"true\" title=\"Analyst\"></i>\r\n      );\r\n    } else if (role === \"supplier\") {\r\n      return (\r\n        <i className=\"fa fa-user-tag\" aria-hidden=\"true\" title=\"Supplier\"></i>\r\n      );\r\n    } else {\r\n      return (\r\n        <i className=\"fa fa-user\" aria-hidden=\"true\" aria-label=\"User\"></i>\r\n      );\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    const username = localStorage.getItem(\"username\");\r\n    const role = localStorage.getItem(\"user-role\");\r\n    const tenant = localStorage.getItem(\"user-tenant\");\r\n    setUsername(username !== null ? username : \"\");\r\n    setRole(role !== null ? role : \"\");\r\n    setTenant(tenant !== null && tenant !== \"\" ? tenant : \"-\");\r\n  }, []);\r\n\r\n  const submitPassword = async (e) => {\r\n    e.preventDefault();\r\n    if (oldPassword === \"\") {\r\n      setMsg(locale().old_pass_empty);\r\n    }\r\n    if (password !== passwordConfirm) {\r\n      setMsg(locale().pass_not_match);\r\n      return;\r\n    }\r\n    if (password === \"\" || passwordConfirm === \"\") {\r\n      setMsg(locale().pass_not_null);\r\n      return;\r\n    }\r\n    try {\r\n      await login(username, oldPassword, tenant, false);\r\n    } catch (error) {\r\n      setMsg(locale().old_pass_wrong);\r\n      return;\r\n    }\r\n    const result = window.confirm(locale().pass_change_confirm);\r\n    if (result) {\r\n      try {\r\n        const response = await put_generic(\r\n          \"users\",\r\n          { password: password },\r\n          username\r\n        );\r\n\r\n        setPassword(\"\");\r\n        setPasswordConfirm(\"\");\r\n        if (response.response.status === 200) {\r\n          setMsg(locale().password_changed);\r\n        }\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">\r\n        {locale().welcome}&nbsp;<b>{username}</b>:&nbsp;\r\n        {locale().profile_page_desc}\r\n      </header>\r\n      <main className=\"page-content\">\r\n        <Container fluid>\r\n          <Row>\r\n            <Col xs={1}>Username:&nbsp;</Col>\r\n            <Col>\r\n              <b>{username}</b>\r\n            </Col>\r\n          </Row>\r\n          <Row>\r\n            <Col xs={1}>{locale().role}</Col>\r\n            <Col>\r\n              {role}&nbsp;\r\n              {renderIconRole()}\r\n            </Col>\r\n          </Row>\r\n          <Row>\r\n            <Col xs={1}>{locale().tenant + \" \"}</Col>\r\n            <Col>\r\n              <b>{tenant}</b>\r\n            </Col>\r\n          </Row>\r\n        </Container>\r\n        <hr />\r\n        <Container fluid>\r\n          <Col>\r\n            <Row>\r\n              <b>Edit password</b>\r\n            </Row>\r\n          </Col>\r\n\r\n          <Row>\r\n            <Col>\r\n              <Form onSubmit={submitPassword}>\r\n                <Row>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Control\r\n                      type={\"password\"}\r\n                      onChange={(e) => {\r\n                        e.preventDefault();\r\n                        setOldPassword(e.target.value);\r\n                      }}\r\n                      value={oldPassword}\r\n                      placeholder={locale().enter + \" old password\"}\r\n                    />\r\n                  </Form.Group>\r\n                </Row>\r\n                <Row>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Control\r\n                      type={\"password\"}\r\n                      onChange={(e) => {\r\n                        e.preventDefault();\r\n                        setPassword(e.target.value);\r\n                      }}\r\n                      value={password}\r\n                      placeholder={locale().enter + \" new password\"}\r\n                    />\r\n                  </Form.Group>\r\n                </Row>\r\n                <Row>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Control\r\n                      type={\"password\"}\r\n                      onChange={(e) => {\r\n                        e.preventDefault();\r\n                        setPasswordConfirm(e.target.value);\r\n                      }}\r\n                      value={passwordConfirm}\r\n                      placeholder={locale().repeat + \" new password\"}\r\n                      aria-describedby=\"passwordHelpBlock\"\r\n                    />\r\n                    <Form.Text id=\"passwordHelpBlock\" muted>\r\n                      {msg}\r\n                    </Form.Text>\r\n                  </Form.Group>\r\n                </Row>\r\n                <Button variant=\"primary\" type=\"submit\">\r\n                  {locale().submit}\r\n                </Button>\r\n              </Form>\r\n            </Col>\r\n          </Row>\r\n        </Container>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import \"./unauthorizedPage.scss\";\r\n\r\nimport React from \"react\";\r\nimport locale from \"../../common/locale\";\r\n\r\nexport default function UnauthorizedPage() {\r\n  return (\r\n    <div className=\"unAuth-page\">\r\n      <div className=\"info-box\">\r\n        <div className=\"info-text\">{locale().unauthorised_user}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nconst AppContext = React.createContext();\r\n\r\nexport default AppContext;\r\n","import {\r\n  Button,\r\n  Badge,\r\n  Offcanvas,\r\n  Toast,\r\n  ToastContainer,\r\n} from \"react-bootstrap\";\r\nimport React, { useState, useContext, useEffect } from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport \"./notificationBar.scss\";\r\nimport AppContext from \"../../context\";\r\nimport { layout } from \"../../config\";\r\nconst oldNotifications = React.createRef();\r\n\r\nexport default function NotificationBar(props) {\r\n  const [show, setShow] = useState(false);\r\n  const [highlight, setHighlight] = useState(false);\r\n\r\n  let layoutRef = React.useRef();\r\n  const myNotifications = useContext(AppContext).notifications;\r\n  oldNotifications.current = 0;\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  /*\r\n  handleClick = () => {\r\n    this.setState({ highlight: true });\r\n    setTimeout(() => {\r\n      this.setState({ highlight: false });\r\n    }, 2000);\r\n  };*/\r\n\r\n  useEffect(() => {\r\n    if (oldNotifications.current < myNotifications.notifications.length) {\r\n      oldNotifications.current = myNotifications.notifications.length;\r\n\r\n      setHighlight(true);\r\n      setTimeout(() => {\r\n        setHighlight(false);\r\n      }, 600);\r\n    }\r\n  }, [myNotifications.notifications]);\r\n\r\n  //mobile view only allowed to be vertical\r\n  if (/Mobi/i.test(window.navigator.userAgent) === true) {\r\n    layoutRef.current = \"vertical\";\r\n  } else {\r\n    layoutRef.current = layout;\r\n  }\r\n  const errorNot = myNotifications.notifications.filter(\r\n    (e) => e.name === \"error\"\r\n  );\r\n\r\n  return (\r\n    <div\r\n      className=\"notificationBar\"\r\n      style={\r\n        layoutRef.current === \"vertical\" &&\r\n        /Mobi/i.test(window.navigator.userAgent) === false\r\n          ? { height: 100 + \"vh\" }\r\n          : {}\r\n      }\r\n    >\r\n      <Button\r\n        variant=\"link\"\r\n        onClick={() => {\r\n          handleShow();\r\n        }}\r\n        style={{\r\n          color: \"#fff\",\r\n          textDecoration: \"none\",\r\n        }}\r\n      >\r\n        {locale().notifications}&nbsp;\r\n        <Badge\r\n          pill\r\n          bg={errorNot.length > 0 ? \"danger\" : \"success\"}\r\n          className={`element${highlight ? \" highlight\" : \"\"}`}\r\n        >\r\n          {myNotifications.notifications.length}\r\n        </Badge>\r\n        <span className=\"visually-hidden\">Unread notifications</span>\r\n      </Button>\r\n\r\n      <Offcanvas\r\n        style={{\r\n          backgroundColor: \"#123651\",\r\n          color: \"#fff\",\r\n        }}\r\n        show={show}\r\n        onHide={handleClose}\r\n        placement=\"end\"\r\n        name={\"notification_bar\"}\r\n        scroll={false}\r\n        backdrop={true}\r\n        keyboard={true}\r\n      >\r\n        <Offcanvas.Header>\r\n          <Offcanvas.Title>\r\n            {locale().notifications}\r\n            &nbsp;\r\n            <Badge pill bg={errorNot.length > 0 ? \"danger\" : \"success\"}>\r\n              {myNotifications.notifications.length}\r\n            </Badge>\r\n            &nbsp;&nbsp;&nbsp;\r\n            <Button variant=\"outline-secondary\" onClick={() => handleClose()}>\r\n              {locale().close + \" \" + locale().notifications}\r\n            </Button>\r\n          </Offcanvas.Title>\r\n        </Offcanvas.Header>\r\n        <Offcanvas.Body>\r\n          <div\r\n            style={{\r\n              width: 100 + \"%\",\r\n              height: 100 + \"%\",\r\n            }}\r\n          >\r\n            {myNotifications.notifications.length !== 0 && (\r\n              <Button\r\n                variant=\"warning\"\r\n                onClick={() => myNotifications.ClearNotifications()}\r\n              >\r\n                {locale().clear_all}\r\n              </Button>\r\n            )}\r\n\r\n            <ToastContainer>\r\n              {myNotifications.notifications.map((notification, index) => {\r\n                let type;\r\n                if (notification.name === \"info\") type = \"success\";\r\n                if (notification.name === \"error\") type = \"danger\";\r\n                return (\r\n                  <Toast\r\n                    className=\"d-inline-block m-1\"\r\n                    key={\"notification_\" + index}\r\n                    bg={type}\r\n                    animation={true}\r\n                    onClose={() => {\r\n                      myNotifications.RemoveNotification(index);\r\n                    }}\r\n                  >\r\n                    <Toast.Header>\r\n                      <img\r\n                        src=\"holder.js/20x20?text=%20\"\r\n                        className=\"rounded me-2\"\r\n                        alt=\"\"\r\n                      />\r\n                      <strong className=\"me-auto\">{notification.name}</strong>\r\n                      <small>{notification.time.slice(0, 15)}</small>\r\n                    </Toast.Header>\r\n                    <Toast.Body>{notification.msg}</Toast.Body>\r\n                  </Toast>\r\n                );\r\n              })}\r\n            </ToastContainer>\r\n          </div>\r\n        </Offcanvas.Body>\r\n      </Offcanvas>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nimport { Button, Container, Row, Col } from \"react-bootstrap\";\r\nimport NotificationBar from \"../notificationBar/notificationBar\";\r\nimport \"./horizontalNavigationBar.scss\";\r\n\r\nimport locale from \"../../common/locale\";\r\nimport { refreshToken } from \"../../services/http_operations\";\r\n\r\nimport fontawesome from \"@fortawesome/fontawesome\";\r\nimport {\r\n  faTimes,\r\n  faBars,\r\n  faUserTie,\r\n  faUserGraduate,\r\n  faUserCog,\r\n  faUserTag,\r\n  faUser,\r\n  faCheck,\r\n} from \"@fortawesome/fontawesome-free-solid\";\r\n\r\nimport { pages, languages, website_name } from \"../../config\";\r\nimport { LanguageSelector } from \"../languageSelector/languageSelector\";\r\nimport { canDo } from \"../../services/userRolesManagement\";\r\nimport { capitalize } from \"../../services/misc_functions\";\r\nfontawesome.library.add(\r\n  faTimes,\r\n  faBars,\r\n  faUserTie,\r\n  faUserGraduate,\r\n  faUserCog,\r\n  faUserTag,\r\n  faUser,\r\n  faCheck\r\n);\r\n\r\nlet intervalRef = React.createRef();\r\nlet loginTime = React.createRef();\r\n\r\nlet remainingSeconds = React.createRef();\r\nlet duration = React.createRef();\r\n\r\nlet role = React.createRef();\r\nlet username = React.createRef();\r\nlet tenant = React.createRef();\r\n\r\nexport default function HorizontalNavigationBar() {\r\n  const [isOpened, setIsOpened] = useState(false);\r\n\r\n  const usr = localStorage.getItem(\"username\");\r\n  const rl = localStorage.getItem(\"user-role\");\r\n  const tn = localStorage.getItem(\"user-tenant\");\r\n\r\n  username.current = usr !== null ? usr : \"\";\r\n  role.current = rl !== null ? rl : \"\";\r\n  tenant.current = tn !== null && tn !== \"\" ? tn : \"-\";\r\n\r\n  //useeffect on change time\r\n  useEffect(() => {\r\n    //convert duration time in string format to milliseconds\r\n    function DurationToMilliSeconds() {\r\n      let exp = localStorage.getItem(\"token-expiration-time\");\r\n\r\n      if (exp === null) return 300;\r\n      if (exp.endsWith(\"h\")) {\r\n        return parseInt(exp.slice(0, -1)) * 60 * 60 * 1000;\r\n      } else if (exp.endsWith(\"m\")) {\r\n        return parseInt(exp.slice(0, -1)) * 60 * 1000;\r\n      } else if (exp.endsWith(\"s\")) {\r\n        return parseInt(exp.slice(0, -1)) * 1000;\r\n      }\r\n      //default case, right now the same as seconds\r\n      else {\r\n        return parseInt(exp.slice(0, -1)) * 1000;\r\n      }\r\n    }\r\n\r\n    //calculate remaining seconds and refresh token if required\r\n    function CalcEnding() {\r\n      let t0;\r\n      let remainingSec;\r\n      //if remaining time is already calculated, just decrement that number by 1\r\n      if (remainingSeconds.current !== null) {\r\n        remainingSec = remainingSeconds.current - 1;\r\n      }\r\n      //otherwise, calculate remaining seconds\r\n      else {\r\n        //check if login time is already defined, if it's null get it from localstorage or current time (refresh case)\r\n        if (loginTime.current === null) {\r\n          const retryLoginTime = localStorage.getItem(\"login-time\");\r\n          //if localstorage containst login time, use it and store it into state\r\n          if (retryLoginTime !== null) {\r\n            loginTime.current = retryLoginTime;\r\n            t0 = parseInt(retryLoginTime, 10);\r\n          }\r\n          //otherwise get it from current time and store it into state\r\n          else {\r\n            t0 = Date.now();\r\n            loginTime.current = t0;\r\n          }\r\n        }\r\n        //use logintime stored into state\r\n        else {\r\n          t0 = parseInt(loginTime.current, 10);\r\n        }\r\n        if (duration.current === null)\r\n          duration.current = DurationToMilliSeconds();\r\n        const endTime = t0 + duration.current;\r\n\r\n        remainingSec = (endTime - Date.now()) / 1000;\r\n      }\r\n\r\n      if (remainingSec < 60) {\r\n        clearInterval(intervalRef.current);\r\n        refreshToken().then(() => {\r\n          remainingSeconds.current = null;\r\n          loginTime.current = null;\r\n\r\n          intervalRef.current = setInterval(() => {\r\n            CalcEnding();\r\n          }, 1000);\r\n          return;\r\n        });\r\n      }\r\n      if (remainingSec <= 0) {\r\n        localStorage.clear();\r\n        //session expired, automatically logout\r\n        window.location.replace(\"/\");\r\n        return;\r\n      }\r\n\r\n      //const mins = Math.floor(remainingSec / 60);\r\n      //const secs = Math.floor(remainingSec % 60);\r\n\r\n      remainingSeconds.current = parseInt(remainingSec, 10);\r\n    }\r\n\r\n    intervalRef.current = setInterval(() => {\r\n      CalcEnding();\r\n    }, 1000);\r\n  }, []);\r\n\r\n  function logOut() {\r\n    localStorage.clear();\r\n    document.location.replace(\"/\");\r\n  }\r\n\r\n  function renderIconRole() {\r\n    if (role.current === \"admin\") {\r\n      return (\r\n        <i className=\"fa fa-user-tie\" aria-hidden=\"true\" title=\"Admin\"></i>\r\n      );\r\n    } else if (role.current === \"provider\") {\r\n      return (\r\n        <i\r\n          className=\"fa fa-user-graduate\"\r\n          aria-hidden=\"true\"\r\n          title=\"Provider\"\r\n        ></i>\r\n      );\r\n    } else if (role.current === \"analyst\") {\r\n      return (\r\n        <i className=\"fa fa-user-cog\" aria-hidden=\"true\" title=\"Analyst\"></i>\r\n      );\r\n    } else if (role.current === \"supplier\") {\r\n      return (\r\n        <i className=\"fa fa-user-tag\" aria-hidden=\"true\" title=\"Supplier\"></i>\r\n      );\r\n    } else {\r\n      return (\r\n        <i className=\"fa fa-user\" aria-hidden=\"true\" aria-label=\"User\"></i>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <nav className=\"horizontal-nav\">\r\n      <div className=\"horizontal-nav-links\">\r\n        <div className=\"data-wrapper\">\r\n          <Container fluid>\r\n            <Row style={{ padding: 0 }}>\r\n              <Col>\r\n                <NavLink to=\"/home\" className=\"nav-wrap\">\r\n                  {website_name}\r\n                </NavLink>\r\n              </Col>\r\n              <Col>\r\n                <NavLink to={`/viewProfile/`} key={`viewProfile`}>\r\n                  {locale().welcome + \" \"}\r\n                  <b>{username.current}</b>\r\n                </NavLink>\r\n              </Col>\r\n              <Col>\r\n                <div className=\"horizontal-nav-text\">\r\n                  {locale().role + \" \"}\r\n                  {renderIconRole()}\r\n                </div>\r\n              </Col>\r\n              <Col>\r\n                <div className=\"horizontal-nav-text\">\r\n                  {locale().tenant + \" \"}\r\n                  <b>{tenant.current}</b>\r\n                </div>\r\n              </Col>\r\n              <Col>\r\n                <Button variant=\"outline-danger\" onClick={() => logOut()}>\r\n                  {locale().logout}\r\n                </Button>\r\n              </Col>\r\n\r\n              {languages.length > 1 && (\r\n                <Col>\r\n                  <LanguageSelector />\r\n                </Col>\r\n              )}\r\n              <Col>\r\n                <NotificationBar />\r\n              </Col>\r\n            </Row>\r\n            <Row style={{ padding: 0 }}>\r\n              <hr />\r\n              <div\r\n                style={{\r\n                  justifyContent: \"center\",\r\n                  alignItems: \"center\",\r\n                  alignSelf: \"flex-start\",\r\n                }}\r\n              >\r\n                {locale().resources}\r\n              </div>\r\n            </Row>\r\n            <Row style={{ padding: 0 }}>\r\n              {React.Children.toArray(\r\n                Object.keys(pages).map((k) => {\r\n                  //check if user can access to the page\r\n                  if (!canDo(role.current, k, \"read\")) {\r\n                    return \"\";\r\n                  }\r\n                  return (\r\n                    <Col>\r\n                      <NavLink\r\n                        to={`/` + k}\r\n                        className={(navData) =>\r\n                          navData.isActive ? \"active\" : \"\"\r\n                        }\r\n                        //activeClassName=\"active\"\r\n                        key={k}\r\n                        onClick={() => setIsOpened(false)}\r\n                      >\r\n                        {capitalize(k)}\r\n                      </NavLink>\r\n                    </Col>\r\n                  );\r\n                })\r\n              )}\r\n            </Row>\r\n          </Container>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n","import React, { useContext, useEffect } from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport { nonDefaultLength, capitalize } from \"../../services/misc_functions\";\r\nimport { Button, Form, Accordion, Container, Row, Col } from \"react-bootstrap\";\r\n\r\nimport TextField from \"@mui/material/TextField\";\r\nimport Autocomplete from \"@mui/material/Autocomplete\";\r\nimport AppContext from \"../../context\";\r\nimport { fetchedPageTypes, fetchedPageData, guidelines } from \"../../config\";\r\n\r\nexport const FormManager = (props) => {\r\n  //return if something is undefined\r\n  const context = useContext(AppContext);\r\n  let myFetched;\r\n  if (context !== undefined) myFetched = context.fetched;\r\n  else myFetched = {};\r\n\r\n  if (\r\n    props.values === undefined ||\r\n    props.resource === undefined ||\r\n    props.disabledFields === undefined ||\r\n    props.functionalFields === undefined ||\r\n    props.submitFunction === undefined ||\r\n    props.backFunction === undefined ||\r\n    props.handleChangesCallback === undefined ||\r\n    props.arrayDeleteCallback === undefined\r\n  )\r\n    return \"Loading\";\r\n  /*\r\n  console.log({\r\n    values: props.values,\r\n    resource: props.resource,\r\n    disabledFields: props.disabledFields,\r\n    functionalFields: props.functionalFields,\r\n    submitFunction: props.submitFunction,\r\n    backFunction: props.backFunction,\r\n    handleChangesCallback: props.handleChangesCallback,\r\n    arrayDeleteCallback: props.arrayDeleteCallback,\r\n    fetchedData: myFetched.data,\r\n    fetchedTypes: fetchedPageTypes,\r\n  });\r\n*/\r\n  //Numeric for row component\r\n  const NumericFormRow = (key) => {\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{key}</b>\r\n        </Col>\r\n        <Col sm={6}>\r\n          <Form.Group className=\"mb-3\">\r\n            <Form.Control\r\n              type=\"number\"\r\n              id={key}\r\n              onChange={(e) => {\r\n                e.preventDefault();\r\n                props.handleChangesCallback(parseInt(e.target.value, 10), [\r\n                  key,\r\n                ]);\r\n              }}\r\n              value={isNaN(props.values[key]) ? \"\" : props.values[key]}\r\n              disabled={\r\n                props.disabledFields[key] !== undefined\r\n                  ? props.disabledFields[key]\r\n                  : false\r\n              }\r\n              placeholder={locale().enter + \" \" + key}\r\n            />\r\n            {guidelines[props.resource] !== undefined &&\r\n              guidelines[props.resource][key] !== undefined && (\r\n                <Form.Text className=\"text-muted\">\r\n                  {guidelines[props.resource][key]}\r\n                </Form.Text>\r\n              )}\r\n          </Form.Group>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n  //string for row component\r\n  const StringFormRow = (key) => {\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{key}</b>\r\n        </Col>\r\n\r\n        <Col sm={6}>\r\n          <Form.Group className=\"mb-3\">\r\n            <Form.Control\r\n              type={key === \"password\" ? \"password\" : \"text\"}\r\n              id={key}\r\n              onChange={(e) => {\r\n                e.preventDefault();\r\n                props.handleChangesCallback(e.target.value, [key]);\r\n              }}\r\n              disabled={\r\n                props.disabledFields[key] !== undefined\r\n                  ? props.disabledFields[key]\r\n                  : false\r\n              }\r\n              value={props.values[key]}\r\n              placeholder={locale().enter + \" \" + key}\r\n            />\r\n            {guidelines[props.resource] !== undefined &&\r\n              guidelines[props.resource][key] !== undefined && (\r\n                <Form.Text className=\"text-muted\">\r\n                  {guidelines[props.resource][key]}\r\n                </Form.Text>\r\n              )}\r\n          </Form.Group>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n  //fetched data for row component\r\n  const FetchedFormRow = (key, alias) => {\r\n    let options;\r\n    if (\r\n      myFetched !== {} &&\r\n      (myFetched.data[key] !== undefined || myFetched.data[alias] !== undefined)\r\n    ) {\r\n      options = myFetched.data[alias !== undefined ? alias : key];\r\n    }\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{key}</b>\r\n        </Col>\r\n\r\n        <Col sm={6}>\r\n          <Form.Group className=\"mb-3\">\r\n            <Autocomplete\r\n              id={key}\r\n              onChange={(e, newValue) => {\r\n                e.preventDefault();\r\n                props.handleChangesCallback(newValue, [key]);\r\n              }}\r\n              disabled={\r\n                props.disabledFields[key] !== undefined\r\n                  ? props.disabledFields[key]\r\n                  : false\r\n              }\r\n              value={props.values[key] === \"\" ? null : props.values[key]}\r\n              options={options}\r\n              renderInput={(params) => (\r\n                <TextField {...params} label={locale().enter + \" \" + key} />\r\n              )}\r\n            />\r\n          </Form.Group>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n  //select form row component\r\n  const SelectFormRow = (key, val) => {\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{key}</b>\r\n        </Col>\r\n        <Col sm={6}>\r\n          <Form.Group className=\"mb-3\">\r\n            <Form.Select\r\n              aria-label=\"Default select\"\r\n              value={props.values[key]}\r\n              id={key}\r\n              onChange={(e) => {\r\n                e.preventDefault();\r\n                props.handleChangesCallback(e.target.value, [key]);\r\n              }}\r\n              disabled={\r\n                props.disabledFields[key] !== undefined\r\n                  ? props.disabledFields[key]\r\n                  : false\r\n              }\r\n            >\r\n              <option>{locale().select + \" \" + key}</option>\r\n              {React.Children.toArray(\r\n                Object.entries(val).map(([k, v]) => {\r\n                  return <option value={v}>{v}</option>;\r\n                })\r\n              )}\r\n            </Form.Select>\r\n          </Form.Group>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n  //numbers array form row component\r\n  const ArrayNumberFormRow = (k) => {\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{k}</b>\r\n        </Col>\r\n        <Col sm={6}>\r\n          {React.Children.toArray(\r\n            props.values[k].map((value, index) => {\r\n              return (\r\n                <Row>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>\r\n                      Insert <b>{k}</b>\r\n                      <i>[{index}]</i>\r\n                    </Form.Label>\r\n                    <Form.Control\r\n                      type=\"number\"\r\n                      disabled={\r\n                        props.disabledFields[k] !== undefined\r\n                          ? props.disabledFields[k]\r\n                          : false\r\n                      }\r\n                      onChange={(e) => {\r\n                        e.preventDefault();\r\n                        props.handleChangesCallback(\r\n                          parseInt(e.target.value, 10),\r\n                          [k, index]\r\n                        );\r\n                      }}\r\n                      value={\r\n                        isNaN(props.values[k][index])\r\n                          ? \"\"\r\n                          : props.values[k][index]\r\n                      }\r\n                      placeholder={locale().enter + \" \" + k}\r\n                    />\r\n                  </Form.Group>\r\n                </Row>\r\n              );\r\n            })\r\n          )}\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n  //strings array form row component\r\n  const ArrayStringFormRow = (key) => {\r\n    let options;\r\n    if (myFetched !== {} && myFetched.data[key] !== undefined) {\r\n      options = myFetched.data[key];\r\n    }\r\n\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{key}</b>\r\n        </Col>\r\n        <Col>\r\n          {React.Children.toArray(\r\n            props.values[key].map((value, index) => {\r\n              return (\r\n                <Row>\r\n                  <Col sm={1}>\r\n                    <Button\r\n                      disabled={\r\n                        props.disabledFields[key] !== undefined\r\n                          ? props.disabledFields[key]\r\n                          : false\r\n                      }\r\n                      variant=\"link\"\r\n                      size=\"sm\"\r\n                      onClick={(e) => {\r\n                        e.preventDefault();\r\n                        props.arrayDeleteCallback([key, index]);\r\n                      }}\r\n                    >\r\n                      <i\r\n                        className=\"fa fa-times\"\r\n                        aria-hidden=\"true\"\r\n                        title=\"Remove element\"\r\n                        style={{\r\n                          width: 30 + \"px\",\r\n                          height: 30 + \"px\",\r\n                          marginRight: 10 + \"px\",\r\n                          opacity: 0.85,\r\n                        }}\r\n                      ></i>\r\n                    </Button>\r\n                  </Col>\r\n                  <Col sm={6}>\r\n                    <Form.Group className=\"mb-3\">\r\n                      {myFetched.data[key] !== undefined ? (\r\n                        <Autocomplete\r\n                          disabled={\r\n                            props.disabledFields[key] !== undefined\r\n                              ? props.disabledFields[key]\r\n                              : false\r\n                          }\r\n                          id={key}\r\n                          onChange={(e, newValue) => {\r\n                            e.preventDefault();\r\n                            props.handleChangesCallback(newValue, [key, index]);\r\n                          }}\r\n                          value={\r\n                            props.values[key][index] === \"\"\r\n                              ? null\r\n                              : props.values[key][index]\r\n                          }\r\n                          options={options}\r\n                          renderInput={(params) => (\r\n                            <TextField\r\n                              {...params}\r\n                              label={locale().enter + \" \" + key}\r\n                            />\r\n                          )}\r\n                        />\r\n                      ) : (\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          disabled={\r\n                            props.disabledFields[key] !== undefined\r\n                              ? props.disabledFields[key]\r\n                              : false\r\n                          }\r\n                          onChange={(e) => {\r\n                            e.preventDefault();\r\n                            props.handleChangesCallback(e.target.value, [\r\n                              key,\r\n                              index,\r\n                            ]);\r\n                          }}\r\n                          value={props.values[key][index]}\r\n                          placeholder={locale().enter + \" \" + key}\r\n                        />\r\n                      )}\r\n                    </Form.Group>\r\n                  </Col>\r\n\r\n                  <Col md=\"auto\"></Col>\r\n                </Row>\r\n              );\r\n            })\r\n          )}\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n\r\n  //strings array form row component\r\n  const ArrayObjectFormRow = (key) => {\r\n    return (\r\n      <Row\r\n        style={{\r\n          borderBottomStyle: \"solid\",\r\n          borderBottomWidth: 1 + \"px\",\r\n          marginBottom: 5 + \"px\",\r\n        }}\r\n      >\r\n        <Col\r\n          sm={2}\r\n          style={{\r\n            borderRightStyle: \"dotted\",\r\n            borderRightWidth: 1 + \"px\",\r\n          }}\r\n        >\r\n          <b>{key}</b>\r\n        </Col>\r\n        <Col>\r\n          <Row\r\n            style={{\r\n              borderBottomStyle: \"solid\",\r\n              borderBottomWidth: 1 + \"px\",\r\n              marginBottom: 5 + \"px\",\r\n            }}\r\n          >\r\n            {key !== \"metadata\" && (\r\n              <Col sm={1}>\r\n                <b>\r\n                  <i>Remove</i>\r\n                </b>\r\n              </Col>\r\n            )}\r\n            {Object.keys(props.values[key][0]).map((k) => {\r\n              return (\r\n                <Col sm={4}>\r\n                  <b>\r\n                    <i>{capitalize(key) + \" \" + k}</i>\r\n                  </b>\r\n                </Col>\r\n              );\r\n            })}\r\n          </Row>\r\n          {React.Children.toArray(\r\n            props.values[key].map((obj, index) => {\r\n              return (\r\n                <Row>\r\n                  {key !== \"metadata\" && (\r\n                    <Col sm={1}>\r\n                      <Button\r\n                        disabled={\r\n                          props.disabledFields[key] !== undefined\r\n                            ? props.disabledFields[key]\r\n                            : false\r\n                        }\r\n                        variant=\"link\"\r\n                        size=\"sm\"\r\n                        onClick={(e) => {\r\n                          e.preventDefault();\r\n                          props.arrayDeleteCallback([key, index]);\r\n                        }}\r\n                      >\r\n                        <i\r\n                          className=\"fa fa-times\"\r\n                          aria-hidden=\"true\"\r\n                          title=\"Remove element\"\r\n                          style={{\r\n                            width: 30 + \"px\",\r\n                            height: 30 + \"px\",\r\n                            marginRight: 10 + \"px\",\r\n                            opacity: 0.85,\r\n                          }}\r\n                        ></i>\r\n                      </Button>\r\n                    </Col>\r\n                  )}\r\n\r\n                  {React.Children.toArray(\r\n                    Object.entries(obj).map(([k, value]) => {\r\n                      const disabled =\r\n                        props.disabledFields[key] !== undefined\r\n                          ? props.disabledFields[key][k] !== undefined\r\n                            ? props.disabledFields[key][k]\r\n                            : props.disabledFields[key] === true\r\n                            ? true\r\n                            : false\r\n                          : false;\r\n                      if (typeof value === \"number\") {\r\n                        return (\r\n                          <Col sm={4}>\r\n                            <Form.Group className=\"mb-3\">\r\n                              <Form.Control\r\n                                type=\"number\"\r\n                                onChange={(e) => {\r\n                                  e.preventDefault();\r\n                                  props.handleChangesCallback(\r\n                                    parseInt(e.target.value, 10),\r\n                                    [key, index, k]\r\n                                  );\r\n                                }}\r\n                                key={key + k + index + \"\"}\r\n                                disabled={disabled}\r\n                                value={\r\n                                  isNaN(props.values[key][index][k])\r\n                                    ? \"\"\r\n                                    : props.values[key][index][k]\r\n                                }\r\n                                placeholder={locale().enter + \" \" + k}\r\n                              />\r\n                            </Form.Group>\r\n                          </Col>\r\n                        );\r\n                      }\r\n                      //check if it's an enum\r\n                      if (\r\n                        fetchedPageTypes[props.resource] !== undefined &&\r\n                        fetchedPageTypes[props.resource][key] !== undefined &&\r\n                        fetchedPageTypes[props.resource][key][k] !==\r\n                          undefined &&\r\n                        myFetched.types !== undefined &&\r\n                        myFetched.types[\r\n                          fetchedPageTypes[props.resource][key][k]\r\n                        ] !== undefined\r\n                      ) {\r\n                        return (\r\n                          <Col sm={4}>\r\n                            <Form.Group className=\"mb-3\">\r\n                              <Form.Select\r\n                                aria-label=\"Default select\"\r\n                                onChange={(e) => {\r\n                                  e.preventDefault();\r\n                                  props.handleChangesCallback(e.target.value, [\r\n                                    key,\r\n                                    index,\r\n                                    k,\r\n                                  ]);\r\n                                }}\r\n                                value={props.values[key][index][k]}\r\n                                disabled={disabled}\r\n                              >\r\n                                <option>{locale().select + \" \" + k}</option>\r\n                                {React.Children.toArray(\r\n                                  Object.entries(\r\n                                    myFetched.types[\r\n                                      fetchedPageTypes[props.resource][key][k]\r\n                                    ]\r\n                                  ).map(([k, v]) => {\r\n                                    return <option value={k}>{v}</option>;\r\n                                  })\r\n                                )}\r\n                              </Form.Select>\r\n                            </Form.Group>\r\n                          </Col>\r\n                        );\r\n                      }\r\n                      //input field is a string\r\n                      if (typeof value === \"string\") {\r\n                        return (\r\n                          <Col sm={4}>\r\n                            <Form.Group className=\"mb-3\">\r\n                              <Form.Control\r\n                                type=\"text\"\r\n                                disabled={disabled}\r\n                                onChange={(e) => {\r\n                                  e.preventDefault();\r\n                                  props.handleChangesCallback(e.target.value, [\r\n                                    key,\r\n                                    index,\r\n                                    k,\r\n                                  ]);\r\n                                }}\r\n                                value={props.values[key][index][k]}\r\n                                placeholder={locale().enter + \" \" + k}\r\n                              />\r\n                              {key === \"metadata\" &&\r\n                                k === \"name\" &&\r\n                                props.values[key][index][k] === \"Country\" && (\r\n                                  <Form.Text className=\"text-muted\">\r\n                                    Please, enter 2-letter country code (i.e.,\r\n                                    It, De, Fr, etc...).\r\n                                  </Form.Text>\r\n                                )}\r\n                            </Form.Group>\r\n                          </Col>\r\n                        );\r\n                      }\r\n                      //the object contains an array\r\n                      if (Array.isArray(value)) {\r\n                        if (value.length === 0) return k + \" is empty\";\r\n\r\n                        //only show range field when enum type is selected, otherwise skip it\r\n                        if (\r\n                          k === \"range\" &&\r\n                          props.values[key][index][\"type\"] !== \"enum\"\r\n                        )\r\n                          return \"\";\r\n                        return (\r\n                          <Row>\r\n                            <Accordion defaultActiveKey=\"0\">\r\n                              <Accordion.Item eventKey=\"0\">\r\n                                <Accordion.Header>\r\n                                  <b>{k}</b> : {nonDefaultLength(value)} items\r\n                                </Accordion.Header>\r\n                                <Accordion.Body>\r\n                                  {React.Children.toArray(\r\n                                    value.map((e, idx) => {\r\n                                      if (e.constructor === Object) {\r\n                                        const entr = Object.entries(e);\r\n                                        return (\r\n                                          <Row>\r\n                                            <Col\r\n                                              sm={1}\r\n                                              style={{\r\n                                                borderRightStyle: \"dotted\",\r\n                                                borderRightWidth: 1 + \"px\",\r\n                                              }}\r\n                                            ></Col>\r\n                                            <Col sm={1}>\r\n                                              <Button\r\n                                                disabled={\r\n                                                  props.disabledFields[key] !==\r\n                                                  undefined\r\n                                                    ? props.disabledFields[key]\r\n                                                    : false\r\n                                                }\r\n                                                variant=\"link\"\r\n                                                size=\"sm\"\r\n                                                onClick={(e) => {\r\n                                                  e.preventDefault();\r\n                                                  props.arrayDeleteCallback([\r\n                                                    key,\r\n                                                    index,\r\n                                                    k,\r\n                                                    idx,\r\n                                                  ]);\r\n                                                }}\r\n                                              >\r\n                                                <i\r\n                                                  className=\"fa fa-times\"\r\n                                                  aria-hidden=\"true\"\r\n                                                  title=\"Remove element\"\r\n                                                  style={{\r\n                                                    width: 30 + \"px\",\r\n                                                    height: 30 + \"px\",\r\n                                                    marginRight: 10 + \"px\",\r\n                                                    opacity: 0.85,\r\n                                                  }}\r\n                                                ></i>\r\n                                              </Button>\r\n                                            </Col>\r\n\r\n                                            {React.Children.toArray(\r\n                                              entr.map(([_k, _v]) => {\r\n                                                return (\r\n                                                  <Col sm={4}>\r\n                                                    <Form.Group className=\"mb-3\">\r\n                                                      <Form.Control\r\n                                                        type=\"text\"\r\n                                                        disabled={disabled}\r\n                                                        onChange={(e) => {\r\n                                                          e.preventDefault();\r\n                                                          props.handleChangesCallback(\r\n                                                            e.target.value,\r\n                                                            [\r\n                                                              key,\r\n                                                              index,\r\n                                                              k,\r\n                                                              idx,\r\n                                                              _k,\r\n                                                            ]\r\n                                                          );\r\n                                                        }}\r\n                                                        value={_v}\r\n                                                        placeholder={\r\n                                                          locale().enter +\r\n                                                          \" \" +\r\n                                                          _k\r\n                                                        }\r\n                                                      />\r\n                                                    </Form.Group>\r\n                                                  </Col>\r\n                                                );\r\n                                              })\r\n                                            )}\r\n                                          </Row>\r\n                                        );\r\n                                      } else if (typeof e === \"number\") {\r\n                                        return (\r\n                                          <Row>\r\n                                            <Col sm={1}>\r\n                                              <Button\r\n                                                disabled={disabled}\r\n                                                variant=\"link\"\r\n                                                size=\"sm\"\r\n                                                onClick={(e) => {\r\n                                                  e.preventDefault();\r\n\r\n                                                  props.arrayDeleteCallback([\r\n                                                    key,\r\n                                                    index,\r\n                                                    k,\r\n                                                    idx,\r\n                                                  ]);\r\n                                                }}\r\n                                              >\r\n                                                <i\r\n                                                  className=\"fa fa-times\"\r\n                                                  aria-hidden=\"true\"\r\n                                                  title=\"Remove element\"\r\n                                                  style={{\r\n                                                    width: 30 + \"px\",\r\n                                                    height: 30 + \"px\",\r\n                                                    marginRight: 10 + \"px\",\r\n                                                    opacity: 0.85,\r\n                                                  }}\r\n                                                ></i>\r\n                                              </Button>\r\n                                            </Col>\r\n                                            <Col sm={4}>\r\n                                              <Form.Control\r\n                                                type=\"number\"\r\n                                                disabled={disabled}\r\n                                                key={\"\" + key + index + k + idx}\r\n                                                onChange={(e) => {\r\n                                                  e.preventDefault();\r\n                                                  props.handleChangesCallback(\r\n                                                    parseInt(\r\n                                                      e.target.value,\r\n                                                      10\r\n                                                    ),\r\n                                                    [key, index, k, idx]\r\n                                                  );\r\n                                                }}\r\n                                                value={isNaN(e) ? \"\" : e} //{props.values[k][index]}\r\n                                                placeholder={\r\n                                                  locale().enter + \" \" + k\r\n                                                }\r\n                                              />\r\n                                            </Col>\r\n                                          </Row>\r\n                                        );\r\n                                      } else if (typeof e === \"string\") {\r\n                                        return (\r\n                                          <Row>\r\n                                            <Col sm={1}>\r\n                                              <Button\r\n                                                disabled={disabled}\r\n                                                variant=\"link\"\r\n                                                size=\"sm\"\r\n                                                onClick={(e) => {\r\n                                                  e.preventDefault();\r\n\r\n                                                  props.arrayDeleteCallback([\r\n                                                    key,\r\n                                                    index,\r\n                                                    k,\r\n                                                    idx,\r\n                                                  ]);\r\n                                                }}\r\n                                              >\r\n                                                <i\r\n                                                  className=\"fa fa-times\"\r\n                                                  aria-hidden=\"true\"\r\n                                                  title=\"Remove element\"\r\n                                                  style={{\r\n                                                    width: 30 + \"px\",\r\n                                                    height: 30 + \"px\",\r\n                                                    marginRight: 10 + \"px\",\r\n                                                    opacity: 0.85,\r\n                                                  }}\r\n                                                ></i>\r\n                                              </Button>\r\n                                            </Col>\r\n                                            <Col sm={4}>\r\n                                              <Form.Control\r\n                                                type=\"text\"\r\n                                                disabled={\r\n                                                  props.disabledFields[k] !==\r\n                                                  undefined\r\n                                                    ? props.disabledFields[k]\r\n                                                    : false\r\n                                                }\r\n                                                key={\"\" + key + index + k + idx}\r\n                                                onChange={(e) => {\r\n                                                  e.preventDefault();\r\n                                                  props.handleChangesCallback(\r\n                                                    e.target.value,\r\n                                                    [key, index, k, idx]\r\n                                                  );\r\n                                                }}\r\n                                                value={e} //{props.values[k][index]}\r\n                                                placeholder={\r\n                                                  locale().enter + \" \" + k\r\n                                                }\r\n                                              />\r\n                                            </Col>\r\n                                          </Row>\r\n                                        );\r\n                                      }\r\n                                      return \"Unknown data type\";\r\n                                    })\r\n                                  )}\r\n                                </Accordion.Body>\r\n                              </Accordion.Item>\r\n                            </Accordion>\r\n                          </Row>\r\n                        );\r\n                      }\r\n                      return \"Unknown data type\";\r\n                    })\r\n                  )}\r\n                </Row>\r\n              );\r\n            })\r\n          )}\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n  //object form row comopnent\r\n  const ObjectFormRow = (key) => {\r\n    return \"TODO ObjectFormRow\";\r\n  };\r\n\r\n  return (\r\n    <Form onSubmit={props.submitFunction}>\r\n      <Container fluid>\r\n        {\r\n          //in case of unfetched data, do nothing\r\n          props.functionalFields[props.resource] === undefined &&\r\n            \"No operation allowed\"\r\n        }\r\n        {props.functionalFields[props.resource] !== undefined &&\r\n          React.Children.toArray(\r\n            Object.entries(props.values).map(([key, value]) => {\r\n              //enum type defined by config\r\n              //check if all the required resources are defined\r\n\r\n              if (\r\n                fetchedPageTypes[props.resource] !== undefined &&\r\n                fetchedPageTypes[props.resource][key] !== undefined &&\r\n                myFetched.types !== undefined &&\r\n                myFetched.types[fetchedPageTypes[props.resource][key]] !==\r\n                  undefined\r\n              ) {\r\n                return SelectFormRow(\r\n                  key,\r\n                  myFetched.types[fetchedPageTypes[props.resource][key]]\r\n                );\r\n              }\r\n              //input field is an array\r\n              if (Array.isArray(value)) {\r\n                if (typeof value[0] === \"number\") {\r\n                  return ArrayNumberFormRow(key);\r\n                }\r\n                if (typeof value[0] === \"string\") {\r\n                  return ArrayStringFormRow(key);\r\n                }\r\n                if (value[0].constructor === Object) {\r\n                  return ArrayObjectFormRow(key);\r\n                }\r\n              }\r\n              //input field is a number\r\n              if (typeof value === \"number\") {\r\n                return NumericFormRow(key);\r\n              }\r\n              //input field for fetched data\r\n\r\n              if (\r\n                fetchedPageData[props.resource] !== undefined &&\r\n                fetchedPageData[props.resource][key] !== undefined &&\r\n                myFetched.data[fetchedPageData[props.resource][key]] !==\r\n                  undefined\r\n              ) {\r\n                return FetchedFormRow(\r\n                  key,\r\n                  fetchedPageData[props.resource][key]\r\n                );\r\n              }\r\n              //input field is a string\r\n              if (typeof value === \"string\") {\r\n                return StringFormRow(key);\r\n              }\r\n\r\n              //input field is an object\r\n              if (value.constructor === Object) {\r\n                return ObjectFormRow();\r\n              }\r\n              //default return\r\n              return \"\";\r\n            })\r\n          )}\r\n      </Container>\r\n      <Button variant=\"primary\" type=\"submit\" key={\"submit\"}>\r\n        {locale().submit}\r\n      </Button>\r\n      &nbsp;&nbsp;&nbsp;\r\n      <Button variant=\"secondary\" key={\"cancel\"} onClick={props.backFunction}>\r\n        {locale().cancel}\r\n      </Button>\r\n    </Form>\r\n  );\r\n};\r\n","import { isDefault, removeDefaultElements } from \"./misc_functions\";\r\n\r\nconst cloneDeep = require(\"clone-deep\");\r\n\r\n// this function sort keys of an object and of its array-of-objects values (recursively) based on a template\r\nexport function sortObject(obj, template) {\r\n  //keys of the object to sort\r\n  let keys = Object.keys(obj);\r\n  //sorted array of keys\r\n  const sortingKeys = Object.keys(template);\r\n  //remove uncommon keys between the two arrays from the key array\r\n  keys = keys.filter((ob) => {\r\n    return sortingKeys.indexOf(ob) !== -1;\r\n  });\r\n  //sort the keys in the key array\r\n  keys.sort((a, b) => sortingKeys.indexOf(a) - sortingKeys.indexOf(b));\r\n\r\n  const sorted = keys.reduce((accumulator, key) => {\r\n    if (\r\n      Array.isArray(obj[key]) &&\r\n      obj[key].length !== 0 &&\r\n      obj[key][0].constructor === Object\r\n    ) {\r\n      const tmp = obj[key].map((el) => {\r\n        return sortObject(el, template[key][0]);\r\n      });\r\n\r\n      accumulator[key] = tmp;\r\n    } else accumulator[key] = obj[key];\r\n\r\n    return accumulator;\r\n  }, {});\r\n  return sorted;\r\n}\r\n\r\n//this function will check of each field of the object if it's an array, and then, only for array values, check if empty elements are contained into that array\r\nexport function maintainEmptyElements(original, fieldSpecifier, resource) {\r\n  const keys = Object.keys(original);\r\n  let copy = cloneDeep(original);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if (Array.isArray(copy[keys[i]])) {\r\n      copy = maintainEmptyElement(copy, [keys[i]], fieldSpecifier, resource);\r\n    }\r\n  }\r\n  return copy;\r\n}\r\n\r\nexport function maintainEmptyElement(\r\n  original,\r\n  path,\r\n  fieldSpecifier,\r\n  resource,\r\n  item = undefined\r\n) {\r\n  let tmp = cloneDeep(original);\r\n  let tmpPtr = tmp;\r\n  let fieldSpecifierCpy = cloneDeep(fieldSpecifier[resource]);\r\n  const tmpPath = [...path];\r\n\r\n  //get more nested array\r\n  for (let i = 0; i < tmpPath.length; i++) {\r\n    if (path[i] === undefined) break;\r\n    tmpPtr = tmpPtr[path[i]];\r\n  }\r\n\r\n  //get the appropriate item, if possible\r\n  for (let i = 0; i < tmpPath.length; i++) {\r\n    if (path[i] === undefined) break;\r\n    if (fieldSpecifierCpy === undefined) break;\r\n    //ignore indexes for fieldSpecifierCpy\r\n    if (typeof path[i] === \"number\") fieldSpecifierCpy = fieldSpecifierCpy[0];\r\n    else fieldSpecifierCpy = fieldSpecifierCpy[path[i]];\r\n  }\r\n\r\n  //non array case\r\n  if (!Array.isArray(fieldSpecifierCpy)) return tmp;\r\n\r\n  //add item according to addfield dictionary\r\n  if (fieldSpecifierCpy !== undefined) {\r\n    //0-length array\r\n    if (tmpPtr.length === 0) {\r\n      if (fieldSpecifierCpy[0].constructor === Object) {\r\n        tmpPtr.push({\r\n          ...fieldSpecifierCpy[0],\r\n        });\r\n      } else {\r\n        tmpPtr.push(\"\");\r\n      }\r\n    }\r\n    //else 0-length array\r\n    else {\r\n      if (tmpPtr[0].constructor === Object) {\r\n        //check if there are no default elements in array\r\n        if (tmpPtr.filter((e) => isDefault(e)).length === 0) {\r\n          tmpPtr.push({\r\n            ...fieldSpecifierCpy[0],\r\n          });\r\n        }\r\n      } else {\r\n        if (!tmpPtr.includes(\"\")) {\r\n          tmpPtr.push(\"\");\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  //add item according to params\r\n  if (item !== undefined && fieldSpecifierCpy === undefined) {\r\n    if (tmpPtr.length === 0) {\r\n      if (item.constructor === Object) {\r\n        tmpPtr.push({ ...item });\r\n      } else {\r\n        tmpPtr.push(item);\r\n      }\r\n    }\r\n    //else 0-length array\r\n    else {\r\n      if (tmpPtr.filter((e) => isDefault(e)).length === 0) {\r\n        if (item.constructor === Object) {\r\n          tmpPtr.push({ ...item });\r\n        } else {\r\n          tmpPtr.push(item);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return tmp;\r\n}\r\n","import React, { useEffect, useState, useContext } from \"react\";\r\nimport { get_generic, put_generic } from \"../../services/http_operations\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport {\r\n  areEqual,\r\n  isDefault,\r\n  removeDefaultElements,\r\n} from \"../../services/misc_functions\";\r\n\r\nimport { editFields, editFieldsSpecifier, fetchedPageData } from \"../../config\";\r\n\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nimport { FormManager } from \"../formManager/formManager\";\r\n\r\nimport AppContext from \"../../context\";\r\nimport {\r\n  sortObject,\r\n  maintainEmptyElement,\r\n  maintainEmptyElements,\r\n} from \"../../services/objects_manipulation\";\r\n\r\nconst cloneDeep = require(\"clone-deep\");\r\n\r\nexport default function EditContentPage(props) {\r\n  //get resource and id from url params\r\n  const { resource, id } = useParams();\r\n\r\n  const [original, setOriginal] = useState();\r\n  //message for user\r\n  const [msg, setMsg] = useState(\"\");\r\n  //redirect hook\r\n  const navigate = useNavigate();\r\n\r\n  //deep copy editOption dictionary without any references\r\n  const [values, setValues] = useState(cloneDeep(editFields[resource]));\r\n\r\n  //keep trace of deleted elements\r\n  const [deleted, setDeleted] = useState({});\r\n\r\n  const [disabledFields, setDisabledFields] = useState(undefined);\r\n  //const [mounted, setMounted] = useState(false);\r\n\r\n  const context = useContext(AppContext);\r\n  const myFetched = context.fetched;\r\n  /////////////FETCH REQUIRED RESOURCES\r\n  const fetchData = async (res) => {\r\n    if (myFetched.data[res] !== undefined) return;\r\n    // get the data from the api\r\n    try {\r\n      const response = await get_generic(res, { limit: 100 });\r\n      myFetched.UpdateData(\r\n        response.docs.map((e) => e._id),\r\n        res\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (fetchedPageData[resource] !== undefined) {\r\n      Object.values(fetchedPageData[resource]).forEach((e) => fetchData(e));\r\n    }\r\n  }, []);\r\n\r\n  //useeffect to get resource if required\r\n  useEffect(() => {\r\n    const fetchData = async (qs = {}) => {\r\n      // get the data from the api\r\n      const response = await get_generic(resource, qs);\r\n\r\n      const data = response.docs[0];\r\n      let tmpValues = cloneDeep(values);\r\n\r\n      tmpValues = sortObject(data, tmpValues);\r\n\r\n      //this function evaluate if a field should be disabled or not\r\n      const evaluateSpecifiers = async () => {\r\n        if (editFieldsSpecifier[resource] === undefined) {\r\n          setDisabledFields({});\r\n\r\n          const keys = Object.keys(tmpValues);\r\n          for (let i = 0; i < keys.length; i++) {\r\n            const _key = keys[i];\r\n\r\n            tmpValues = maintainEmptyElement(\r\n              tmpValues,\r\n              [_key],\r\n              editFields,\r\n              resource\r\n            );\r\n          }\r\n\r\n          setValues(tmpValues);\r\n          //deep copy and set state\r\n          setOriginal(cloneDeep(tmpValues));\r\n          return;\r\n        }\r\n\r\n        let disabled = {};\r\n        if (disabledFields !== undefined) disabled = disabledFields;\r\n\r\n        const specsEntries = Object.entries(editFieldsSpecifier[resource]);\r\n\r\n        for (let i = 0; i < specsEntries.length; i++) {\r\n          const key = specsEntries[i][0]; //key\r\n          const value = specsEntries[i][1]; //value\r\n\r\n          if (tmpValues[key] === undefined) continue;\r\n\r\n          if (value.type === \"disable\") {\r\n            const resp = await value.policy(id);\r\n\r\n            disabled[key] = resp;\r\n          }\r\n        }\r\n\r\n        const keys = Object.keys(tmpValues);\r\n        for (let i = 0; i < keys.length; i++) {\r\n          const _key = keys[i];\r\n\r\n          if (disabled[_key] === undefined || disabled[_key] === false) {\r\n            tmpValues = maintainEmptyElement(\r\n              tmpValues,\r\n              [_key],\r\n              editFields,\r\n              resource\r\n            );\r\n          }\r\n        }\r\n\r\n        setDisabledFields(disabled);\r\n\r\n        setValues(tmpValues);\r\n        //deep copy and set state\r\n        setOriginal(cloneDeep(tmpValues));\r\n      };\r\n\r\n      evaluateSpecifiers();\r\n    };\r\n\r\n    const fst = { _id: id };\r\n    const qs = { filter: JSON.stringify(fst) };\r\n    fetchData(qs);\r\n  }, []);\r\n\r\n  //handle changes\r\n  const handleChanges = (val, path) => {\r\n    let tmpVals = cloneDeep(values);\r\n    let valuesPtr = tmpVals;\r\n\r\n    let i;\r\n    let lastIndexNumber = -1;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      valuesPtr = valuesPtr[path[i]];\r\n      if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    }\r\n    if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    valuesPtr[path[i]] = val;\r\n    //check if an array is present\r\n    if (lastIndexNumber !== -1) {\r\n      //only string and numbers are allowed as item, with this version\r\n      const item = typeof val === \"number\" ? NaN : \"\";\r\n      tmpVals = maintainEmptyElement(\r\n        tmpVals,\r\n        path.slice(0, lastIndexNumber),\r\n        editFields,\r\n        resource,\r\n        item\r\n      );\r\n    }\r\n\r\n    setValues(tmpVals);\r\n  };\r\n\r\n  const back = (e) => {\r\n    e.preventDefault();\r\n    navigate(-1);\r\n  };\r\n\r\n  const handleDeleteItemArray = (path) => {\r\n    let val = cloneDeep(values);\r\n    let tmpPtr = val;\r\n\r\n    let i;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      if (path[i] === undefined) break;\r\n      tmpPtr = tmpPtr[path[i]];\r\n    }\r\n\r\n    const removed = tmpPtr.splice(path[i], 1);\r\n\r\n    const item = typeof removed[0] === \"number\" ? NaN : \"\";\r\n    val = maintainEmptyElement(\r\n      val,\r\n      path.slice(0, i),\r\n      editFields,\r\n      resource,\r\n      item\r\n    );\r\n\r\n    //save removed element into appropriate structure\r\n    //do this only when array is on first layer of object\r\n    if (i === 1) {\r\n      if (deleted[path[0]] === undefined)\r\n        deleted[path[0]] = { indexes: [], elements: [], minDel: Infinity };\r\n\r\n      //ignore default\r\n      if (!isDefault(removed[0])) {\r\n        //save element (maybe not required anymore)\r\n        deleted[path[0]].elements.push(removed[0]);\r\n        //save index of deletion (considering the original ones)\r\n\r\n        deleted[path[0]].indexes.push(\r\n          path[i] >= deleted[path[0]].minDel\r\n            ? path[i] +\r\n                deleted[[path[0]]].indexes.filter((e) => e >= path[i]).length\r\n            : path[i]\r\n        );\r\n\r\n        if (path[i] < deleted[path[0]].minDel)\r\n          deleted[path[0]].minDel = path[i];\r\n      }\r\n    }\r\n\r\n    setValues(val);\r\n  };\r\n\r\n  const submit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    //da fare\r\n    let tmpValues = cloneDeep(values);\r\n    let tmpOrig = cloneDeep(original);\r\n    removeDefaultElements(tmpValues);\r\n    removeDefaultElements(tmpOrig);\r\n    let toSend = {};\r\n\r\n    const entr = Object.entries(tmpValues);\r\n    for (let i = 0; i < entr.length; i++) {\r\n      const k = entr[i][0];\r\n      const v = entr[i][1];\r\n\r\n      //value is array\r\n      if (Array.isArray(v)) {\r\n        //prepare add/update/remove elements\r\n        if (toSend[k] === undefined)\r\n          toSend[k] = { add: [], remove: [], update: [] };\r\n\r\n        //get original length of that array\r\n        const origArr = [...tmpOrig[k]];\r\n        //add removed elements (from original elements)\r\n        if (deleted[k] !== undefined) {\r\n          for (let i = 0; i < deleted[k].indexes.length; i++) {\r\n            const removed = origArr.splice(deleted[k].indexes[i][0], 1)[0];\r\n            if (removed.constructor === Object) {\r\n              const key = Object.keys(removed)[0];\r\n              toSend[k].remove.push(removed[key]);\r\n            } else {\r\n              toSend[k].remove.push(removed);\r\n            }\r\n          }\r\n        }\r\n        //check other elements\r\n        for (let j = 0; j < tmpValues[k].length; j++) {\r\n          if (j < origArr.length && !areEqual(tmpValues[k][j], origArr[j])) {\r\n            //update management\r\n\r\n            //object case\r\n            if (tmpValues[k][j].constructor === Object) {\r\n              const key = Object.keys(origArr[j])[0];\r\n              toSend[k].update.push({\r\n                [key]: origArr[j][key],\r\n                new: tmpValues[k][j],\r\n              });\r\n            }\r\n            //non object case (i.e., strings)\r\n            else {\r\n              //remove the old value and add the new one\r\n              toSend[k].add.push(tmpValues[k][j]);\r\n              toSend[k].remove.push(origArr[j]);\r\n            }\r\n          }\r\n          if (j >= origArr.length) toSend[k].add.push(tmpValues[k][j]);\r\n        }\r\n        if (areEqual(toSend[k], { add: [], remove: [], update: [] }))\r\n          delete toSend[k];\r\n      }\r\n      //value is obj\r\n      else if (v.constructor === Object) {\r\n        //compare both obj\r\n      }\r\n      //single valued prop\r\n      else {\r\n        //update when values are different\r\n        if (v !== original[k]) toSend[k] = v;\r\n      }\r\n    }\r\n\r\n    //end da fare\r\n    console.log(toSend);\r\n    if (Object.keys(toSend).length === 0) {\r\n      setMsg(\"No changes found\");\r\n      return;\r\n    }\r\n    let res;\r\n    try {\r\n      const resp = await put_generic(resource, toSend, id);\r\n      res = resp.response;\r\n      setMsg(res.statusText);\r\n      navigate(\"/\" + resource);\r\n    } catch (error) {\r\n      res = error.error.response;\r\n      //add details\r\n      setMsg(\r\n        error.error.response.data.message +\r\n          \" : \" +\r\n          error.error.response.data.details\r\n      );\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">\r\n        Edit &nbsp;<b>{resource}</b>&nbsp;of id:&nbsp;<b>{id}</b>&nbsp;\r\n      </header>\r\n      <main className=\"page-content\">\r\n        <FormManager\r\n          values={values}\r\n          resource={resource}\r\n          functionalFields={editFields}\r\n          disabledFields={disabledFields}\r\n          handleChangesCallback={handleChanges}\r\n          arrayDeleteCallback={handleDeleteItemArray}\r\n          submitFunction={submit}\r\n          backFunction={back}\r\n        />\r\n        <br />\r\n        <font style={{ marginLeft: 5 + \"px\" }}>{msg}</font>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport { Button, Form, Accordion, Table } from \"react-bootstrap\";\r\n\r\nexport const FormFile = (props) => {\r\n  //return \"loading\" if something is undefined\r\n  /*console.log({\r\n    submit: props.submitFunction,\r\n    back: props.backFunction,\r\n    setContHead: props.setContentHeader,\r\n    setContBdy: props.setContentBody,\r\n    setContPln: props.setContentPlain,\r\n    setFl: props.setFile,\r\n    contBod: props.contentBody,\r\n    contPln: props.contentPlain,\r\n    contHdr: props.contentHeader,\r\n  });*/\r\n  if (\r\n    props.submitFunction === undefined ||\r\n    props.backFunction === undefined ||\r\n    props.setContentHeader === undefined ||\r\n    props.setContentPlain === undefined ||\r\n    props.setContentBody === undefined ||\r\n    props.setFile === undefined ||\r\n    props.contentBody === undefined ||\r\n    props.contentPlain === undefined ||\r\n    props.contentHeader === undefined\r\n  )\r\n    return \"Loading\";\r\n\r\n  return (\r\n    <Form onSubmit={props.submitFunction}>\r\n      <Form.Label>\r\n        <b>{locale().select_file}</b>\r\n      </Form.Label>\r\n      <Form.Control\r\n        className=\"mb-3\"\r\n        type=\"file\"\r\n        accept=\".csv, .json\"\r\n        label=\"File\"\r\n        onChange={(e) => {\r\n          const file = e.target.files[0];\r\n          props.setFile(file);\r\n          const fileReader = new FileReader();\r\n\r\n          fileReader.onloadend = () => {\r\n            const content = fileReader.result;\r\n            if (file.name.endsWith(\".csv\")) {\r\n              const regex = new RegExp(\"\\\\r\", \"g\");\r\n              let splitted = content.replace(regex, \"\").split(\"\\n\");\r\n\r\n              props.setContentHeader(splitted[0]);\r\n              splitted.splice(0, 1);\r\n              props.setContentBody(splitted);\r\n              props.setContentPlain(null);\r\n            }\r\n            if (file.name.endsWith(\".json\")) {\r\n              props.setContentHeader(null);\r\n              props.setContentBody(null);\r\n              props.setContentPlain(\r\n                JSON.stringify(JSON.parse(content), null, 4)\r\n              );\r\n            }\r\n          };\r\n          fileReader.readAsText(file);\r\n        }}\r\n      />\r\n      {props.contentBody !== null && props.contentHeader !== null && (\r\n        <Accordion>\r\n          <Accordion.Item eventKey=\"0\">\r\n            <Accordion.Header>{locale().file_content}</Accordion.Header>\r\n            <Accordion.Body style={{ overflow: \"scroll\", height: 70 + \"vh\" }}>\r\n              <Table responsive striped bordered hover>\r\n                <thead>\r\n                  <tr>\r\n                    {React.Children.toArray(\r\n                      props.contentHeader.split(\",\").map((h) => {\r\n                        return <th>{h}</th>;\r\n                      })\r\n                    )}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {React.Children.toArray(\r\n                    props.contentBody.map((e) => {\r\n                      return (\r\n                        <tr>\r\n                          {React.Children.toArray(\r\n                            e.split(\",\").map((h) => {\r\n                              return <td>{h}</td>;\r\n                            })\r\n                          )}\r\n                        </tr>\r\n                      );\r\n                    })\r\n                  )}\r\n                </tbody>\r\n              </Table>\r\n            </Accordion.Body>\r\n          </Accordion.Item>\r\n        </Accordion>\r\n      )}\r\n      {props.contentPlain !== null && (\r\n        <Accordion>\r\n          <Accordion.Item eventKey=\"0\">\r\n            <Accordion.Header>{locale().file_content}</Accordion.Header>\r\n            <Accordion.Body style={{ overflow: \"scroll\", height: 70 + \"vh\" }}>\r\n              <textarea\r\n                //style={{ resize: \"both;\" }}\r\n                cols=\"120\"\r\n                rows=\"10\"\r\n                readOnly\r\n              >\r\n                {props.contentPlain}\r\n              </textarea>\r\n            </Accordion.Body>\r\n          </Accordion.Item>\r\n        </Accordion>\r\n      )}\r\n      <Button variant=\"primary\" type=\"submit\" key={\"submit\"}>\r\n        {locale().submit}\r\n      </Button>\r\n      &nbsp;&nbsp;&nbsp;\r\n      <Button variant=\"secondary\" key={\"cancel\"} onClick={props.backFunction}>\r\n        {locale().cancel}\r\n      </Button>\r\n    </Form>\r\n  );\r\n};\r\n","import React, { useEffect, useState, useContext } from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport { addFields, addTypes } from \"../../config\";\r\nimport {\r\n  post_generic,\r\n  get_generic,\r\n  post_file_generic,\r\n} from \"../../services/http_operations\";\r\nimport {\r\n  isDefault,\r\n  removeDefaultElements,\r\n} from \"../../services/misc_functions\";\r\nimport { useParams, useSearchParams } from \"react-router-dom\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nimport { Nav } from \"react-bootstrap\";\r\nimport { FormManager } from \"../formManager/formManager\";\r\nimport { FormFile } from \"../formFileComp/formFile\";\r\n\r\nimport {\r\n  sortObject,\r\n  maintainEmptyElement,\r\n  maintainEmptyElements,\r\n} from \"../../services/objects_manipulation\";\r\nimport AppContext from \"../../context\";\r\nimport { fetchedPageTypes, fetchedPageData } from \"../../config\";\r\n\r\nconst cloneDeep = require(\"clone-deep\");\r\n\r\n/*\r\nAPPUNTI FORM\r\n\r\n <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\r\n            <Form.Label>\r\n              TEXT\r\n            </Form.Label>\r\n            <Form.Control type=\"text\" placeholder=\"PLACEHOLDER TEXT\" />\r\n            <Form.Text className=\"text-muted\">\r\n              LABEL\r\n            </Form.Text>\r\n          </Form.Group>\r\n\r\ntipi consentiti nel form control:\r\ntext | number (verifica del numero automatica) | email (verifica email automatica) | file | checkbox\r\n\r\n*/\r\n\r\nexport default function AddPage(props) {\r\n  //get resource and id from url params\r\n  let { resource } = useParams();\r\n  //get from attribute from search param\r\n\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n\r\n  //check if resource was passed as params - used for tenants creation\r\n  if (props.resource !== undefined) resource = props.resource;\r\n\r\n  //redirect hook\r\n  const navigate = useNavigate();\r\n  //type of input to post resources\r\n  const [postType, setPostType] = useState(\"form\");\r\n  //message for user\r\n  const [msg, setMsg] = useState(\"\");\r\n  const [isError, setIsError] = useState(false);\r\n\r\n  //deep copy addOption dictionary without any references\r\n  const [values, setValues] = useState(cloneDeep(addFields[resource]));\r\n\r\n  //file upload state\r\n  const [file, setFile] = useState(undefined);\r\n  const [contentHeader, setContentHeader] = useState(null);\r\n  const [contentBody, setContentBody] = useState(null);\r\n  const [contentPlain, setContentPlain] = useState(null);\r\n\r\n  const context = useContext(AppContext);\r\n  let myFetched;\r\n  if (context !== undefined) myFetched = context.fetched;\r\n  else myFetched = {};\r\n\r\n  /////////////FETCH REQUIRED RESOURCES\r\n  const fetchData = async (res) => {\r\n    if (myFetched.data[res] !== undefined) return;\r\n    // get the data from the api\r\n    try {\r\n      const response = await get_generic(res, { limit: 100 });\r\n      myFetched.UpdateData(\r\n        response.docs.map((e) => e._id),\r\n        res\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (fetchedPageData[resource] !== undefined) {\r\n      Object.values(fetchedPageData[resource]).forEach((e) => fetchData(e));\r\n    }\r\n  }, []);\r\n\r\n  //useeffect to get resource if required\r\n  useEffect(() => {\r\n    const fetchData = async (qs = {}) => {\r\n      // get the data from the api\r\n      const response = await get_generic(resource, qs);\r\n\r\n      const data = response.docs[0];\r\n      let tmpValues = cloneDeep(values);\r\n\r\n      tmpValues = sortObject(data, tmpValues);\r\n\r\n      tmpValues = maintainEmptyElements(tmpValues, addFields, resource);\r\n      setValues(tmpValues);\r\n    };\r\n\r\n    if (searchParams.get(\"from\") === null || searchParams.get(\"from\") === \"\")\r\n      return;\r\n    const fst = { _id: searchParams.get(\"from\") };\r\n    const qs = { filter: JSON.stringify(fst) };\r\n    fetchData(qs);\r\n  }, [searchParams, resource]);\r\n\r\n  //return if page shouldn't be rendered\r\n  if (addFields[resource] === undefined)\r\n    return <div>This entity cannot be posted</div>;\r\n\r\n  //handle changes\r\n  const handleChanges = (val, path) => {\r\n    let tmpVals = cloneDeep(values);\r\n    let valuesPtr = tmpVals;\r\n\r\n    let i;\r\n    let lastIndexNumber = -1;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      valuesPtr = valuesPtr[path[i]];\r\n      if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    }\r\n    valuesPtr[path[i]] = val;\r\n    if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n\r\n    if (lastIndexNumber !== -1)\r\n      tmpVals = maintainEmptyElement(\r\n        tmpVals,\r\n        path.slice(0, lastIndexNumber),\r\n        addFields,\r\n        resource\r\n      );\r\n\r\n    setValues(tmpVals);\r\n  };\r\n\r\n  const handleDeleteItemArray = (path) => {\r\n    let val = cloneDeep(values);\r\n    let tmpPtr = val;\r\n\r\n    let i;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      if (path[i] === undefined) break;\r\n      tmpPtr = tmpPtr[path[i]];\r\n    }\r\n\r\n    tmpPtr.splice(path[i], 1);\r\n\r\n    val = maintainEmptyElement(val, path.slice(0, i), addFields, resource);\r\n    setValues(val);\r\n  };\r\n  //handle way selector to post new entity\r\n  const handleTypeSelect = (eventKey) => {\r\n    setPostType(eventKey);\r\n    setMsg(\"\");\r\n    setIsError(false);\r\n  };\r\n\r\n  const back = (e) => {\r\n    e.preventDefault();\r\n    navigate(-1);\r\n  };\r\n\r\n  //post the body for forms\r\n  const postBody = async (e) => {\r\n    e.preventDefault();\r\n    //deep clone values\r\n    let token = undefined;\r\n    let body = cloneDeep(values);\r\n    if (body.token !== undefined) {\r\n      token = body.token;\r\n      delete body.token;\r\n    }\r\n\r\n    let tmpValues = cloneDeep(body);\r\n    removeDefaultElements(tmpValues);\r\n    let res;\r\n    try {\r\n      const resp = await post_generic(\r\n        resource,\r\n        JSON.stringify(tmpValues),\r\n        token\r\n      );\r\n      res = resp.response;\r\n      setMsg(res.statusText);\r\n      setIsError(false);\r\n    } catch (error) {\r\n      console.log(error);\r\n      res = error.error.response;\r\n      console.log({\r\n        message: error.error.response.data.message,\r\n        details: error.error.response.data.details,\r\n      });\r\n\r\n      let det = \"\";\r\n      if (error.error.response.data.details.includes(\"duplicate key\")) {\r\n        det =\r\n          locale().duplicate_error +\r\n          \" \" +\r\n          error.error.response.data.details.slice(\r\n            error.error.response.data.details.indexOf(\"{\") + 1,\r\n            -1\r\n          );\r\n      }\r\n      //default case: show details from error message\r\n      else {\r\n        det = error.error.response.data.details;\r\n      }\r\n      //add details\r\n      setMsg(error.error.response.data.message + \" : \" + det);\r\n      setIsError(true);\r\n    }\r\n\r\n    if (res.status === 200) {\r\n      if (window.confirm(\"Back to resource page?\") === true) {\r\n        if (resource === \"tenants\") navigate(\"/\");\r\n        else navigate(\"/\" + resource);\r\n      } else {\r\n      }\r\n    }\r\n  };\r\n\r\n  const postFile = async (e) => {\r\n    e.preventDefault();\r\n    let res;\r\n    if (file === undefined) {\r\n      setMsg(locale().no_file);\r\n      setIsError(true);\r\n      return;\r\n    }\r\n    if (file.name.endsWith(\".csv\")) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      try {\r\n        const resp = await post_file_generic(resource, formData);\r\n\r\n        res = resp.response;\r\n        setMsg(res.statusText);\r\n        setIsError(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n\r\n        res = error.error.response;\r\n        //add details\r\n        setMsg(\r\n          error.error.response.data.message +\r\n            \" : \" +\r\n            error.error.response.data.details\r\n        );\r\n        setIsError(true);\r\n      }\r\n    }\r\n    if (file.name.endsWith(\".json\")) {\r\n      try {\r\n        const resp = await post_generic(resource, contentPlain, undefined);\r\n        res = resp.response;\r\n        setMsg(res.statusText);\r\n        setIsError(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n        res = error.error.response;\r\n        //add details\r\n        setMsg(\r\n          error.error.response.data.message +\r\n            \" : \" +\r\n            error.error.response.data.details\r\n        );\r\n        setIsError(true);\r\n      }\r\n    }\r\n\r\n    if (res.status === 200) {\r\n      if (window.confirm(\"Back to resource page?\") === true) {\r\n        navigate(\"/\" + resource);\r\n      } else {\r\n      }\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">\r\n        Add resource &nbsp;\r\n        <b>{resource}</b>\r\n      </header>\r\n      <main className=\"page-content\">\r\n        <Nav\r\n          justify\r\n          variant=\"tabs\"\r\n          className=\"justify-content-center\"\r\n          onSelect={handleTypeSelect}\r\n          defaultActiveKey=\"form\"\r\n        >\r\n          {addTypes[resource].includes(\"form\") && (\r\n            <Nav.Item>\r\n              <Nav.Link eventKey=\"form\">Form</Nav.Link>\r\n            </Nav.Item>\r\n          )}\r\n\r\n          {addTypes[resource].includes(\"file\") &&\r\n            searchParams.get(\"from\") === null && (\r\n              <Nav.Item>\r\n                <Nav.Link eventKey=\"file\">File</Nav.Link>\r\n              </Nav.Item>\r\n            )}\r\n        </Nav>\r\n        <div\r\n          style={{\r\n            backgroundColor: \"#fff\",\r\n            borderRadius: 2 + \"px\",\r\n            borderStyle: \"solid\",\r\n            borderColor: \"rgba(18, 54, 81, 0.9)\",\r\n            borderWidth: 1 + \"px\",\r\n            width: 100 + \"%\",\r\n            height: \"fit-content\",\r\n          }}\r\n        >\r\n          {postType === \"form\" && (\r\n            <div style={{ margin: 5 + \"px\" }}>\r\n              <FormManager\r\n                values={values}\r\n                resource={resource}\r\n                functionalFields={addFields}\r\n                disabledFields={{}}\r\n                handleChangesCallback={handleChanges}\r\n                arrayDeleteCallback={handleDeleteItemArray}\r\n                submitFunction={postBody}\r\n                backFunction={back}\r\n              />\r\n\r\n              <br />\r\n              <font\r\n                style={{\r\n                  marginLeft: 5 + \"px\",\r\n                  color: isError ? \"red\" : \"black\",\r\n                }}\r\n              >\r\n                {msg}\r\n              </font>\r\n            </div>\r\n          )}\r\n          {postType === \"file\" && (\r\n            <div style={{ margin: 5 + \"px\" }}>\r\n              <FormFile\r\n                submitFunction={postFile}\r\n                backFunction={back}\r\n                setContentBody={setContentBody}\r\n                setContentHeader={setContentHeader}\r\n                setContentPlain={setContentPlain}\r\n                setFile={setFile}\r\n                contentPlain={contentPlain}\r\n                contentHeader={contentHeader}\r\n                contentBody={contentBody}\r\n              />\r\n              <font\r\n                style={{\r\n                  marginLeft: 5 + \"px\",\r\n                  color: isError ? \"red\" : \"black\",\r\n                }}\r\n              >\r\n                {msg}\r\n              </font>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport { addFields, addTypes } from \"../../config\";\r\nimport {\r\n  post_generic,\r\n  get_generic,\r\n  post_file_generic,\r\n} from \"../../services/http_operations\";\r\nimport {\r\n  isDefault,\r\n  removeDefaultElements,\r\n} from \"../../services/misc_functions\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\n\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nimport { Form, Nav } from \"react-bootstrap\";\r\nimport { FormManager } from \"../formManager/formManager\";\r\nimport { FormFile } from \"../formFileComp/formFile\";\r\n\r\nimport {\r\n  sortObject,\r\n  maintainEmptyElement,\r\n  maintainEmptyElements,\r\n} from \"../../services/objects_manipulation\";\r\n\r\nconst cloneDeep = require(\"clone-deep\");\r\n/*\r\nAPPUNTI FORM\r\n\r\n <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\r\n            <Form.Label>\r\n              TEXT\r\n            </Form.Label>\r\n            <Form.Control type=\"text\" placeholder=\"PLACEHOLDER TEXT\" />\r\n            <Form.Text className=\"text-muted\">\r\n              LABEL\r\n            </Form.Text>\r\n          </Form.Group>\r\n\r\ntipi consentiti nel form control:\r\ntext | number (verifica del numero automatica) | email (verifica email automatica) | file | checkbox\r\n\r\n*/\r\n\r\nexport default function AddExperimentPage(props) {\r\n  //get resource and id from url params\r\n  const resource = \"experiments\";\r\n  //get from attribute from search param\r\n\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n\r\n  //redirect hook\r\n  const navigate = useNavigate();\r\n  //type of input to post resources\r\n  const [postType, setPostType] = useState(\"form\");\r\n  //message for user\r\n  const [msg, setMsg] = useState(\"\");\r\n  const [isError, setIsError] = useState(false);\r\n  //values\r\n  const [values, setValues] = useState(cloneDeep(addFields[resource]));\r\n  //disabled\r\n  const [disabledFields, setDisabledFields] = useState({\r\n    metadata: { name: true },\r\n  });\r\n\r\n  //protocols\r\n  const [protocols, setProtocols] = useState();\r\n\r\n  //file upload state\r\n  const [file, setFile] = useState(undefined);\r\n  const [contentHeader, setContentHeader] = useState(null);\r\n  const [contentBody, setContentBody] = useState(null);\r\n  const [contentPlain, setContentPlain] = useState(null);\r\n\r\n  //useeffect to get resource if required\r\n  useEffect(() => {\r\n    const fetchData = async (qs = {}) => {\r\n      // get the protocols data from the api\r\n      const response = await get_generic(\"protocols\", qs);\r\n\r\n      setProtocols(response.docs.map((e) => e._id));\r\n    };\r\n    const qs = { limit: 100 };\r\n    fetchData(qs);\r\n  }, [props, searchParams]);\r\n\r\n  //useeffect to get resource if required\r\n  useEffect(() => {\r\n    const fetchDataDuplicate = async (qs = {}) => {\r\n      // get the data from the api\r\n      const response = await get_generic(resource, qs);\r\n\r\n      const data = response.docs[0];\r\n      let tmpValues = cloneDeep(values);\r\n\r\n      //add metadata and protocol fields\r\n      tmpValues[\"protocol\"] = \"\";\r\n      tmpValues[\"metadata\"] = [{ name: \"\", value: \"\" }];\r\n\r\n      //disable protocol fields\r\n      const tmpDisabled = cloneDeep(disabledFields);\r\n      tmpDisabled[\"protocol\"] = true;\r\n\r\n      setDisabledFields(tmpDisabled);\r\n\r\n      tmpValues = sortObject(data, tmpValues);\r\n\r\n      //add \"_copy\" to id to avoid duplicate key error\r\n\r\n      tmpValues[\"_id\"] = tmpValues[\"_id\"] + \"_copy\";\r\n\r\n      console.log(tmpValues);\r\n      tmpValues = maintainEmptyElements(tmpValues, addFields, resource);\r\n      setValues(tmpValues);\r\n    };\r\n\r\n    if (searchParams.get(\"from\") === null || searchParams.get(\"from\") === \"\")\r\n      return;\r\n    const fst = { _id: searchParams.get(\"from\") };\r\n    const qs = { filter: JSON.stringify(fst) };\r\n    fetchDataDuplicate(qs);\r\n  }, [searchParams, resource]);\r\n\r\n  //return if page shouldn't be rendered\r\n  if (addFields[resource] === undefined)\r\n    return <div>This entity cannot be posted</div>;\r\n\r\n  //handle changes\r\n  const handleChanges = (val, path) => {\r\n    let tmpVals = cloneDeep(values);\r\n    let valuesPtr = tmpVals;\r\n\r\n    let i;\r\n    let lastIndexNumber = -1;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      valuesPtr = valuesPtr[path[i]];\r\n      if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    }\r\n    if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    valuesPtr[path[i]] = val;\r\n    //check if an array is present\r\n    if (lastIndexNumber !== -1) {\r\n      //only string and numbers are allowed as item, with this version\r\n      const item = typeof val === \"number\" ? NaN : \"\";\r\n      tmpVals = maintainEmptyElement(\r\n        tmpVals,\r\n        path.slice(0, lastIndexNumber),\r\n        addFields,\r\n        resource,\r\n        item\r\n      );\r\n    }\r\n    setValues(tmpVals);\r\n  };\r\n\r\n  const handleDeleteItemArray = (path) => {\r\n    let val = cloneDeep(values);\r\n    let tmpPtr = val;\r\n\r\n    let i;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      if (path[i] === undefined) break;\r\n      tmpPtr = tmpPtr[path[i]];\r\n    }\r\n\r\n    const removed = tmpPtr.splice(path[i], 1);\r\n\r\n    const item = typeof removed[0] === \"number\" ? NaN : \"\";\r\n    val = maintainEmptyElement(\r\n      val,\r\n      path.slice(0, i),\r\n      addFields,\r\n      resource,\r\n      item\r\n    );\r\n    setValues(val);\r\n  };\r\n  //handle way selector to post new entity\r\n  const handleTypeSelect = (eventKey) => {\r\n    setPostType(eventKey);\r\n    setMsg(\"\");\r\n    setIsError(false);\r\n  };\r\n\r\n  //handle changes to selected protocols\r\n  const handleProtocolChange = async (e) => {\r\n    e.preventDefault();\r\n    const selectedProtocol = e.target.value;\r\n    const fst = { _id: e.target.value };\r\n    const qs = { filter: JSON.stringify(fst) };\r\n    const res = await get_generic(\"protocols\", qs);\r\n    const protocol = res.docs[0];\r\n\r\n    const metadata = [];\r\n    for (let i = 0; i < protocol.metadata.length; i++) {\r\n      if (protocol.metadata[i].type === \"scalar\") {\r\n        metadata.push({\r\n          name: protocol.metadata[i].name,\r\n          value: 0,\r\n        });\r\n      }\r\n      if (protocol.metadata[i].type === \"text\") {\r\n        metadata.push({\r\n          name: protocol.metadata[i].name,\r\n          value: protocol.metadata[i].name + \"_Name\",\r\n        });\r\n      }\r\n      if (protocol.metadata[i].type === \"vector\") {\r\n        metadata.push({\r\n          name: protocol.metadata[i].name,\r\n          value: [0],\r\n        });\r\n      }\r\n    }\r\n\r\n    const tmpValues = cloneDeep(values);\r\n    tmpValues[\"protocol\"] = selectedProtocol;\r\n    if (metadata.length !== 0) tmpValues[\"metadata\"] = metadata;\r\n\r\n    const tmpDisabled = cloneDeep(disabledFields);\r\n    tmpDisabled[\"protocol\"] = true;\r\n\r\n    setDisabledFields(tmpDisabled);\r\n    //setProtocol(selectedProtocol);\r\n    setValues(tmpValues);\r\n  };\r\n\r\n  //post the body for forms\r\n  const postBody = async (e) => {\r\n    e.preventDefault();\r\n    //deep clone values\r\n    let token = undefined;\r\n    let body = cloneDeep(values);\r\n    if (body.token !== undefined) {\r\n      token = body.token;\r\n      delete body.token;\r\n    }\r\n\r\n    let tmpValues = cloneDeep(body);\r\n    removeDefaultElements(tmpValues);\r\n    if (tmpValues[\"protocol\"] === undefined) {\r\n      setMsg(\"Please, select a protocol\");\r\n      setIsError(true);\r\n      return;\r\n    }\r\n    if (tmpValues[\"_id\"] === \"\") {\r\n      setMsg(\"Please, define an _id\");\r\n      setIsError(true);\r\n      return;\r\n    }\r\n    if (tmpValues[\"state\"] === \"\") {\r\n      setMsg(\"Please, select a state\");\r\n      setIsError(true);\r\n      return;\r\n    }\r\n\r\n    let res;\r\n    try {\r\n      const resp = await post_generic(\r\n        resource,\r\n        JSON.stringify(tmpValues),\r\n        token\r\n      );\r\n      res = resp.response;\r\n      setMsg(res.statusText);\r\n      setIsError(false);\r\n    } catch (error) {\r\n      console.log(error);\r\n      res = error.error.response;\r\n      console.log({\r\n        message: error.error.response.data.message,\r\n        details: error.error.response.data.details,\r\n      });\r\n\r\n      let det = \"\";\r\n      if (error.error.response.data.details.includes(\"duplicate key\")) {\r\n        det =\r\n          locale().duplicate_error +\r\n          \" \" +\r\n          error.error.response.data.details.slice(\r\n            error.error.response.data.details.indexOf(\"{\") + 1,\r\n            -1\r\n          );\r\n      }\r\n      //default case: show details from error message\r\n      else {\r\n        det = error.error.response.data.details;\r\n      }\r\n      //add details\r\n      setMsg(error.error.response.data.message + \" : \" + det);\r\n      setIsError(true);\r\n    }\r\n\r\n    if (res.status === 200) {\r\n      if (\r\n        window.confirm(\r\n          \"Experiment successufully posted! Back to resource page?\"\r\n        ) === true\r\n      ) {\r\n        navigate(\"/\" + resource);\r\n      } else {\r\n      }\r\n    }\r\n  };\r\n\r\n  const back = (e) => {\r\n    e.preventDefault();\r\n    navigate(-1);\r\n  };\r\n\r\n  const postFile = async (e) => {\r\n    e.preventDefault();\r\n    let res;\r\n    if (file === undefined) {\r\n      setMsg(locale().no_file);\r\n      setIsError(true);\r\n      return;\r\n    }\r\n    if (file.name.endsWith(\".csv\")) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      try {\r\n        const resp = await post_file_generic(resource, formData);\r\n\r\n        res = resp.response;\r\n        setMsg(res.statusText);\r\n        setIsError(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n\r\n        res = error.error.response;\r\n        //add details\r\n        setMsg(\r\n          error.error.response.data.message +\r\n            \" : \" +\r\n            error.error.response.data.details\r\n        );\r\n        setIsError(true);\r\n      }\r\n    }\r\n    if (file.name.endsWith(\".json\")) {\r\n      try {\r\n        const resp = await post_generic(resource, contentPlain, undefined);\r\n        res = resp.response;\r\n        setMsg(res.statusText);\r\n        setIsError(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n        res = error.error.response;\r\n        //add details\r\n        setMsg(\r\n          error.error.response.data.message +\r\n            \" : \" +\r\n            error.error.response.data.details\r\n        );\r\n        setIsError(true);\r\n      }\r\n    }\r\n\r\n    if (res.status === 200) {\r\n      if (\r\n        window.confirm(\r\n          \"Experiment successufully posted! Back to resource page?\"\r\n        ) === true\r\n      ) {\r\n        navigate(\"/\" + resource);\r\n      } else {\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">\r\n        Add resource &nbsp;\r\n        <b>{resource}</b>\r\n      </header>\r\n      <main className=\"page-content\">\r\n        <Nav\r\n          justify\r\n          variant=\"tabs\"\r\n          className=\"justify-content-center\"\r\n          onSelect={handleTypeSelect}\r\n          defaultActiveKey=\"form\"\r\n        >\r\n          {addTypes[resource].includes(\"form\") && (\r\n            <Nav.Item>\r\n              <Nav.Link eventKey=\"form\">Form</Nav.Link>\r\n            </Nav.Item>\r\n          )}\r\n\r\n          {addTypes[resource].includes(\"file\") &&\r\n            searchParams.get(\"from\") === null && (\r\n              <Nav.Item>\r\n                <Nav.Link eventKey=\"file\">File</Nav.Link>\r\n              </Nav.Item>\r\n            )}\r\n        </Nav>\r\n        <div\r\n          style={{\r\n            backgroundColor: \"#fff\",\r\n            borderRadius: 2 + \"px\",\r\n            borderStyle: \"solid\",\r\n            borderColor: \"rgba(18, 54, 81, 0.9)\",\r\n            borderWidth: 1 + \"px\",\r\n            width: 100 + \"%\",\r\n            height: \"fit-content\",\r\n          }}\r\n        >\r\n          {postType === \"form\" && protocols !== undefined && (\r\n            <div style={{ margin: 5 + \"px\" }}>\r\n              {(searchParams.get(\"from\") === null ||\r\n                searchParams.get(\"from\") === \"\") && (\r\n                <Form.Select\r\n                  aria-label={locale().select + \" protocol\"}\r\n                  onChange={handleProtocolChange}\r\n                >\r\n                  <option>{locale().select} protocol</option>\r\n                  {React.Children.toArray(\r\n                    protocols.map((e) => {\r\n                      return <option value={e}>{e}</option>;\r\n                    })\r\n                  )}\r\n                </Form.Select>\r\n              )}\r\n              <br />\r\n              <FormManager\r\n                values={values}\r\n                resource={resource}\r\n                functionalFields={addFields}\r\n                disabledFields={disabledFields}\r\n                handleChangesCallback={handleChanges}\r\n                arrayDeleteCallback={handleDeleteItemArray}\r\n                submitFunction={postBody}\r\n                backFunction={back}\r\n              />\r\n\r\n              <br />\r\n\r\n              <font\r\n                style={{\r\n                  marginLeft: 5 + \"px\",\r\n                  color: isError ? \"red\" : \"black\",\r\n                }}\r\n              >\r\n                {msg}\r\n              </font>\r\n            </div>\r\n          )}\r\n          {postType === \"file\" && (\r\n            <div style={{ margin: 5 + \"px\" }}>\r\n              <FormFile\r\n                submitFunction={postFile}\r\n                backFunction={back}\r\n                setContentBody={setContentBody}\r\n                setContentHeader={setContentHeader}\r\n                setContentPlain={setContentPlain}\r\n                setFile={setFile}\r\n                contentPlain={contentPlain}\r\n                contentHeader={contentHeader}\r\n                contentBody={contentBody}\r\n              />\r\n              <font\r\n                style={{\r\n                  marginLeft: 5 + \"px\",\r\n                  color: isError ? \"red\" : \"black\",\r\n                }}\r\n              >\r\n                {msg}\r\n              </font>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useContext } from \"react\";\r\nimport locale from \"../../common/locale\";\r\nimport { addFields, addTypes } from \"../../config\";\r\nimport {\r\n  post_generic,\r\n  get_generic,\r\n  post_file_generic,\r\n} from \"../../services/http_operations\";\r\nimport {\r\n  isDefault,\r\n  removeDefaultElements,\r\n} from \"../../services/misc_functions\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\n\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nimport {\r\n  Form,\r\n  Nav,\r\n  Container,\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Accordion,\r\n} from \"react-bootstrap\";\r\nimport { FormManager } from \"../formManager/formManager\";\r\nimport { FormFile } from \"../formFileComp/formFile\";\r\n\r\nimport AppContext from \"../../context\";\r\nimport { fetchedPageData } from \"../../config\";\r\nimport {\r\n  sortObject,\r\n  maintainEmptyElement,\r\n  maintainEmptyElements,\r\n} from \"../../services/objects_manipulation\";\r\n\r\nconst cloneDeep = require(\"clone-deep\");\r\n/*\r\nAPPUNTI FORM\r\n\r\n <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\r\n            <Form.Label>\r\n              TEXT\r\n            </Form.Label>\r\n            <Form.Control type=\"text\" placeholder=\"PLACEHOLDER TEXT\" />\r\n            <Form.Text className=\"text-muted\">\r\n              LABEL\r\n            </Form.Text>\r\n          </Form.Group>\r\n\r\ntipi consentiti nel form control:\r\ntext | number (verifica del numero automatica) | email (verifica email automatica) | file | checkbox\r\n\r\n*/\r\n\r\nexport default function AddMeasurementsPage(props) {\r\n  //get resource and id from url params\r\n  const resource = \"measurements\";\r\n  //get from attribute from search param\r\n\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const [samples, setSamples] = useState([]);\r\n  const [items, setItems] = useState([]);\r\n\r\n  //redirect hook\r\n  const navigate = useNavigate();\r\n  //type of input to post resources\r\n  const [postType, setPostType] = useState(\"form\");\r\n  //message for user\r\n  const [msg, setMsg] = useState(\"\");\r\n  const [isError, setIsError] = useState(false);\r\n  //formValues\r\n  const [formValues, setFormValues] = useState(cloneDeep(addFields[resource]));\r\n  //disabled\r\n  const [disabledFields, setDisabledFields] = useState({});\r\n\r\n  //protocols\r\n  const [features, setFeatures] = useState();\r\n  const [feature, setFeature] = useState(\"\");\r\n\r\n  //file upload state\r\n  const [file, setFile] = useState(undefined);\r\n  const [contentHeader, setContentHeader] = useState(null);\r\n  const [contentBody, setContentBody] = useState(null);\r\n  const [contentPlain, setContentPlain] = useState(null);\r\n\r\n  const context = useContext(AppContext);\r\n  const myFetched = context.fetched;\r\n\r\n  /////////////FETCH REQUIRED RESOURCES\r\n  const fetchData = async (res) => {\r\n    if (myFetched.data[res] !== undefined) return;\r\n    // get the data from the api\r\n    try {\r\n      const response = await get_generic(res, { limit: 100 });\r\n      myFetched.UpdateData(\r\n        response.docs.map((e) => e._id),\r\n        res\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (fetchedPageData[resource] !== undefined) {\r\n      Object.values(fetchedPageData[resource]).forEach((e) => fetchData(e));\r\n    }\r\n  }, []);\r\n\r\n  //useeffect to get resource if required\r\n  useEffect(() => {\r\n    const fetchData = async (qs = {}) => {\r\n      // get the protocols data from the api\r\n      try {\r\n        const response = await get_generic(\"features\", qs);\r\n\r\n        setFeatures(response.docs.map((e) => e._id));\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    const qs = { limit: 100 };\r\n    fetchData(qs);\r\n  }, [props, searchParams]);\r\n\r\n  //return if page shouldn't be rendered\r\n  if (addFields[resource] === undefined)\r\n    return <div>This entity cannot be posted</div>;\r\n\r\n  //handle changes\r\n  const handleChanges = (val, path) => {\r\n    let tmpVals = cloneDeep(formValues);\r\n    let formValuesPtr = tmpVals;\r\n\r\n    let i;\r\n    let lastIndexNumber = -1;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      formValuesPtr = formValuesPtr[path[i]];\r\n      if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    }\r\n    if (typeof path[i] === \"number\") lastIndexNumber = i;\r\n    formValuesPtr[path[i]] = val;\r\n    //check if an array is present\r\n    if (lastIndexNumber !== -1) {\r\n      //only string and numbers are allowed as item, with this version\r\n      const item = typeof val === \"number\" ? NaN : \"\";\r\n      tmpVals = maintainEmptyElement(\r\n        tmpVals,\r\n        path.slice(0, lastIndexNumber),\r\n        addFields,\r\n        resource,\r\n        item\r\n      );\r\n    }\r\n    setFormValues(tmpVals);\r\n  };\r\n\r\n  const handleDeleteItemArray = (path) => {\r\n    let val = cloneDeep(formValues);\r\n    let tmpPtr = val;\r\n\r\n    let i;\r\n    for (i = 0; i < path.length - 1; i++) {\r\n      if (path[i] === undefined) break;\r\n      tmpPtr = tmpPtr[path[i]];\r\n    }\r\n\r\n    const removed = tmpPtr.splice(path[i], 1);\r\n\r\n    const item = typeof removed[0] === \"number\" ? NaN : \"\";\r\n    val = maintainEmptyElement(\r\n      val,\r\n      path.slice(0, i),\r\n      addFields,\r\n      resource,\r\n      item\r\n    );\r\n    setFormValues(val);\r\n  };\r\n  //handle way selector to post new entity\r\n  const handleTypeSelect = (eventKey) => {\r\n    setPostType(eventKey);\r\n    setMsg(\"\");\r\n    setIsError(false);\r\n  };\r\n\r\n  //handle changes to selected feature\r\n  const handleFeatureChange = async (e) => {\r\n    e.preventDefault();\r\n    const selectedFeature = e.target.value;\r\n    const fst = { _id: selectedFeature };\r\n    const qs = { filter: JSON.stringify(fst) };\r\n    const res = await get_generic(\"features\", qs);\r\n    const feature = res.docs[0];\r\n\r\n    const items = feature.items;\r\n\r\n    const samples = [];\r\n    const tmp = addSample(samples, items);\r\n    setSamples(tmp);\r\n    setItems(items);\r\n    setFeature(selectedFeature);\r\n    return;\r\n  };\r\n\r\n  const addSample = (samples, items) => {\r\n    const values = [];\r\n    const tmpSample = cloneDeep(samples);\r\n    items.forEach((item) => {\r\n      if (item.type === \"number\") {\r\n        if (item.dimension === 0)\r\n          values.push({ name: item.name, value: NaN, type: item.type });\r\n        else values.push([{ name: item.name, value: NaN, type: item.type }]);\r\n      } else if (item.type === \"text\") {\r\n        if (item.dimension === 0)\r\n          values.push({ name: item.name, value: \"\", type: item.type });\r\n        else values.push([{ name: item.name, value: \"\", type: item.type }]);\r\n      } else if (item.type === \"enum\") {\r\n        if (item.dimension === 0)\r\n          values.push({\r\n            name: item.name,\r\n            value: \"\",\r\n            enumValues: item.range,\r\n            type: item.type,\r\n          });\r\n        else\r\n          values.push([\r\n            {\r\n              name: item.name,\r\n              value: \"\",\r\n              enumValues: item.range,\r\n              type: item.type,\r\n            },\r\n          ]);\r\n      }\r\n    });\r\n    tmpSample.push({ values: values });\r\n    return tmpSample;\r\n  };\r\n\r\n  //post the body for forms\r\n  const postBody = async (e) => {\r\n    e.preventDefault();\r\n    //deep clone formValues\r\n    let token = undefined;\r\n    let body = cloneDeep(formValues);\r\n    console.log(samples);\r\n    let tmpSamples = samples.map((sample) => {\r\n      return { values: sample.values.map((v) => v.value) };\r\n    });\r\n    if (body.token !== undefined) {\r\n      token = body.token;\r\n      delete body.token;\r\n    }\r\n    removeDefaultElements(body);\r\n    body[\"feature\"] = feature;\r\n    body[\"samples\"] = tmpSamples;\r\n    //let tmpformValues = cloneDeep(body);\r\n\r\n    let res;\r\n    try {\r\n      const resp = await post_generic(resource, JSON.stringify(body), token);\r\n      res = resp.response;\r\n      setMsg(res.statusText);\r\n      setIsError(false);\r\n    } catch (error) {\r\n      console.log(error);\r\n      res = error.error.response;\r\n      //add details\r\n      setMsg(\r\n        error.error.response.data.message +\r\n          \" : \" +\r\n          error.error.response.data.details\r\n      );\r\n      setIsError(true);\r\n    }\r\n\r\n    if (res.status === 200) {\r\n      if (window.confirm(\"Back to resource page?\") === true) {\r\n        if (resource === \"tenants\") navigate(\"/\");\r\n        else navigate(\"/\" + resource);\r\n      } else {\r\n      }\r\n    }\r\n  };\r\n\r\n  const back = (e) => {\r\n    e.preventDefault();\r\n    navigate(-1);\r\n  };\r\n\r\n  const postFile = async (e) => {\r\n    e.preventDefault();\r\n    if (file === undefined) {\r\n      setMsg(locale().no_file);\r\n      setIsError(true);\r\n      return;\r\n    }\r\n    let res;\r\n    if (file.name.endsWith(\".csv\")) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      try {\r\n        const resp = await post_file_generic(resource, formData);\r\n\r\n        res = resp.response;\r\n        setMsg(res.statusText);\r\n        setIsError(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n\r\n        res = error.error.response;\r\n        //add details\r\n        setMsg(\r\n          error.error.response.data.message +\r\n            \" : \" +\r\n            error.error.response.data.details\r\n        );\r\n        setIsError(true);\r\n      }\r\n    }\r\n    if (file.name.endsWith(\".json\")) {\r\n      try {\r\n        const resp = await post_generic(resource, contentPlain, undefined);\r\n        res = resp.response;\r\n        setMsg(res.statusText);\r\n        setIsError(false);\r\n      } catch (error) {\r\n        console.log(error);\r\n        res = error.error.response;\r\n        //add details\r\n        setMsg(\r\n          error.error.response.data.message +\r\n            \" : \" +\r\n            error.error.response.data.details\r\n        );\r\n        setIsError(true);\r\n      }\r\n    }\r\n\r\n    if (res.status === 200) {\r\n      if (window.confirm(\"Back to resource page?\") === true) {\r\n        navigate(\"/\" + resource);\r\n      } else {\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <header className=\"page-header\">\r\n        Add resource &nbsp;\r\n        <b>{resource}</b>\r\n      </header>\r\n      <main className=\"page-content\">\r\n        <Nav\r\n          justify\r\n          variant=\"tabs\"\r\n          className=\"justify-content-center\"\r\n          onSelect={handleTypeSelect}\r\n          defaultActiveKey=\"form\"\r\n        >\r\n          {addTypes[resource].includes(\"form\") && (\r\n            <Nav.Item>\r\n              <Nav.Link eventKey=\"form\">Form</Nav.Link>\r\n            </Nav.Item>\r\n          )}\r\n\r\n          {addTypes[resource].includes(\"file\") &&\r\n            searchParams.get(\"from\") === null && (\r\n              <Nav.Item>\r\n                <Nav.Link eventKey=\"file\">File</Nav.Link>\r\n              </Nav.Item>\r\n            )}\r\n        </Nav>\r\n        <div\r\n          style={{\r\n            backgroundColor: \"#fff\",\r\n            borderRadius: 2 + \"px\",\r\n            borderStyle: \"solid\",\r\n            borderColor: \"rgba(18, 54, 81, 0.9)\",\r\n            borderWidth: 1 + \"px\",\r\n            width: 100 + \"%\",\r\n            height: \"fit-content\",\r\n          }}\r\n        >\r\n          {postType === \"form\" && features !== undefined && (\r\n            <div style={{ margin: 5 + \"px\" }}>\r\n              <Form.Select\r\n                aria-label={locale().select + \" feature\"}\r\n                onChange={handleFeatureChange}\r\n                value={feature}\r\n              >\r\n                <option>{locale().select} feature</option>\r\n                {React.Children.toArray(\r\n                  features.map((e) => {\r\n                    return <option value={e}>{e}</option>;\r\n                  })\r\n                )}\r\n              </Form.Select>\r\n              <hr />\r\n              <Container fluid>\r\n                <Row>\r\n                  <b>Samples :{samples.length}</b>\r\n                </Row>\r\n                <br />\r\n                {React.Children.toArray(\r\n                  samples.map((sample, i) => {\r\n                    return (\r\n                      <Row\r\n                        style={{\r\n                          padding: 10,\r\n                        }}\r\n                      >\r\n                        <Accordion defaultActiveKey=\"0\">\r\n                          <Accordion.Item eventKey={i}>\r\n                            <Accordion.Header>\r\n                              <b>\r\n                                <i>Sample [{i}]</i>\r\n                              </b>\r\n                            </Accordion.Header>\r\n                            <Accordion.Body>\r\n                              {React.Children.toArray(\r\n                                Object.values(sample.values).map((entr) => {\r\n                                  return (\r\n                                    <Row\r\n                                      style={{\r\n                                        borderBottomStyle: \"solid\",\r\n                                        borderBottomWidth: 1 + \"px\",\r\n                                        marginBottom: 5 + \"px\",\r\n                                        padding: 10,\r\n                                      }}\r\n                                    >\r\n                                      <Col\r\n                                        sm={2}\r\n                                        style={{\r\n                                          borderRightStyle: \"dotted\",\r\n                                          borderRightWidth: 1 + \"px\",\r\n                                        }}\r\n                                      >\r\n                                        <b>\r\n                                          <i>{entr.name}</i>\r\n                                        </b>\r\n                                      </Col>\r\n                                      <Col sm={2}>\r\n                                        {entr.type === \"enum\" ? (\r\n                                          <Form.Select\r\n                                            aria-label={\r\n                                              locale().select + \" \" + entr.name\r\n                                            }\r\n                                            //value={entr.value}\r\n                                            onChange={(e) => {\r\n                                              e.preventDefault();\r\n                                              entr.value = e.target.value;\r\n                                            }}\r\n                                          >\r\n                                            <option value=\"\">\r\n                                              {locale().select +\r\n                                                \" \" +\r\n                                                entr.name}\r\n                                            </option>\r\n                                            {React.Children.toArray(\r\n                                              entr.enumValues.map((e) => {\r\n                                                return (\r\n                                                  <option value={e}>{e}</option>\r\n                                                );\r\n                                              })\r\n                                            )}\r\n                                          </Form.Select>\r\n                                        ) : entr.type === \"text\" ? (\r\n                                          <Form.Control\r\n                                            type=\"text\"\r\n                                            //value={entr.value}\r\n                                            id={entr.name}\r\n                                            onChange={(e) => {\r\n                                              e.preventDefault();\r\n                                              entr.value = e.target.value;\r\n                                            }}\r\n                                            aria-label={\r\n                                              locale().enter + \" \" + entr.name\r\n                                            }\r\n                                          />\r\n                                        ) : (\r\n                                          <Form.Control\r\n                                            type=\"number\"\r\n                                            id={entr.name}\r\n                                            //value={isNaN(entr.value) ? \"\" : entr.value}\r\n                                            onChange={(e) => {\r\n                                              e.preventDefault();\r\n                                              entr.value = parseInt(\r\n                                                e.target.value,\r\n                                                10\r\n                                              );\r\n                                            }}\r\n                                            aria-label={\r\n                                              locale().enter + \" \" + entr.name\r\n                                            }\r\n                                          />\r\n                                        )}\r\n                                      </Col>\r\n                                    </Row>\r\n                                  );\r\n                                })\r\n                              )}\r\n                            </Accordion.Body>\r\n                          </Accordion.Item>\r\n                        </Accordion>\r\n                      </Row>\r\n                    );\r\n                  })\r\n                )}\r\n                {samples.length !== 0 && (\r\n                  <Button\r\n                    variant=\"link\"\r\n                    onClick={() => {\r\n                      const sampl = addSample(samples, items);\r\n                      setSamples(sampl);\r\n                    }}\r\n                  >\r\n                    <i\r\n                      className=\"fa fa-plus-circle\"\r\n                      aria-hidden=\"true\"\r\n                      title={\"Add sample\"}\r\n                      style={{\r\n                        width: 30 + \"px\",\r\n                        height: 30 + \"px\",\r\n                        marginRight: 10 + \"px\",\r\n                        opacity: 0.85,\r\n                      }}\r\n                    ></i>\r\n                  </Button>\r\n                )}\r\n              </Container>\r\n              <hr />\r\n              <br />\r\n              <FormManager\r\n                values={formValues}\r\n                resource={resource}\r\n                functionalFields={addFields}\r\n                disabledFields={disabledFields}\r\n                handleChangesCallback={handleChanges}\r\n                arrayDeleteCallback={handleDeleteItemArray}\r\n                submitFunction={postBody}\r\n                backFunction={back}\r\n              />\r\n\r\n              <br />\r\n\r\n              <font\r\n                style={{\r\n                  marginLeft: 5 + \"px\",\r\n                  color: isError ? \"red\" : \"black\",\r\n                }}\r\n              >\r\n                {msg}\r\n              </font>\r\n            </div>\r\n          )}\r\n          {postType === \"file\" && (\r\n            <div style={{ margin: 5 + \"px\" }}>\r\n              <FormFile\r\n                submitFunction={postFile}\r\n                backFunction={back}\r\n                setContentBody={setContentBody}\r\n                setContentHeader={setContentHeader}\r\n                setContentPlain={setContentPlain}\r\n                setFile={setFile}\r\n                contentPlain={contentPlain}\r\n                contentHeader={contentHeader}\r\n                contentBody={contentBody}\r\n              />\r\n              <font\r\n                style={{\r\n                  marginLeft: 5 + \"px\",\r\n                  color: isError ? \"red\" : \"black\",\r\n                }}\r\n              >\r\n                {msg}\r\n              </font>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  HashRouter as Router,\r\n  Route,\r\n  NavLink,\r\n  Routes,\r\n  Navigate,\r\n} from \"react-router-dom\";\r\nimport { AuthPage } from \"./components/authPage/authPage.comp\";\r\nimport { HomePage } from \"./components/homePage/homePage\";\r\nimport { NotFoundPage } from \"./components/notFoundPage/notFoundPage\";\r\nimport Navigation from \"./components/navigation/navigation.comp\";\r\nimport Page from \"./components/page/page\";\r\nimport ProfilePage from \"./components/profilePage/profilePage\";\r\nimport \"./App.scss\";\r\nimport UnauthorizedPage from \"./components/unauthorizedPage/unauthorizedPage\";\r\n\r\nimport { Container, Row, Col } from \"react-bootstrap\";\r\n\r\nimport NotificationBar from \"./components/notificationBar/notificationBar\";\r\nimport HorizontalNavigationBar from \"./components/horizontalNavigationBar/horizontalNavigationBar\";\r\nimport AppContext from \"./context\";\r\n\r\nimport { notificationManager, get_generic } from \"./services/http_operations\";\r\nimport MobilePlaceholderPage from \"./components/mobilePlaceholderPage/mobilePlaceholderPage\";\r\nimport EditContentPage from \"./components/editContentPage/editContentPage\";\r\nimport AddPage from \"./components/addPage/addPage\";\r\nimport AddExperimentPage from \"./components/addExperimentPage/addExperimentPage\";\r\nimport { layout } from \"./config\";\r\nimport AddMeasurementsPage from \"./components/addMeasurementsPage/addMeasurementsPage\";\r\nimport cloneDeep from \"clone-deep\";\r\n/*\r\n    notifications follow this schema\r\n\r\n    {\r\n        name: \"notification name\"\r\n        time: \"\"\r\n        message: \"this is a message\"\r\n    }\r\n\r\n\r\n*/\r\n\r\ninterface INotification {\r\n  type: string;\r\n  time: string;\r\n  msg: string;\r\n}\r\n\r\nfunction App() {\r\n  const [notifications, setNotifications] = useState<INotification[]>([]);\r\n  const [types, setTypes] = useState<Object | undefined>();\r\n  const [data, setData] = useState<Object>({});\r\n\r\n  let layoutRef = React.useRef<string | null>();\r\n  const tkn = localStorage.getItem(\"token\");\r\n\r\n  ////////////////NOTIFICATION MANAGEMENT FRAGMENT\r\n  //function to push a new notification at the beginning of the list\r\n  function PushNotification(obj: INotification) {\r\n    setNotifications((prev) => [obj].concat(prev));\r\n    //notifications.push(obj);\r\n  }\r\n\r\n  //function to remove a single notification from list\r\n  function RemoveNotification(id: number) {\r\n    let tmp = [...notifications];\r\n    tmp.splice(id, 1);\r\n    setNotifications(tmp);\r\n  }\r\n\r\n  //function to clear notifications list\r\n  function ClearNotifications() {\r\n    setNotifications([]);\r\n  }\r\n\r\n  const notificationManagement = {\r\n    notifications: notifications,\r\n    PushNotification,\r\n    RemoveNotification,\r\n    ClearNotifications,\r\n  };\r\n\r\n  notificationManager.ClearNotifications = ClearNotifications;\r\n  notificationManager.PushNotification = PushNotification;\r\n  notificationManager.RemoveNotification = RemoveNotification;\r\n\r\n  ///////////////END NOTIFICATION MANAGEMENT FRAGMENT\r\n\r\n  ///////////////FETCHED TYPES AND DATA MANAGEMENT FRAGMENT\r\n  //function to push a new notification at the beginning of the list\r\n  function UpdateData(fetched: string[], key: string) {\r\n    setData((prev) => {\r\n      return { ...prev, [key]: [...fetched] };\r\n    });\r\n  }\r\n\r\n  //use effect to fetch static data from the server /types\r\n  useEffect(() => {\r\n    // declare the async data fetching function\r\n    const fetchTypes = async () => {\r\n      // get the data from the api\r\n      try {\r\n        const response = await get_generic(\"types\", {}, \"\");\r\n\r\n        setTypes(response.response.data);\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n\r\n    //if types has been already set, ignore it\r\n    if (types !== undefined) return;\r\n    // call the function\r\n    try {\r\n      fetchTypes();\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n    // make sure to catch any error\r\n  }, []);\r\n\r\n  const fetchedManagement = {\r\n    types: types,\r\n    data: data,\r\n    UpdateData: UpdateData,\r\n  };\r\n  ///////////////END FETCHED TYPES MANAGEMENT FRAGMENT\r\n\r\n  //mobile view only allowed to be vertical\r\n  if (/Mobi/i.test(window.navigator.userAgent) == true) {\r\n    layoutRef.current = \"vertical\";\r\n  } else {\r\n    layoutRef.current = layout;\r\n  }\r\n\r\n  //not logged => show auth page\r\n  if (tkn === null)\r\n    return (\r\n      <div className=\"app\">\r\n        <Router>\r\n          <Routes>\r\n            <Route path=\"/\" element={<AuthPage />} />\r\n            <Route\r\n              path=\"/add/tenants\"\r\n              element={<AddPage resource={\"tenants\"} />}\r\n            />\r\n          </Routes>\r\n        </Router>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <AppContext.Provider\r\n      value={{\r\n        notifications: notificationManagement,\r\n        fetched: fetchedManagement,\r\n      }}\r\n    >\r\n      <Router>\r\n        <Container\r\n          fluid\r\n          style={{\r\n            paddingLeft: 0,\r\n            paddingRight: 0,\r\n            height: 100 + \"vh\",\r\n            width: 99 + \"vw\",\r\n          }}\r\n        >\r\n          {layoutRef.current === \"horizontal\" ? (\r\n            <Row style={{ padding: 0 }}>\r\n              <HorizontalNavigationBar />\r\n            </Row>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n          <Row\r\n            style={{\r\n              padding: 0,\r\n            }}\r\n          >\r\n            {layoutRef.current === \"vertical\" ? (\r\n              <Col md=\"auto\" style={{ padding: 0, minWidth: 250 + \"px\" }}>\r\n                <Navigation />\r\n              </Col>\r\n            ) : (\r\n              \"\"\r\n            )}\r\n            {/Mobi/i.test(window.navigator.userAgent) == true && (\r\n              <Col md=\"auto\" style={{ padding: 0 }}>\r\n                <NotificationBar />\r\n              </Col>\r\n            )}\r\n            <Col style={{ paddingLeft: 0, paddingRight: 0 }}>\r\n              <Routes>\r\n                <Route path=\"/\" element={<HomePage />} />\r\n                <Route path=\"/home\" element={<HomePage />} />\r\n                <Route path=\"/viewProfile\" element={<ProfilePage />} />\r\n                <Route\r\n                  path=\"/add/experiments/\"\r\n                  element={<AddExperimentPage />}\r\n                />\r\n                <Route\r\n                  path=\"/add/measurements/\"\r\n                  element={<AddMeasurementsPage />}\r\n                />\r\n\r\n                <Route\r\n                  path=\"/edit/:resource/:id\"\r\n                  element={<EditContentPage />}\r\n                />\r\n                <Route path=\"/add/:resource/\" element={<AddPage />} />\r\n                <Route path=\"/:page\" element={<Page res=\":page\" />} />\r\n\r\n                <Route path=\"/unauthorized\" element={<UnauthorizedPage />} />\r\n                <Route path=\"/404\" element={<NotFoundPage />} />\r\n\r\n                <Route path=\"*\" element={<Navigate to=\"/404\" replace />} />\r\n              </Routes>\r\n            </Col>\r\n            {layoutRef.current === \"vertical\" &&\r\n              /Mobi/i.test(window.navigator.userAgent) == false && (\r\n                <Col md=\"auto\" style={{ paddingLeft: 0, paddingRight: 0 }}>\r\n                  <NotificationBar />\r\n                </Col>\r\n              )}\r\n          </Row>\r\n        </Container>\r\n      </Router>\r\n    </AppContext.Provider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}
(this["webpackJsonpmeasurify-admin-dashboard"]=this["webpackJsonpmeasurify-admin-dashboard"]||[]).push([[0],{163:function(e,t,a){},164:function(e,t,a){},250:function(e,t,a){},276:function(e,t){},278:function(e,t){},293:function(e,t,a){},297:function(e,t,a){},298:function(e,t,a){},299:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){},371:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(41),i=a.n(s),c=(a(250),a(3)),o=a(5),l=a(6),d=a(16),u=a(21),j=a(4),b=a(25),p=a(15),h=a(409),f={username:"Nome utente",password:"Password",tenant:"Organizzazione",email:"email",keep_logged:"Mantieni Accesso",select:"Seleziona",language:"Lingua",welcome:"Bentornato",role:"Ruolo",session_expire_in:"La sessione scadr\xe0 in ",resources:"Risorse",tools:"Strumenti",notifications:"Notifiche",file_content:"Contenuto del file",preview:"Anteprima",configuration:"Configurazione",clear_all:"Cancella tutto",no_changes_found:"Nessun cambiamento trovato",resource_successfully_edited:"Resoursa modificata con successo!",resource_successfully_posted:"Resource successufully posted!",enter:"Inserisci",username_suggestion:"Inserisci il nome utente",password_suggestion:"Inserisci la password",tenant_suggestion:"Inserisci la tua organizzazione",email_suggestion:"Inserisci la tua email",add_tenant:"Aggiungi organizzazione",welcome_hp:"Benvenuto nel pannello di controllo di Measurify!",left_bar_descr_hp:"Nella barra a sinistra sono presenti le informazioni relative al tuo account e i collegamenti alle pagine.",right_bar_descr_hp:'La barra a destra pu\xf2 essere aperta cliccando sul pulsante "Notifiche" per mostrare la lista delle notifiche.',session_expire_info_hp:"",github_page_hp:"Pagina Github di Measurify",github_issue_page_hp:"Segnala bug o problemi",geo_update:"Posizione aggiornata",geo_failed:"Non \xe8 stato possibile aggiornare la posizione",profile_page_desc:"questa \xe8 la pagina in cui puoi visionare il tuo profilo o modificare la password",pass_change_confirm:"La password verr\xe0 modificata, procedere?",email_change_confirm:"L'indirizzo email verr\xe0 modificato, procedere?",password_changed:"Password cambiata con successo",email_changed:"Email cambiata con successo",password_rules:"La password deve contenere almeno 6 caratteri, almeno una lettera maiuscola e un numero.",oh_no:"Oh No!",broken_link:"Sembra che tu abbia utilizzato un collegamento non funzionante.",submit:"Invio",cancel:"Annulla",login:"Accedi",logout:"Esci",repeat:"Ripeti",close:"Chiudi",import:"Importa",export:"Esporta",password_recovery:"Recupero Password",password_reset:"Reset Password",forgot_password_link:"Hai dimenticato la tua password?",go_login_page:"Torna alla pagina di login",email_sent_successfully:"Email inviata, segui le istruzioni contenute per cambiare la tua password",login_error:"Login errata!",unauthorised_user:"Non sei abilitato a utilizzare questa pagina",session_expired:"Sessione scaduta",no_file:"Si prega di selezionare un file",duplicate_resource_error:"Nel database \xe8 gi\xe0 presente una risorsa con",error_imported_file:"Nel file sono presenti errori, non \xe8 stato possibile importarlo",pass_not_match:"La password inserita e la conferma non combaciano, si prega di reinserirle.",old_pass_empty:"Per favore, inserire la vecchia password",old_pass_wrong:"La vecchia password \xe8 sbagliata",pass_not_null:"La password non pu\xf2 essere vuota",missing_tenant:"Si prega di inserire l'organizzazione",missing_email:"Si prega di inserire l'email",missing_token:"Si prega di inserire il token",missing_password:"Si prega di inserire la propria password",missing_username:"Si prega di inserire il proprio username",stronger_password_required:"Si prega di inserire una password pi\xf9 robusta",email_sent_errors:"Non \xe8 stato possibile inviare la mail, controllare i dati inseriti.",password_not_changed_errors:"Non \xe8 stato possibile cambiare la password.",network_error:"Errore di rete, si prega di controllare la connessione.",empty_email_error:"Il campo email \xe8 vuoto, si prega di inserire un indirizzo email valido.",email_not_match:"L'indirizzo email inserito e la sua conferma non combaciano, si prega di reinserirle.",email_same_as_old:"La nuova email coincide con quella vecchia, si prega di inserire un indirizzo email diverso dal precedente.",generic_file_post_error:"Il file selezionato non pu\xf2 essere caricato perch\xe9 contiene errori."},O={username:"Username",password:"Password",tenant:"Tenant",email:"Email",keep_logged:"Keep Logged In",select:"Select",language:"Language",welcome:"Welcome back",role:"Role",session_expire_in:"Session will expire in ",resources:"Resources",tools:"Tools",notifications:"Notifications",file_content:"File content",preview:"Preview",configuration:"Configuration",clear_all:"Clear all",no_changes_found:"No changes found",resource_successfully_edited:"Resource successfully edited!",resource_successfully_posted:"Resource successufully posted!",enter:"Enter",username_suggestion:"Insert your username",password_suggestion:"Insert your password",tenant_suggestion:"Insert your tenant",email_suggestion:"Insert your email",add_tenant:"Add tenant",welcome_hp:"Welcome to the Administration dashboard!",left_bar_descr_hp:"The left bar contains the information about your account and  the list of tabs",right_bar_descr_hp:'The right bar contains the notification bar (Click on "Notifications" to open).',session_expire_info_hp:"",github_page_hp:"",github_issue_page_hp:"Report bugs or issues",profile_page_desc:"from this page you can view your own profile or change the password",pass_change_confirm:"Password will be changed, do you confirm?",email_change_confirm:"Email address will be changed, do you confirm?",password_changed:"Password changed successfully",email_changed:"Email changed successfully",password_rules:"Password length should be at least 6 characters, contains at least one uppercase character and one number.",forgot_password_link:"Have you forgot your password?",go_login_page:"Go to login page",oh_no:"Oh No!",broken_link:"It looks like you have clicked on a broken link.",submit:"Submit",cancel:"Cancel",login:"Login",logout:"Logout",repeat:"Repeat",close:"Close",import:"Import",export:"Export",password_recovery:"Password Recovery",password_reset:"Reset Password",email_sent_successfully:"Email sent, please follow the provided instruction to reset the password",login_error:"Wrong login!",unauthorised_user:"You are not allowed to use this page",session_expired:"Session expired",no_file:"Please, select a file",duplicate_resource_error:"The database already contains a resource with",error_imported_file:"File contains errors. It was not possible to import it",pass_not_match:"Provided password and the confirmation do not match. Please insert them again",old_pass_empty:"Please, enter old password",old_pass_wrong:"The old password is wrong",pass_not_null:"Password cannot be empty",missing_tenant:"Please, insert your tenant",missing_email:"Please, insert your email",missing_token:"Please, insert your token",missing_password:"Please, insert your password",missing_username:"Please, insert your username",stronger_password_required:"Please, insert stronger password",email_sent_errors:"It was not possible to send the mail, please check the provided info.",password_not_changed_errors:"It was not possible to change the password.",network_error:"Network error, please check internet connection",empty_email_error:"Email field is empty, please insert a valid email address.",email_not_match:"Provided email and the confirmation do not match. Please insert them again.",email_same_as_old:"The new email is the same as the old email. Please insert a different email address.",generic_file_post_error:"The selected file cannot be uploaded because it contains errors."},m=a(251).default,v=a(269),x=m.create({httpsAgent:new v.Agent({})}),g={PushNotification:function(e){},RemoveNotification:function(e){},ClearNotifications:function(){}};function y(e,t,a){var n={username:"".concat(e),password:"".concat(t),tenant:"".concat(a)},r={headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}},s=M+"/login";return new Promise((function(e,t){x.post(s,n,r).then((function(t){localStorage.setItem("token",t.data.token),localStorage.setItem("token-expiration-time",t.data.token_expiration_time),localStorage.setItem("username",t.data.user.username),localStorage.setItem("user-role",t.data.user.type),localStorage.setItem("user-email",t.data.user.email),localStorage.setItem("user-tenant",a),localStorage.setItem("login-time",(new Date).getTime().toString()),e(t)})).catch((function(e){t(e)}))}))}function w(e,t){return _.apply(this,arguments)}function _(){return _=Object(d.a)(Object(l.a)().mark((function e(t,a){var n,r,s,i,c,o=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},void 0===(r=o.length>3&&void 0!==o[3]?o[3]:void 0)&&(r=T()),s=M+"/"+t+"/file",console.log("POST file:"+s),i={"Content-Type":"multipart/form-data","Cache-Control":"no-cache",Authorization:r},Object.entries(n).forEach((function(e){var t=Object(j.a)(e,2),a=t[0],n=t[1];i[a]=n})),c={headers:i},e.abrupt("return",new Promise((function(e,n){x.post(s,a,c).then((function(a){g.PushNotification({name:"info",time:(new Date).toTimeString(),msg:"Successful POST of file on: "+t}),e({response:a})})).catch((function(e){g.PushNotification({name:"error",time:(new Date).toTimeString(),msg:"Error doing a POST of file on: "+t}),n({error:e})}))})));case 9:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return C=Object(d.a)(Object(l.a)().mark((function e(t,a){var n,r,s,i=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===(n=i.length>2&&void 0!==i[2]?i[2]:void 0)&&(n=T()),r=M+"/"+t+"/",console.log("POST :"+r),s={headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Authorization:n}},e.abrupt("return",new Promise((function(e,n){x.post(r,a,s).then((function(a){g.PushNotification({name:"info",time:(new Date).toTimeString(),msg:"Successful POST of a resource type: "+t}),e({response:a})})).catch((function(e){g.PushNotification({name:"error",time:(new Date).toTimeString(),msg:"Error doing a POST of a resource type: "+t}),n({error:e})}))})));case 6:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function S(e,t,a){return N.apply(this,arguments)}function N(){return N=Object(d.a)(Object(l.a)().mark((function e(t,a,n){var r,s,i,c=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>3&&void 0!==c[3]?c[3]:void 0,s=M+"/"+t+"/"+n,void 0===r&&(r=T()),console.log("PUT :"+s),i={headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Authorization:r}},e.abrupt("return",new Promise((function(e,r){x.put(s,a,i).then((function(r){void 0!==a.password&&(a.password="".padStart(a.password.length,"*")),g.PushNotification({name:"info",time:(new Date).toTimeString(),msg:"Successful PUT of a resource type: "+t+", id: "+n+", body: "+JSON.stringify(a)}),e({response:r})})).catch((function(e){void 0!==a.password&&(a.password="".padStart(a.password.length,"*")),g.PushNotification({name:"error",time:(new Date).toTimeString(),msg:"Error doing a PUT on resource type: "+t+", id: "+n+", body: "+JSON.stringify(a)+". "+e.message}),r({error:e})}))})));case 6:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}function A(e,t){return I.apply(this,arguments)}function I(){return I=Object(d.a)(Object(l.a)().mark((function e(t,a){var n,r,s,i=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:void 0,r=M+"/"+t,void 0===n&&(n=T()),void 0!==a&&(r+="/"+a),console.log("DELETE :"+r),s={headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Authorization:n}},e.abrupt("return",new Promise((function(e,n){x.delete(r,s).then((function(n){void 0!==a?g.PushNotification({name:"info",time:(new Date).toTimeString(),msg:"Deleted resource: "+a+", of type: "+t}):g.PushNotification({name:"info",time:(new Date).toTimeString(),msg:"Deleted resources of type: "+t}),e({response:n})})).catch((function(e){g.PushNotification({name:"error",time:(new Date).toTimeString(),msg:"error deleting resource: "+a+", of type: "+t+". "+e.message}),404===e.statusCode&&g.PushNotification({name:"error",time:(new Date).toTimeString(),msg:"Please check if your user is authorized to delete the resource. "+e.message}),n({error:e})}))})));case 7:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function P(e){return z.apply(this,arguments)}function z(){return z=Object(d.a)(Object(l.a)().mark((function e(t){var a,n,r,s,i=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:{},n=i.length>2?i[2]:void 0,r=M+"/"+t+"/",void 0===n&&(n=T()),r=void 0!==a.filter?r.concat("?filter="+a.filter):r.concat("?filter="),void 0!==a.limit&&(r=r.concat("&limit="+a.limit)),void 0!==a.page&&(r=r.concat("&page="+a.page)),void 0!==a.sort&&""!==a.sort.by&&(r=r.concat('&sort={"'+a.sort.by+'":'+("ascending"===a.sort.order?'"asc"':'"desc"')+"}")),console.log("GET :"+r),s={headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Authorization:n},json:!0},e.abrupt("return",new Promise((function(e,t){x.get(r,s).then((function(t){e({response:t,docs:t.data.docs,totalDocs:t.data.totalDocs,limit:t.data.limit,totalPages:t.data.totalPages,page:t.data.page,pagingCounter:t.data.pagingCounter,hasPrevPage:t.data.hasPrevPage,hasNextPage:t.data.hasNextPage,prevPage:t.data.prevPage,nextPage:t.data.nextPage})})).catch((function(e){t({error:e})}))})));case 11:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}function D(e){return R.apply(this,arguments)}function R(){return R=Object(d.a)(Object(l.a)().mark((function e(t){var a,n,r,s,i=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:{},n=i.length>2?i[2]:void 0,r=M+"/"+t+"/pipe/",void 0===n&&(n=T()),r=void 0!==a.filter?r.concat("?filter="+a.filter):r.concat("?filter="),void 0!==a.limit&&(r=r.concat("&limit="+a.limit)),void 0!==a.page&&(r=r.concat("&page="+a.page)),console.log("GET PIPE:"+r),s={headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Authorization:n},json:!0},e.abrupt("return",new Promise((function(e,t){x.get(r,s).then((function(t){e(t)})).catch((function(e){console.log(e),t({error:e})}))})));case 10:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function T(){return localStorage.getItem("token")}function F(e,t){var a={headers:{"Content-Type":"application/json"}},n="https://api.bigdatacloud.net/data/reverse-geocode-client?latitude="+e+"&longitude="+t+"&localityLanguage=it";return console.log("GET location: "+n),new Promise((function(e,t){x.get(n,a).then((function(t){localStorage.setItem("continent",t.data.continent),localStorage.setItem("continentCode",t.data.continentCode),localStorage.setItem("countryName",t.data.countryName),localStorage.setItem("countryCode",t.data.countryCode),localStorage.setItem("principalSubdivision",t.data.principalSubdivision),localStorage.setItem("city",t.data.city),localStorage.setItem("locality",t.data.locality),e(t)})).catch((function(e){t(e)}))}))}function E(e,t){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(Object(l.a)().mark((function e(t,a){var n,r,s;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log({email:a,tenant:t}),n=M+"/self/reset?tenant="+t,r=JSON.stringify({email:a}),console.log("POST password reset request:"+n),s={headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}},e.abrupt("return",new Promise((function(e,t){x.post(n,r,s).then((function(t){e({response:t})})).catch((function(e){t({error:e})}))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t,a){return G.apply(this,arguments)}function G(){return(G=Object(d.a)(Object(l.a)().mark((function e(t,a,n){var r,s,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=M+"/self",console.log("PUT password reset:"+r),s=JSON.stringify({reset:a,password:n,tenant:t}),i={headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}},e.abrupt("return",new Promise((function(e,t){x.put(r,s,i).then((function(t){e({response:t})})).catch((function(e){t({error:e})}))})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return H.apply(this,arguments)}function H(){return(H=Object(d.a)(Object(l.a)().mark((function e(){var t,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=M+"/types/passwordStrength",console.log("GET password strength:"+t),a={headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}},e.abrupt("return",new Promise((function(e,n){x.get(t,a).then((function(t){e({response:t})})).catch((function(e){n({error:e})}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M="https://think.measurify.org/v1",U="Pensaci Prima",J=["it"],K={measurements:["samples","actions"]},q={},V={measurements:["view","delete"]},Y={measurements:["samples"]},Q={measurements:{tags:[""]}},X={tenants:{token:"",_id:"",organization:"",address:"",email:"",phone:"",admin_username:"",admin_password:"",passwordhash:""},measurements:{thing:"",device:"",tags:[""]}},Z={},$={measurements:["form"]},ee={measurements:{visibility:"VisibilityTypes"}},te={};function ae(){var e=localStorage.getItem("language");return 0===J.length?O:(1===J.length&&(e=J[0]),"it"===e?f:"en"===e?O:"it"===navigator.language.substring(0,2)?f:(navigator.language.substring(0,2),O))}te.measurements={device:"devices",thing:"things",tags:"tags"};a(163),a(293);var ne=a(1),re=function(){function e(e){localStorage.setItem("language",e),window.location.reload()}return Object(ne.jsxs)("div",{children:[ae().language,Object(ne.jsxs)("div",{children:[J.includes("it")&&Object(ne.jsx)(h.a,{variant:"outline-info",onClick:function(){return e("it")},children:"Ita"}),J.includes("en")&&Object(ne.jsx)(h.a,{variant:"outline-info",onClick:function(){return e("en")},children:"Eng"})]})]})},se=a(424),ie=r.a.createRef(),ce=r.a.createRef(),oe="think-before-tenant",le=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),a=t[0],r=t[1];function s(){return(s=Object(d.a)(Object(l.a)().mark((function e(t){var a,n,s;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=ie.current.value,n=ce.current.value,s=oe,e.prev=4,e.next=7,y(a,n,s);case 7:window.location.replace("/"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log({error:e.t0.response.data}),r(e.t0.response.data.message+" : "+e.t0.response.data.details);case 14:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}return Object(ne.jsxs)("div",{className:"auth-page",children:[Object(ne.jsx)("div",{className:"title-wrapper",children:Object(ne.jsx)("div",{className:"title-section",children:"Pensaci Prima"})}),J.length>1&&Object(ne.jsx)("div",{className:"language-wrapper",children:Object(ne.jsx)(re,{})}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsxs)(se.a,{onSubmit:function(e){return s.apply(this,arguments)},className:"rounded p-4 p-sm-3",children:[Object(ne.jsx)("h4",{children:ae().login}),Object(ne.jsxs)(se.a.Group,{className:"mb-3",controlId:"username",children:[Object(ne.jsx)(se.a.Label,{children:ae().username}),Object(ne.jsx)(se.a.Control,{ref:ie,type:"text",placeholder:ae().username_suggestion})]}),Object(ne.jsxs)(se.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(ne.jsx)(se.a.Label,{children:ae().password}),Object(ne.jsx)(se.a.Control,{type:"password",ref:ce,placeholder:ae().password_suggestion})]}),Object(ne.jsx)(h.a,{variant:"primary",type:"submit",children:ae().submit})]}),Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{style:{color:"red"},children:a}),Object(ne.jsx)("div",{className:"form-row row",children:Object(ne.jsx)(b.b,{to:"/passwordrecovery",children:ae().forgot_password_link})})]})},de=(a(297),function(){return Object(n.useEffect)((function(){})),Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsx)("header",{className:"page-header",children:U}),Object(ne.jsx)("main",{className:"page-content",children:Object(ne.jsx)("div",{className:"home-page",children:Object(ne.jsx)("div",{className:"info-box",children:Object(ne.jsxs)("div",{className:"info-text",children:[ae().welcome_hp,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),ae().left_bar_descr_hp,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),ae().right_bar_descr_hp,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),ae().session_expire_info_hp,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsx)("a",{href:"https://github.com/measurify/server/issues",target:"_blank",rel:"noopener noreferrer",title:"https://github.com/measurify/server/issues",children:ae().github_issue_page_hp}),Object(ne.jsx)("br",{})]})})})})]})}),ue=(a(298),function(){return Object(ne.jsxs)("div",{className:"notFound-page",children:[ae().oh_no,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),ae().broken_link,Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsx)("a",{href:"https://github.com/measurify/server/issues",target:"_blank",rel:"noopener noreferrer",title:"https://github.com/measurify/server/issues",children:ae().github_issue_page_hp})]})}),je=(a(299),a(45)),be=a(26);je.a.library.add(be.k,be.a,be.p,be.n,be.m,be.o,be.l,be.b);var pe=r.a.createRef(),he=r.a.createRef(),fe=r.a.createRef(),Oe=r.a.createRef(),me=r.a.createRef(),ve=r.a.createRef(),xe=r.a.createRef();function ge(){var e=Object(n.useState)(!1),t=Object(j.a)(e,2),a=t[0],s=t[1],i=localStorage.getItem("username"),c=localStorage.getItem("user-role"),o=localStorage.getItem("user-tenant");return ve.current=null!==i?i:"",me.current=null!==c?c:"",xe.current=null!==o&&""!==o?o:"-",Object(n.useEffect)((function(){function e(){var t,a;if(null!==fe.current)a=fe.current-1;else{if(null===he.current){var n=localStorage.getItem("login-time");null!==n?(he.current=n,t=parseInt(n,10)):(t=Date.now(),he.current=t)}else t=parseInt(he.current,10);null===Oe.current&&(Oe.current=function(){var e=localStorage.getItem("token-expiration-time");return null===e?300:e.endsWith("h")?60*parseInt(e.slice(0,-1))*60*1e3:e.endsWith("m")?60*parseInt(e.slice(0,-1))*1e3:(e.endsWith("s"),1e3*parseInt(e.slice(0,-1)))}()),a=(t+Oe.current-Date.now())/1e3}if(a<60&&(clearInterval(pe.current),function(){var e={headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Authorization:T()}},t=M+"/login";return new Promise((function(a,n){x.put(t,{},e).then((function(e){localStorage.setItem("token",e.data.token),localStorage.setItem("login-time",(new Date).getTime().toString()),localStorage.setItem("token-expiration-time",e.data.token_expiration_time),a(e)})).catch((function(e){n(e)}))}))}().then((function(){fe.current=null,he.current=null,pe.current=setInterval((function(){e()}),1e3)}))),a<=0)return localStorage.clear(),void window.location.replace("/");fe.current=parseInt(a,10)}pe.current=setInterval((function(){e()}),1e3)}),[]),Object(ne.jsxs)("nav",{className:"app-nav",children:[Object(ne.jsx)(h.a,{className:"app-nav-opener",onClick:function(){return s(!a)},children:a?Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true"}):Object(ne.jsx)("i",{className:"fa fa-bars","aria-hidden":"true"})}),Object(ne.jsx)(b.b,{to:"/add/measurements",className:"nav-wrap",children:U}),Object(ne.jsx)("hr",{}),Object(ne.jsx)("div",{className:"app-nav-wrapper ".concat(a?"opened":""),children:Object(ne.jsxs)("div",{className:"app-nav-links",children:[Object(ne.jsx)("hr",{}),Object(ne.jsxs)("div",{className:"data-wrapper",children:[Object(ne.jsxs)(b.b,{to:"/viewProfile/",children:[ae().welcome+" ",Object(ne.jsx)("b",{children:ve.current})]},"viewProfile"),Object(ne.jsx)("div",{style:{paddingLeft:"10px"},children:Object(ne.jsxs)("h3",{children:[ae().role+" ","admin"===me.current?Object(ne.jsx)("i",{className:"fa fa-user-tie","aria-hidden":"true",title:"Admin"}):"provider"===me.current?Object(ne.jsx)("i",{className:"fa fa-user-graduate","aria-hidden":"true",title:"Provider"}):"analyst"===me.current?Object(ne.jsx)("i",{className:"fa fa-user-cog","aria-hidden":"true",title:"Analyst"}):"supplier"===me.current?Object(ne.jsx)("i",{className:"fa fa-user-tag","aria-hidden":"true",title:"Supplier"}):Object(ne.jsx)("i",{className:"fa fa-user","aria-hidden":"true","aria-label":"User"})]})}),Object(ne.jsx)("div",{style:{paddingLeft:"10px"},children:Object(ne.jsxs)("h3",{children:[ae().tenant+" ",Object(ne.jsx)("b",{children:xe.current})]})}),Object(ne.jsx)("br",{}),Object(ne.jsx)("div",{style:{paddingLeft:"20px",paddingBottom:"20px"},children:Object(ne.jsx)(h.a,{variant:"outline-danger",onClick:function(){return localStorage.clear(),void document.location.replace("/")},children:ae().logout})}),J.length>1&&Object(ne.jsxs)(r.a.Fragment,{children:[Object(ne.jsx)("hr",{}),Object(ne.jsx)("h2",{children:Object(ne.jsx)(re,{})})]})]}),Object(ne.jsx)("div",{className:"app-nav-text",children:ae().resources}),Object(ne.jsx)("hr",{}),Object(ne.jsx)(b.b,{to:"/measurements",className:function(e){return e.isActive?"active":""},onClick:function(){return s(!1)},children:"Controlli"},"measurements"),Object(ne.jsx)(b.b,{to:"/analyzedata",className:function(e){return e.isActive?"active":""},onClick:function(){return s(!1)},children:"Analisi dati"},"analyzedata")]})})]})}var ye=a(410),we=a(425),_e=a(232),ke=a(423);function Ce(e){var t={};return Y[e.resType].forEach((function(a){a.constructor===Object?Object.keys(a).forEach((function(n){Array.isArray(e.resource[n])?t[n]=e.resource[n].map((function(e){var t={};return a[n].forEach((function(a){t[a]=e[a]})),t})):t[n]=e.resource[n]})):Object.keys(e.resource).includes(a)&&(t[a]=e.resource[a])})),Se(t)}function Se(e){return Object(ne.jsx)(we.a,{defaultActiveKey:0,size:"lg",children:r.a.Children.toArray(Object.entries(e).map((function(e,t){var a=Object(j.a)(e,2),n=a[0],s=a[1];return Object(ne.jsxs)(we.a.Item,{eventKey:t,children:[Object(ne.jsx)(we.a.Header,{children:Object(ne.jsx)("b",{children:n})}),Object(ne.jsx)(we.a.Body,{children:s instanceof Object?Array.isArray(s)?void 0!==s[0]?Object.values(s[0]).some((function(e){return e instanceof Object}))?r.a.Children.toArray(s.map((function(e,t){return Object(ne.jsx)(we.a,{children:Object(ne.jsxs)(we.a.Item,{eventKey:"0",children:[Object(ne.jsxs)(we.a.Header,{children:[n," ",Object(ne.jsxs)("i",{children:["[",t,"]"]})]}),Object(ne.jsx)(we.a.Body,{children:Se(e)})]})})}))):s[0]instanceof Object?Object(ne.jsxs)(ye.a,{responsive:!0,striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(ne.jsx)("thead",{children:Object(ne.jsx)("tr",{children:r.a.Children.toArray(Object.keys(s[0]).map((function(e){return Object(ne.jsx)("th",{children:e})})))})}),Object(ne.jsx)("tbody",{children:r.a.Children.toArray(s.map((function(e){return Object(ne.jsx)("tr",{children:r.a.Children.toArray(Object.values(e).map((function(e){return Object(ne.jsx)("td",{children:e})})))})})))})]}):"[ "+s.join(" , ")+" ]":"[ ]":"AAAA":void 0===s||null==s?Object(ne.jsx)("i",{children:"None"}):s})]})})))})}function Ne(e){var t=Object(n.useState)(void 0),a=Object(j.a)(t,2),r=a[0],s=a[1];Object(n.useEffect)((function(){}),[e]);var i=void 0!==r?Object(ne.jsxs)(_e.a,{id:"popover-positioned-left",style:{width:"20vw",minWidth:1==/Mobi/i.test(window.navigator.userAgent)?250:"400px"},children:[Object(ne.jsx)(_e.a.Header,{as:"h3",children:"View Resource"}),Object(ne.jsx)(_e.a.Body,{children:Object(ne.jsx)(Ce,{resource:r,resType:e.resType})})]}):Object(ne.jsx)(_e.a,{id:"popover-positioned-left",style:{width:"20vw"},children:Object(ne.jsxs)(_e.a.Header,{as:"h3",children:["Loading",Object(ne.jsx)(_e.a.Body,{})]})});return"view"===e.action?Object(ne.jsx)(ke.a,{trigger:"click",placement:"left",overlay:i,rootClose:!0,children:Object(ne.jsx)(h.a,{variant:"link",size:"sm",onClick:function(){s(e.takeSingle(e.id))},children:Object(ne.jsx)("i",{className:"fa fa-eye","aria-hidden":"true",title:"View",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}):"delete"===e.action?Object(ne.jsx)(h.a,{variant:"link",size:"sm",onClick:Object(d.a)(Object(l.a)().mark((function t(){return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Sei sicuro di voler eliminare il controllo?")){t.next=12;break}return t.prev=2,t.next=5,A(e.resType,e.id);case 5:200===t.sent.response.status&&e.removeSingle(e.id),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),children:Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true",title:"Delete",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})}):"edit"===e.action?Object(ne.jsx)(b.b,{to:"/edit/"+e.resType+"/"+e.id,children:Object(ne.jsx)(h.a,{variant:"link",size:"sm",children:Object(ne.jsx)("i",{className:"fa fa-pencil-alt","aria-hidden":"true",title:"Edit",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}):"duplicate"===e.action?Object(ne.jsx)(b.b,{to:"/add/"+e.resType+"/?from="+e.id,children:Object(ne.jsx)(h.a,{variant:"link",size:"sm",children:Object(ne.jsx)("i",{className:"fa fa-copy","aria-hidden":"true",title:"Duplicate",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}):Object(ne.jsx)("div",{})}je.a.library.add(be.e,be.i,be.c);var Ae=function e(t){if(void 0===t)return!0;if(null==t)return!0;if("number"===typeof t)return isNaN(t);if("string"===typeof t)return""===t;if(Array.isArray(t)){if(0===t.length)return!0;var a=!0;return t.forEach((function(t){a=a&&e(t)})),a}if(t.constructor===Object){var n=!0;return Object.entries(t).forEach((function(t){var a=Object(j.a)(t,2),r=(a[0],a[1]);n=n&&e(r)})),n}},Ie=function(e){return!1===Array.isArray(e)?-1:e.filter((function(e){return!Ae(e)})).length},Pe=function e(t){if(Array.isArray(t),t.constructor===Object)for(var a=Object.entries(t),n=0;n<a.length;n++){if(Array.isArray(a[n][1]))for(var r=0;r<a[n][1].length;r++)a[n][1][r].constructor===Object||Array.isArray(a[n][1][r])?(e(a[n][1][r]),Ae(a[n][1][r])&&a[n][1].splice(r,1)):Ae(a[n][1][r])&&a[n][1].splice(r,1);if(a[n][1].constructor===Object)for(var s=Object.entries(a[n][1]),i=0;i<s.length;i++)s[n][1].constructor===Object||Array.isArray(s[n][1])?e(s[n][1]):Ae(s[n][1])&&delete a[n][1][s[n][0]]}return t},ze=function e(t,a){if(void 0===t||void 0===a)return!1;if(t===a)return!0;if(typeof t!==typeof a)return!1;if(Array.isArray(t)&&!Array.isArray(a)||!Array.isArray(t)&&Array.isArray(a))return!1;if(Array.isArray(t)&&Array.isArray(a)){if(t.length!==a.length)return!1;for(var n=0;n<t.length;n++)if(!e(t[n],a[n]))return!1;return!0}if(t.constructor===Object&&a.constructor!==Object||t.constructor!==Object&&a.constructor===Object)return!1;if(t.constructor===Object&&a.constructor===Object){var r=Object.keys(t),s=Object.keys(a);return r.length===s.length&&(!!e(r,s)&&!!e(Object.values(t),Object.values(a)))}return!1};function De(e){return e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function Re(e,t){console.log({data:e,header:t});var a=Object.fromEntries(t.map((function(e){return[e,""]}))),n=new RegExp(/,/g),r=new RegExp(/\n/g);return t.join(",").concat("\n").concat(e.map((function(e){var t=Object.assign(a,e);return Object.entries(t).map((function(e){return"string"===typeof e[1]?e[1].replace(n,"-").replace(r,""):"Data"===e[0]?De(new Date(e[1])):e[1]})).join(",")})).join("\n"))}function Te(e){return void 0===e.header||void 0===e.resources||e.header.includes("actions")&&void 0===e.actions?Object(ne.jsx)("div",{children:"Loading"}):Object(ne.jsx)("div",{children:Object(ne.jsxs)(ye.a,{responsive:!0,striped:!0,bordered:!0,hover:!0,children:[Object(ne.jsx)("thead",{children:Object(ne.jsx)("tr",{children:r.a.Children.toArray(e.header.map((function(t){return void 0!==q[e.resType]&&void 0!==q[e.resType][t]?Object(ne.jsxs)("th",{children:[q[e.resType][t],"Sostanza"!==t&&"Livello"!==t&&Object(ne.jsxs)(r.a.Fragment,{children:[" ",Object(ne.jsx)(h.a,{variant:e.orderBy===t?"link":"light",size:"sm",onClick:function(){e.sortHandler(t)},children:Object(ne.jsx)("b",{children:!0===e.ascending&&e.orderBy===t?"^":"V"})}),Object(ne.jsx)("i",{className:"fa fa-list",title:"",style:{width:"20px",height:"20px",opacity:.85}})]})]}):Object(ne.jsxs)("th",{children:[t,"Sostanza"!==t&&"Livello"!==t&&Object(ne.jsxs)(r.a.Fragment,{children:[Object(ne.jsx)(h.a,{variant:e.orderBy===t?"link":"light",size:"sm",onClick:function(){e.sortHandler(t)},children:Object(ne.jsx)("b",{children:!0===e.ascending&&e.orderBy===t?"^":"V"})}),Object(ne.jsx)("i",{className:"fa fa-list",title:"",style:{width:"20px",height:"20px",opacity:.85}})]})]})})))},"header")}),Object(ne.jsx)("tbody",{children:r.a.Children.toArray(e.resources.map((function(t,a){return Object(ne.jsx)("tr",{children:r.a.Children.toArray(e.header.map((function(n){if("actions"===n)return Object(ne.jsxs)("td",{children:[e.actions.includes("view")?Object(ne.jsx)(Ne,{resType:e.resType,action:"view",k:a+"_view",id:t._id,takeSingle:e.takeSingle}):"",e.actions.includes("edit")?Object(ne.jsx)(Ne,{resType:e.resType,action:"edit",k:a+"_edit",id:t._id}):"",e.actions.includes("duplicate")?Object(ne.jsx)(Ne,{resType:e.resType,action:"duplicate",k:a+"_duplicate",id:t._id}):"",e.actions.includes("delete")?Object(ne.jsx)(Ne,{resType:e.resType,action:"delete",k:a+"_delete",id:t._id,removeSingle:e.removeSingle}):""]});if(void 0!==t[n]){if(Array.isArray(t[n])){if(void 0!==t[n][0]&&t[n][0].constructor===Object){var r="[ "+t[n].map((function(e){return Object.values(e).join(" - ")})).join(" -- ")+" ]";return Object(ne.jsx)("td",{children:r.length<=100?r:r.slice(0,97)+"..."})}return Object(ne.jsx)("td",{children:"[ "+t[n].join(" , ")+" ]"})}return"Data"===n?Object(ne.jsx)("td",{children:De(new Date(t[n]))}):Object(ne.jsx)("td",{children:t[n]})}})))})})))})]})})}je.a.library.add(be.j,be.d,be.f);var Fe=a(411),Ee=a(430),Le=a(427);function Be(e){return void 0===e.header||void 0===e.resources||e.header.includes("actions")&&void 0===e.actions?Object(ne.jsx)("div",{children:"Loading"}):0===e.resources.length?Object(ne.jsx)("div",{children:"Non sono presenti controlli"}):Object(ne.jsx)(Fe.a,{children:r.a.Children.toArray(e.resources.map((function(t){var a=new Date(t.samples[0].values[2]),n=new Set(t.samples.map((function(e){return e.values[4]}))).size,s=t.samples.filter((function(e){return"nullo"!==e.values[11]})).map((function(e){return Object(ne.jsx)(Ee.a.Item,{children:e.values[7]+"_"+e.values[5]+" ("+e.values[6]+") : "+e.values[10]+" "+e.values[11]})}));if(s.length!==n){var i=t.samples.filter((function(e){return"negativo"===e.values[9]})).map((function(e){return[e.values[7],e.values[5],e.values[6],e.values[9]]}))[0];void 0===i?s.push(Object(ne.jsx)(Ee.a.Item,{children:t.samples[0].values[7]+"_"+t.samples[0].values[5]+" ("+t.samples[0].values[6]+") : "+t.samples[0].values[9]})):s.push(Object(ne.jsx)(Ee.a.Item,{children:i[0]+"_"+i[1]+" ("+i[2]+") : "+i[3]}))}return Object(ne.jsxs)(Le.a,{border:"primary",style:{width:"18rem"},children:[Object(ne.jsxs)(Le.a.Header,{children:[t.samples[0].values[0]," ",Object(ne.jsx)(Ne,{resType:e.resType,action:"delete",id:t._id,removeSingle:e.removeSingle})]}),Object(ne.jsxs)(Le.a.Body,{children:[Object(ne.jsx)(Le.a.Text,{children:a.toDateString()}),Object(ne.jsx)(Le.a.Text,{children:t.samples[0].values[1]})]}),Object(ne.jsx)(Ee.a,{className:"list-group-flush",children:r.a.Children.toArray(s)})]})})))})}var Ge=a(431);a(164);function We(e){var t=Object(p.p)().page,a=Object(b.c)(),r=Object(j.a)(a,2),s=r[0],i=r[1],c=Object(n.useState)(void 0),o=Object(j.a)(c,2),u=o[0],f=o[1],O=Object(n.useState)(void 0),m=Object(j.a)(O,2),v=m[0],x=m[1],g=Object(n.useState)(void 0),y=Object(j.a)(g,2),w=y[0],_=y[1],k=Object(n.useState)(1),C=Object(j.a)(k,2),S=C[0],N=C[1],A=Object(n.useState)(1),I=Object(j.a)(A,2),z=I[0],D=I[1],R=Object(n.useState)(),T=Object(j.a)(R,2),F=T[0],E=T[1],L=Object(n.useState)(),B=Object(j.a)(L,2),G=B[0],W=B[1],H=Object(n.useState)(),M=Object(j.a)(H,2),U=M[0],J=M[1],q=Object(n.useState)(),Y=Object(j.a)(q,2),Q=Y[0],X=Y[1],Z=Object(n.useState)(),$=Object(j.a)(Z,2),ee=$[0],te=$[1];Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var a,n,r=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:{},e.prev=1,e.next=4,P(t,a);case 4:n=e.sent,x(K[t]),f(n.docs),void 0!==V[t]&&_(V[t]),E(n.hasNextPage),W(n.hasPrevPage),te(n.totalPages),J(n.prevPage),X(n.nextPage),e.next=25;break;case 15:e.prev=15,e.t0=e.catch(1),console.log(e.t0),x(void 0),f(void 0),E(void 0),W(void 0),te(void 0),J(void 0),X(void 0);case 25:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(){return e.apply(this,arguments)}}(),a=null!==s.get("page")?s.get("page"):1;N(a);var n=null!==s.get("limit")?s.get("limit"):10;D(n),e({page:a,limit:n}).catch(console.error)}),[e,t,s]);var ae=function(){var e=parseInt(S,10)-2>0,t=parseInt(S,10)+2<ee;return Object(ne.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:Object(ne.jsxs)(Ge.a,{style:{alignSelf:"center",marginLeft:"auto",marginRight:"auto"},children:[Object(ne.jsx)(Ge.a.First,{disabled:1===S,onClick:function(){return i({page:1,limit:z})}}),Object(ne.jsx)(Ge.a.Prev,{disabled:!G,onClick:function(){return i({page:U,limit:z})}}),e&&Object(ne.jsx)(Ge.a.Ellipsis,{}),parseInt(S,10)-1>0&&Object(ne.jsx)(Ge.a.Item,{onClick:function(){return i({page:parseInt(S,10)-1,limit:z})},children:parseInt(S,10)-1}),Object(ne.jsx)(Ge.a.Item,{children:Object(ne.jsx)("b",{children:S})}),parseInt(S,10)+1<=ee&&Object(ne.jsx)(Ge.a.Item,{onClick:function(){return i({page:parseInt(S,10)+1,limit:z})},children:parseInt(S,10)+1}),t&&Object(ne.jsx)(Ge.a.Ellipsis,{}),Object(ne.jsx)(Ge.a.Next,{disabled:!F,onClick:function(){return i({page:Q,limit:z})}}),Object(ne.jsx)(Ge.a.Last,{disabled:S===ee,onClick:function(){return i({page:ee,limit:z})}})]})})};return Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsxs)("header",{className:"page-header",children:[Object(ne.jsx)("b",{children:"Controlli"}),Object(ne.jsx)(b.b,{to:"/add/"+t+"/",children:Object(ne.jsx)(h.a,{variant:"link",size:"sm",children:Object(ne.jsx)("i",{className:"fa fa-plus-circle","aria-hidden":"true",title:"Add",style:{width:"30px",height:"30px",opacity:.85}})})})]}),Object(ne.jsxs)("main",{className:"page-content",children:[Object(ne.jsx)("br",{}),Object(ne.jsx)(Be,{resType:t,header:v,resources:u,actions:w,takeSingle:function(e){return u.find((function(t){return t._id===e}))},removeSingle:function(e){var t=u.filter((function(t){return t._id!==e}));f(t)}}),Object(ne.jsx)(ae,{})]})]})}je.a.library.add(be.j);var He=a(412),Me=a(413),Ue=a(225),Je=a(147);function Ke(e){var t=Object(n.useState)(""),a=Object(j.a)(t,2),r=a[0],s=a[1],i=Object(n.useState)(""),c=Object(j.a)(i,2),o=(c[0],c[1]),u=Object(n.useState)(""),b=Object(j.a)(u,2),p=b[0],f=b[1],O=Object(n.useState)(""),m=Object(j.a)(O,2),v=m[0],x=m[1],g=Object(n.useState)(""),w=Object(j.a)(g,2),_=w[0],k=w[1],C=Object(n.useState)(""),N=Object(j.a)(C,2),A=N[0],I=N[1],P=Object(n.useState)(""),z=Object(j.a)(P,2),D=z[0],R=z[1],T=Object(n.useState)(""),F=Object(j.a)(T,2),E=F[0],L=F[1],B=Object(n.useState)(""),G=Object(j.a)(B,2),H=G[0],M=G[1],U=Object(n.useState)(""),J=Object(j.a)(U,2),K=J[0],q=J[1],V=Object(n.useState)(""),Y=Object(j.a)(V,2),Q=Y[0],X=Y[1],Z=Object(n.useState)(!1),$=Object(j.a)(Z,2),ee=$[0],te=$[1];Object(n.useEffect)((function(){var e=localStorage.getItem("username"),t=localStorage.getItem("user-role"),a=localStorage.getItem("user-tenant"),n=localStorage.getItem("user-email");s(null!==e?e:""),o(null!==t?t:""),f(null!==a&&""!==a?a:"-"),x(null!==n?n:"")}),[]);var re=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var a,n,s,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==_){e.next=5;break}return q(ae().old_pass_empty),te(!0),e.abrupt("return");case 5:if(A===D){e.next=9;break}return q(ae().pass_not_match),te(!0),e.abrupt("return");case 9:if(""!==A&&""!==D){e.next=13;break}return q(ae().pass_not_null),te(!0),e.abrupt("return");case 13:return e.prev=13,e.next=16,W();case 16:if(n=e.sent,a=n.response.data.passwordStrength,!(Object(Je.passwordStrength)(A).id<a)){e.next=23;break}return q(ae().stronger_password_required),te(!0),e.abrupt("return");case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(13),console.log(e.t0),a=1;case 29:return e.prev=29,e.next=32,y(r,_,"-"!==p?p:"");case 32:e.next=39;break;case 34:return e.prev=34,e.t1=e.catch(29),q(ae().old_pass_wrong),te(!0),e.abrupt("return");case 39:if(s=window.confirm(ae().pass_change_confirm),te(!1),!s){e.next=55;break}return e.prev=42,e.next=45,S("users",{password:A},r);case 45:i=e.sent,k(""),I(""),R(""),200===i.response.status&&q(ae().password_changed),e.next=55;break;case 52:e.prev=52,e.t2=e.catch(42),console.log(e.t2);case 55:case"end":return e.stop()}}),e,null,[[13,25],[29,34],[42,52]])})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==E&&""!==H){e.next=5;break}return X(ae().empty_email_error),te(!0),e.abrupt("return");case 5:if(E===H){e.next=9;break}return X(ae().email_not_match),te(!0),e.abrupt("return");case 9:if(E!==v){e.next=13;break}return X(ae().email_same_as_old),te(!0),e.abrupt("return");case 13:if(!window.confirm(ae().email_change_confirm)){e.next=25;break}return e.prev=15,e.next=18,S("users",{email:E},r);case 18:200===e.sent.response.status&&(L(""),M(""),localStorage.setItem("user-email",E),x(E),te(!1),X(ae().email_changed)),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(15),console.log(e.t0);case 25:case"end":return e.stop()}}),e,null,[[15,22]])})));return function(t){return e.apply(this,arguments)}}();return Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsxs)("header",{className:"page-header",children:[ae().welcome,"\xa0",Object(ne.jsx)("b",{children:r}),":\xa0",ae().profile_page_desc]}),Object(ne.jsxs)("main",{className:"page-content",children:[Object(ne.jsxs)(He.a,{fluid:!0,children:[Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{xs:1,children:"Username:\xa0"})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("b",{children:r})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{xs:1,children:"Email:\xa0"})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("b",{children:v})})})]}),Object(ne.jsx)("hr",{}),Object(ne.jsxs)(He.a,{fluid:!0,children:[Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)(Me.a,{children:Object(ne.jsx)("b",{children:"Modifica email"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(se.a,{onSubmit:ie,children:[Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"email",onChange:function(e){e.preventDefault(),L(e.target.value)},value:E,placeholder:ae().enter+" nuova email"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"email",onChange:function(e){e.preventDefault(),M(e.target.value)},value:H,placeholder:ae().repeat+" nuova email"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("font",{style:{marginLeft:"5px",color:ee?"red":"black"},children:Q})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)(h.a,{variant:"primary",type:"submit",children:ae().submit})})})]})})})]}),Object(ne.jsx)("hr",{}),Object(ne.jsxs)(He.a,{fluid:!0,children:[Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)(Me.a,{children:Object(ne.jsx)("b",{children:"Modifica password"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(se.a,{onSubmit:re,children:[Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"password",onChange:function(e){e.preventDefault(),k(e.target.value)},value:_,placeholder:ae().enter+" vecchia password"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"password",onChange:function(e){e.preventDefault(),I(e.target.value)},value:A,placeholder:ae().enter+" nuova password"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"password",onChange:function(e){e.preventDefault(),R(e.target.value)},value:D,placeholder:ae().repeat+" nuova password"})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("font",{style:{marginLeft:"5px",color:ee?"red":"black"},children:K})})}),Object(ne.jsx)(h.a,{variant:"primary",type:"submit",children:ae().submit})]})})})]})]})]})}a(300),a(301);function qe(){return Object(ne.jsx)("div",{className:"unAuth-page",children:Object(ne.jsx)("div",{className:"info-box",children:Object(ne.jsx)("div",{className:"info-text",children:ae().unauthorised_user})})})}var Ve=r.a.createRef(),Ye="think-before-tenant";function Qe(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),a=t[0],r=t[1],s=Object(p.n)();function i(){return(i=Object(d.a)(Object(l.a)().mark((function e(t){var a,n;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=Ve.current.value,n=Ye,""!==a){e.next=6;break}return r(ae().missing_email),e.abrupt("return");case 6:return e.prev=6,e.next=9,E(n,a);case 9:r(ae().email_sent_successfully),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),console.log({error:e.t0.response.data}),r(ae().email_sent_errors);case 16:case"end":return e.stop()}}),e,null,[[6,12]])})))).apply(this,arguments)}return Object(ne.jsxs)("div",{className:"auth-page",children:[Object(ne.jsx)("div",{className:"title-wrapper",children:Object(ne.jsx)("div",{className:"title-section",children:"Pensaci Prima"})}),J.length>1&&Object(ne.jsx)("div",{className:"language-wrapper",children:Object(ne.jsx)(re,{})}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("div",{className:"login-section",children:[Object(ne.jsx)(se.a,{onSubmit:function(e){return i.apply(this,arguments)},children:Object(ne.jsxs)(He.a,{fluid:!0,children:[Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("h4",{children:ae().password_recovery})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(se.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(ne.jsx)(se.a.Label,{children:ae().email}),Object(ne.jsx)(se.a.Control,{type:"email",ref:Ve,placeholder:ae().email_suggestion})]})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsxs)(Ue.a,{children:[Object(ne.jsx)(h.a,{variant:"success",type:"submit",children:ae().submit})," ","\xa0\xa0\xa0",Object(ne.jsx)(h.a,{variant:"secondary",onClick:function(e){e.preventDefault(),s(-1)},children:ae().cancel})]})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("div",{style:{color:"black"},children:a})})})]})}),Object(ne.jsx)("br",{})]})]})}var Xe=r.a.createRef(),Ze=r.a.createRef(),$e="think-before-tenant";function et(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),a=t[0],r=t[1],s=Object(b.c)(),i=Object(j.a)(s,2),c=i[0],o=(i[1],Object(n.useState)(c.get("token"))),u=Object(j.a)(o,2),f=u[0],O=u[1],m=Object(p.n)();function v(){return(v=Object(d.a)(Object(l.a)().mark((function e(t){var a,n,s,i,c,o,d;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,W();case 4:n=e.sent,a=n.response.data.passwordStrength,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),a=1;case 12:if(s=$e,i=Xe.current.value,c=Ze.current.value,""!==i&&""!==c){e.next=18;break}return r(ae().pass_not_null),e.abrupt("return");case 18:if(i===c){e.next=21;break}return r(ae().pass_not_match),e.abrupt("return");case 21:if(""!==f&&void 0!=f){e.next=24;break}return r(ae().missing_token),e.abrupt("return");case 24:if(!((o=Object(Je.passwordStrength)(i)).id<a)){e.next=28;break}return r(ae().stronger_password_required),e.abrupt("return");case 28:return console.log(o.id),e.prev=29,e.next=32,B(s,f,i);case 32:d=e.sent,console.log(d),r(ae().password_changed),e.next=44;break;case 37:if(e.prev=37,e.t1=e.catch(29),console.log(e.t1),"Network Error"!==e.t1.error.message){e.next=43;break}return r(ae().network_error),e.abrupt("return");case 43:r(ae().password_not_changed_errors);case 44:case"end":return e.stop()}}),e,null,[[1,8],[29,37]])})))).apply(this,arguments)}return Object(ne.jsxs)("div",{className:"auth-page",children:[Object(ne.jsx)("div",{className:"title-wrapper",children:Object(ne.jsx)("div",{className:"title-section",children:"Pensaci Prima"})}),J.length>1&&Object(ne.jsx)("div",{className:"language-wrapper",children:Object(ne.jsx)(re,{})}),Object(ne.jsx)("br",{}),Object(ne.jsx)("br",{}),Object(ne.jsxs)("div",{className:"login-section",children:[Object(ne.jsx)(se.a,{onSubmit:function(e){return v.apply(this,arguments)},children:Object(ne.jsxs)(He.a,{fluid:!0,children:[Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("h4",{children:ae().password_reset})})}),(null===c.get("token")||""===c.get("token"))&&Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(se.a.Group,{className:"mb-3",controlId:"token",children:[Object(ne.jsx)(se.a.Label,{children:"Token"}),Object(ne.jsx)(se.a.Control,{onChange:function(e){e.preventDefault(),O(e.target.value)},type:"text",placeholder:ae().enter+" token"})]})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(se.a.Group,{className:"mb-3",controlId:"tenant",children:[Object(ne.jsx)(se.a.Label,{children:ae().password}),Object(ne.jsx)(se.a.Control,{ref:Xe,type:"password",placeholder:ae().enter+" new password"}),Object(ne.jsx)(se.a.Text,{className:"text-muted",children:ae().password_rules})]})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)(se.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:Object(ne.jsx)(se.a.Control,{type:"password",ref:Ze,placeholder:ae().repeat+" new password"})})})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsxs)(Ue.a,{children:[Object(ne.jsx)(h.a,{variant:"success",type:"submit",children:ae().submit})," ","\xa0\xa0\xa0",Object(ne.jsx)(h.a,{variant:"secondary",onClick:function(){m("/")},children:ae().go_login_page})]})}),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)("div",{style:{color:"black"},children:a})})})]})}),Object(ne.jsx)("br",{})]})]})}var tt=r.a.createContext(),at=a(421),nt=a(422),rt=function(e){var t,a=Object(n.useContext)(tt);if(t=void 0!==a?a.fetched:{},void 0===e.values||void 0===e.resource||void 0===e.disabledFields||void 0===e.functionalFields||void 0===e.submitFunction||void 0===e.backFunction||void 0===e.handleChangesCallback||void 0===e.arrayDeleteCallback)return"Loading";return Object(ne.jsxs)(se.a,{onSubmit:e.submitFunction,children:[Object(ne.jsxs)(He.a,{fluid:!0,children:[void 0===e.functionalFields[e.resource]&&"No operation allowed",void 0!==e.functionalFields[e.resource]&&r.a.Children.toArray(Object.entries(e.values).map((function(a){var n,s=Object(j.a)(a,2),i=s[0],c=s[1];if(void 0!==ee[e.resource]&&void 0!==ee[e.resource][i]&&void 0!==t.types&&void 0!==t.types[ee[e.resource][i]])return function(t,a){return Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:t})}),Object(ne.jsx)(Ue.a,{sm:4,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsxs)(se.a.Select,{"aria-label":"Default select",value:e.values[t],id:t,onChange:function(a){a.preventDefault(),e.handleChangesCallback(a.target.value,[t])},disabled:void 0!==e.disabledFields[t]&&e.disabledFields[t],children:[Object(ne.jsx)("option",{children:ae().select+" "+t}),r.a.Children.toArray(Object.entries(a).map((function(e){var t=Object(j.a)(e,2),a=t[0],n=t[1];return Object(ne.jsx)("option",{value:a,children:n})})))]})})})]})}(i,t.types[ee[e.resource][i]]);if(Array.isArray(c)){if("number"===typeof c[0])return n=i,Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:n})}),Object(ne.jsx)(Ue.a,{sm:4,children:r.a.Children.toArray(e.values[n].map((function(t,a){return Object(ne.jsx)(Me.a,{children:Object(ne.jsxs)(se.a.Group,{className:"mb-3",children:[Object(ne.jsxs)(se.a.Label,{children:["Insert ",Object(ne.jsx)("b",{children:n}),Object(ne.jsxs)("i",{children:["[",a,"]"]})]}),Object(ne.jsx)(se.a.Control,{type:"number",disabled:void 0!==e.disabledFields[n]&&e.disabledFields[n],onChange:function(t){t.preventDefault(),e.handleChangesCallback(parseInt(t.target.value,10),[n,a])},value:isNaN(e.values[n][a])?"":e.values[n][a],placeholder:ae().enter+" "+n})]})})})))})]});if("string"===typeof c[0])return function(a){var n;return t!=={}&&void 0!==t.data[a]&&(n=t.data[a]),Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:a})}),Object(ne.jsx)(Ue.a,{children:r.a.Children.toArray(e.values[a].map((function(r,s){return Object(ne.jsxs)(Me.a,{children:[Object(ne.jsx)(Ue.a,{sm:1,children:Object(ne.jsx)(h.a,{disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],variant:"link",size:"sm",onClick:function(t){t.preventDefault(),e.arrayDeleteCallback([a,s])},children:Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true",title:"Remove element",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}),Object(ne.jsx)(Ue.a,{sm:4,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:void 0!==t.data[a]?Object(ne.jsx)(nt.a,{disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],id:a,onChange:function(t,n){t.preventDefault(),e.handleChangesCallback(n,[a,s])},value:""===e.values[a][s]?null:e.values[a][s],options:n,renderInput:function(e){return Object(ne.jsx)(at.a,Object(o.a)(Object(o.a)({},e),{},{label:ae().enter+" "+a}))}}):Object(ne.jsx)(se.a.Control,{type:"text",disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],onChange:function(t){t.preventDefault(),e.handleChangesCallback(t.target.value,[a,s])},value:e.values[a][s],placeholder:ae().enter+" "+a})})}),Object(ne.jsx)(Ue.a,{md:"auto"})]})})))})]})}(i);if(c[0].constructor===Object)return function(a){return Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:a})}),Object(ne.jsx)(Ue.a,{children:r.a.Children.toArray(e.values[a].map((function(n,s){return Object(ne.jsxs)(Me.a,{children:[Object(ne.jsx)(Ue.a,{sm:1,children:Object(ne.jsx)(h.a,{disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],variant:"link",size:"sm",onClick:function(t){t.preventDefault(),e.arrayDeleteCallback([a,s])},children:Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true",title:"Remove element",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}),r.a.Children.toArray(Object.entries(n).map((function(n){var i=Object(j.a)(n,2),c=i[0],o=i[1];return"number"===typeof o?Object(ne.jsx)(Ue.a,{sm:2,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"number",onChange:function(t){t.preventDefault(),e.handleChangesCallback(parseInt(t.target.value,10),[a,s,c])},disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],value:isNaN(e.values[a][s][c])?"":e.values[a][s][c],placeholder:ae().enter+" "+c},a+c+s+"")})}):void 0!==ee[e.resource]&&void 0!==ee[e.resource][a]&&void 0!==ee[e.resource][a][c]&&void 0!==t.types&&void 0!==t.types[ee[e.resource][a][c]]?Object(ne.jsx)(Ue.a,{sm:3,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsxs)(se.a.Select,{"aria-label":"Default select",onChange:function(t){t.preventDefault(),e.handleChangesCallback(t.target.value,[a,s,c])},value:e.values[a][s][c],disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],children:[Object(ne.jsx)("option",{children:ae().select+" "+c}),r.a.Children.toArray(Object.entries(t.types[ee[e.resource][a][c]]).map((function(e){var t=Object(j.a)(e,2),a=t[0],n=t[1];return Object(ne.jsx)("option",{value:a,children:n})})))]})})}):"string"===typeof o?Object(ne.jsx)(Ue.a,{sm:3,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"text",disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],onChange:function(t){t.preventDefault(),e.handleChangesCallback(t.target.value,[a,s,c])},value:e.values[a][s][c],placeholder:ae().enter+" "+c})})}):Array.isArray(o)?0===o.length?c+" is empty":"range"===c&&"enum"!==e.values[a][s].type?"":Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(we.a,{defaultActiveKey:"0",children:Object(ne.jsxs)(we.a.Item,{eventKey:"0",children:[Object(ne.jsxs)(we.a.Header,{children:[Object(ne.jsx)("b",{children:c})," : ",Ie(o)," items"]}),Object(ne.jsx)(we.a.Body,{children:r.a.Children.toArray(o.map((function(t,n){if(t.constructor===Object){var i=Object.entries(t);return Object(ne.jsxs)(Me.a,{children:[Object(ne.jsx)(Ue.a,{sm:1,style:{borderRightStyle:"dotted",borderRightWidth:"1px"}}),Object(ne.jsx)(Ue.a,{sm:1,children:Object(ne.jsx)(h.a,{disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],variant:"link",size:"sm",onClick:function(t){t.preventDefault(),e.arrayDeleteCallback([a,s,c,n])},children:Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true",title:"Remove element",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}),r.a.Children.toArray(i.map((function(t){var r=Object(j.a)(t,2),i=r[0],o=r[1];return Object(ne.jsx)(Ue.a,{sm:3,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"text",disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],onChange:function(t){t.preventDefault(),e.handleChangesCallback(t.target.value,[a,s,c,n,i])},value:o,placeholder:ae().enter+" "+i})})})})))]})}return"number"===typeof t?Object(ne.jsxs)(Me.a,{children:[Object(ne.jsx)(Ue.a,{sm:1,children:Object(ne.jsx)(h.a,{disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],variant:"link",size:"sm",onClick:function(t){t.preventDefault(),e.arrayDeleteCallback([a,s,c,n])},children:Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true",title:"Remove element",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}),Object(ne.jsx)(Ue.a,{sm:3,children:Object(ne.jsx)(se.a.Control,{type:"number",disabled:void 0!==e.disabledFields[c]&&e.disabledFields[c],onChange:function(t){t.preventDefault(),e.handleChangesCallback(parseInt(t.target.value,10),[a,s,c,n])},value:isNaN(t)?"":t,placeholder:ae().enter+" "+c},""+a+s+c+n)})]}):"string"===typeof t?Object(ne.jsxs)(Me.a,{children:[Object(ne.jsx)(Ue.a,{sm:1,children:Object(ne.jsx)(h.a,{disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],variant:"link",size:"sm",onClick:function(t){t.preventDefault(),e.arrayDeleteCallback([a,s,c,n])},children:Object(ne.jsx)("i",{className:"fa fa-times","aria-hidden":"true",title:"Remove element",style:{width:"30px",height:"30px",marginRight:"10px",opacity:.85}})})}),Object(ne.jsx)(Ue.a,{sm:3,children:Object(ne.jsx)(se.a.Control,{type:"text",disabled:void 0!==e.disabledFields[c]&&e.disabledFields[c],onChange:function(t){t.preventDefault(),e.handleChangesCallback(t.target.value,[a,s,c,n])},value:t,placeholder:ae().enter+" "+c},""+a+s+c+n)})]}):"Unknown data type"})))})]})})}):"Unknown data type"})))]})})))})]})}(i)}return"number"===typeof c?function(t){return Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:t})}),Object(ne.jsx)(Ue.a,{sm:4,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"number",id:t,onChange:function(a){a.preventDefault(),e.handleChangesCallback(parseInt(a.target.value,10),[t])},value:isNaN(e.values[t])?"":e.values[t],disabled:void 0!==e.disabledFields[t]&&e.disabledFields[t],placeholder:ae().enter+" "+t})})})]})}(i):void 0!==te[e.resource]&&void 0!==te[e.resource][i]&&void 0!==t.data[te[e.resource][i]]?function(a,n){var r;return t==={}||void 0===t.data[a]&&void 0===t.data[n]||(r=t.data[void 0!==n?n:a]),Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:a})}),Object(ne.jsx)(Ue.a,{sm:4,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(nt.a,{id:a,onChange:function(t,n){t.preventDefault(),e.handleChangesCallback(n,[a])},disabled:void 0!==e.disabledFields[a]&&e.disabledFields[a],value:""===e.values[a]?null:e.values[a],options:r,renderInput:function(e){return Object(ne.jsx)(at.a,Object(o.a)(Object(o.a)({},e),{},{label:ae().enter+" "+a}))}})})})]})}(i,te[e.resource][i]):"string"===typeof c?function(t){return Object(ne.jsxs)(Me.a,{style:{borderBottomStyle:"solid",borderBottomWidth:"1px",marginBottom:"5px"},children:[Object(ne.jsx)(Ue.a,{sm:2,style:{borderRightStyle:"dotted",borderRightWidth:"1px"},children:Object(ne.jsx)("b",{children:t})}),Object(ne.jsx)(Ue.a,{sm:4,children:Object(ne.jsx)(se.a.Group,{className:"mb-3",children:Object(ne.jsx)(se.a.Control,{type:"password"===t?"password":"text",id:t,onChange:function(a){a.preventDefault(),e.handleChangesCallback(a.target.value,[t])},disabled:void 0!==e.disabledFields[t]&&e.disabledFields[t],value:e.values[t],placeholder:ae().enter+" "+t})})})]})}(i):c.constructor===Object?"TODO ObjectFormRow":""})))]}),Object(ne.jsx)(h.a,{variant:"primary",type:"submit",children:ae().submit},"submit"),"\xa0\xa0\xa0",Object(ne.jsx)(h.a,{variant:"secondary",onClick:e.backFunction,children:ae().cancel},"cancel")]})},st=a(109);function it(e,t){var a=Object.keys(e),n=Object.keys(t);return(a=a.filter((function(e){return-1!==n.indexOf(e)}))).sort((function(e,t){return n.indexOf(e)-n.indexOf(t)})),a.reduce((function(a,n){if(Array.isArray(e[n])&&0!==e[n].length&&e[n][0].constructor===Object){var r=e[n].map((function(e){return it(e,t[n][0])}));a[n]=r}else a[n]=e[n];return a}),{})}function ct(e,t,a){for(var n=Object.keys(e),r=st(e),s=0;s<n.length;s++)Array.isArray(r[n[s]])&&(r=ot(r,[n[s]],t,a));return r}function ot(e,t,a,n){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,s=st(e),i=s,c=st(a[n]),l=Object(u.a)(t),d=0;d<l.length&&void 0!==t[d];d++)i=i[t[d]];for(var j=0;j<l.length&&void 0!==t[j]&&void 0!==c;j++)c="number"===typeof t[j]?c[0]:c[t[j]];return Array.isArray(c)?(void 0!==c&&(0===i.length?c[0].constructor===Object?i.push(Object(o.a)({},c[0])):i.push(""):i[0].constructor===Object?0===i.filter((function(e){return Ae(e)})).length&&i.push(Object(o.a)({},c[0])):i.includes("")||i.push("")),void 0!==r&&void 0===c&&(0===i.length||0===i.filter((function(e){return Ae(e)})).length)&&(r.constructor===Object?i.push(Object(o.a)({},r)):i.push(r)),s):s}var lt=a(109);function dt(e){var t=Object(p.p)(),a=t.resource,r=t.id,s=Object(n.useState)(),i=Object(j.a)(s,2),o=i[0],b=i[1],h=Object(n.useState)(""),f=Object(j.a)(h,2),O=f[0],m=f[1],v=Object(p.n)(),x=Object(n.useState)(lt(Q[a])),g=Object(j.a)(x,2),y=g[0],w=g[1],_=Object(n.useState)({}),k=Object(j.a)(_,2),C=k[0],N=(k[1],Object(n.useState)(void 0)),A=Object(j.a)(N,2),I=A[0],z=A[1],D=Object(n.useContext)(tt).fetched,R=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===D.data[t]){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,P(t,{limit:100});case 5:a=e.sent,D.UpdateData(a.docs.map((function(e){return e._id})),t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){void 0!==te[a]&&Object.values(te[a]).forEach((function(e){return R(e)}))}),[]),Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t,n,s,i,c,o=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},e.next=3,P(a,t);case 3:n=e.sent,s=n.docs[0],i=lt(y),i=it(s,i),c=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t,n,s,c,o,d,u,j,p,h,f,O;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==Z[a]){e.next=7;break}for(z({}),t=Object.keys(i),n=0;n<t.length;n++)s=t[n],i=ot(i,[s],Q,a);return w(i),b(lt(i)),e.abrupt("return");case 7:c={},void 0!==I&&(c=I),o=Object.entries(Z[a]),d=0;case 11:if(!(d<o.length)){e.next=24;break}if(u=o[d][0],j=o[d][1],void 0!==i[u]){e.next=16;break}return e.abrupt("continue",21);case 16:if("disable"!==j.type){e.next=21;break}return e.next=19,j.policy(r);case 19:p=e.sent,c[u]=p;case 21:d++,e.next=11;break;case 24:for(h=Object.keys(i),f=0;f<h.length;f++)O=h[f],void 0!==c[O]&&!1!==c[O]||(i=ot(i,[O],Q,a));z(c),w(i),b(lt(i));case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t={_id:r};e({filter:JSON.stringify(t)})}),[]);var T=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var n,s,i,d,j,b,p,h,f,O,x,g,w,_,k,N;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.preventDefault(),n=lt(y),s=lt(o),Pe(n),Pe(s),i={},d=Object.entries(n),j=0;j<d.length;j++)if(b=d[j][0],p=d[j][1],Array.isArray(p)){if(void 0===i[b]&&(i[b]={add:[],remove:[],update:[]}),h=Object(u.a)(s[b]),void 0!==C[b])for(f=0;f<C[b].indexes.length;f++)(O=h.splice(C[b].indexes[f][0],1)[0]).constructor===Object?(x=Object.keys(O)[0],i[b].remove.push(O[x])):i[b].remove.push(O);for(g=0;g<n[b].length;g++)g<h.length&&!ze(n[b][g],h[g])&&(n[b][g].constructor===Object?(_=Object.keys(h[g])[0],i[b].update.push((w={},Object(c.a)(w,_,h[g][_]),Object(c.a)(w,"new",n[b][g]),w))):(i[b].add.push(n[b][g]),i[b].remove.push(h[g]))),g>=h.length&&i[b].add.push(n[b][g]);ze(i[b],{add:[],remove:[],update:[]})&&delete i[b]}else p.constructor===Object||p!==o[b]&&(i[b]=p);return e.prev=8,e.next=11,S(a,i,r);case 11:N=e.sent,k=N.response,m(k.statusText),v("/"+a),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(8),k=e.t0.error.response,m(e.t0.error.response.data.message+" : "+e.t0.error.response.data.details);case 21:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsxs)("header",{className:"page-header",children:["Edit \xa0",Object(ne.jsx)("b",{children:a}),"\xa0of id:\xa0",Object(ne.jsx)("b",{children:r}),"\xa0from:"]}),Object(ne.jsxs)("main",{className:"page-content",children:[Object(ne.jsx)(rt,{values:y,resource:a,functionalFields:Q,disabledFields:I,handleChangesCallback:function(e,t){var n,r=lt(y),s=r,i=-1;for(n=0;n<t.length-1;n++)s=s[t[n]],"number"===typeof t[n]&&(i=n);if("number"===typeof t[n]&&(i=n),s[t[n]]=e,-1!==i){var c="number"===typeof e?NaN:"";r=ot(r,t.slice(0,i),Q,a,c)}w(r)},arrayDeleteCallback:function(e){var t,n=lt(y),r=n;for(t=0;t<e.length-1&&void 0!==e[t];t++)r=r[e[t]];var s=r.splice(e[t],1),i="number"===typeof s[0]?NaN:"";n=ot(n,e.slice(0,t),Q,a,i),1===t&&(void 0===C[e[0]]&&(C[e[0]]={indexes:[],elements:[],minDel:1/0}),Ae(s[0])||(C[e[0]].elements.push(s[0]),C[e[0]].indexes.push(e[t]>=C[e[0]].minDel?e[t]+C[[e[0]]].indexes.filter((function(a){return a>=e[t]})).length:e[t]),e[t]<C[e[0]].minDel&&(C[e[0]].minDel=e[t]))),w(n)},submitFunction:T,backFunction:function(e){e.preventDefault(),v(-1)}}),Object(ne.jsx)("br",{}),Object(ne.jsx)("font",{style:{marginLeft:"5px"},children:O})]})]})}var ut=a(428),jt=function(e){return void 0===e.submitFunction||void 0===e.backFunction||void 0===e.setContentHeader||void 0===e.setContentPlain||void 0===e.setContentBody||void 0===e.setFile||void 0===e.contentBody||void 0===e.contentPlain||void 0===e.contentHeader?"Loading":Object(ne.jsxs)(se.a,{onSubmit:e.submitFunction,children:[Object(ne.jsx)(se.a.Label,{children:Object(ne.jsx)("b",{children:ae().select_file})}),Object(ne.jsx)(se.a.Control,{className:"mb-3",type:"file",accept:".csv, .json",label:"File",onChange:function(t){var a=t.target.files[0];e.setFile(a);var n=new FileReader;n.onloadend=function(){var t=n.result;if(a.name.endsWith(".csv")){var r=new RegExp("\\r","g"),s=t.replace(r,"").split("\n");e.setContentHeader(s[0]),s.splice(0,1),e.setContentBody(s)}if(a.name.endsWith(".json")){var i=n.result;e.setContentPlain(i)}},n.readAsText(a)}}),null!==e.contentBody&&null!==e.contentHeader&&Object(ne.jsx)(we.a,{children:Object(ne.jsxs)(we.a.Item,{eventKey:"0",children:[Object(ne.jsx)(we.a.Header,{children:ae().file_content}),Object(ne.jsx)(we.a.Body,{style:{overflow:"scroll",height:"70vh"},children:Object(ne.jsxs)(ye.a,{responsive:!0,striped:!0,bordered:!0,hover:!0,children:[Object(ne.jsx)("thead",{children:Object(ne.jsx)("tr",{children:r.a.Children.toArray(e.contentHeader.split(",").map((function(e){return Object(ne.jsx)("th",{children:e})})))})}),Object(ne.jsx)("tbody",{children:r.a.Children.toArray(e.contentBody.map((function(e){return Object(ne.jsx)("tr",{children:r.a.Children.toArray(e.split(",").map((function(e){return Object(ne.jsx)("td",{children:e})})))})})))})]})})]})}),null!==e.contentPlain&&Object(ne.jsx)(we.a,{children:Object(ne.jsxs)(we.a.Item,{eventKey:"0",children:[Object(ne.jsx)(we.a.Header,{children:ae().file_content}),Object(ne.jsx)(we.a.Body,{style:{overflow:"scroll",height:"70vh"},children:e.contentPlain})]})}),Object(ne.jsx)(h.a,{variant:"primary",type:"submit",children:ae().submit},"submit"),"\xa0\xa0\xa0",Object(ne.jsx)(h.a,{variant:"secondary",onClick:e.backFunction,children:ae().cancel},"cancel")]})},bt=a(109);function pt(e){var t=Object(p.p)().resource,a=Object(b.c)(),r=Object(j.a)(a,2),s=r[0];r[1];void 0!==e.resource&&(t=e.resource);var i,c=Object(p.n)(),o=Object(n.useState)("form"),u=Object(j.a)(o,2),h=u[0],f=u[1],O=Object(n.useState)(""),m=Object(j.a)(O,2),v=m[0],x=m[1],g=Object(n.useState)(bt(X[t])),y=Object(j.a)(g,2),_=y[0],C=y[1],S=Object(n.useState)(void 0),N=Object(j.a)(S,2),A=N[0],I=N[1],z=Object(n.useState)(null),D=Object(j.a)(z,2),R=D[0],T=D[1],F=Object(n.useState)(null),E=Object(j.a)(F,2),L=E[0],B=E[1],G=Object(n.useState)(null),W=Object(j.a)(G,2),H=W[0],M=W[1],U=Object(n.useContext)(tt);i=void 0!==U?U.fetched:{};var J=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i.data[t]){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,P(t,{limit:100});case 5:a=e.sent,i.UpdateData(a.docs.map((function(e){return e._id})),t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();if(Object(n.useEffect)((function(){void 0!==te[t]&&Object.values(te[t]).forEach((function(e){return J(e)}))}),[]),Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var a,n,r,s,i=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,P(t,a);case 3:n=e.sent,r=n.docs[0],s=bt(_),s=ct(s=it(r,s),X,t),C(s);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(null!==s.get("from")&&""!==s.get("from")){var a={_id:s.get("from")};e({filter:JSON.stringify(a)})}}),[s,t]),void 0===X[t])return Object(ne.jsx)("div",{children:"This entity cannot be posted"});var K=function(e){e.preventDefault(),c(-1)},q=function(){var e=Object(d.a)(Object(l.a)().mark((function e(a){var n,r,s,i,o;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n=void 0,void 0!==(r=bt(_)).token&&(n=r.token,delete r.token),s=bt(r),Pe(s),e.prev=6,e.next=9,k(t,JSON.stringify(s),n);case 9:o=e.sent,i=o.response,x(i.statusText),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(6),console.log(e.t0),i=e.t0.error.response,x(e.t0.error.response.data.message+" : "+e.t0.error.response.data.details);case 19:200===i.status&&!0===window.confirm("Back to resource page?")&&c("tenants"===t?"/":"/"+t);case 20:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(d.a)(Object(l.a)().mark((function e(a){var n,r,s,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!A.name.endsWith(".csv")){e.next=17;break}return(r=new FormData).append("file",A),e.prev=4,e.next=7,w(t,r);case 7:s=e.sent,n=s.response,x(n.statusText),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0),n=e.t0.error.response,x(e.t0.error.response.data.message+" : "+e.t0.error.response.data.details);case 17:if(!A.name.endsWith(".json")){e.next=31;break}return e.prev=18,e.next=21,k(t,H,void 0);case 21:i=e.sent,n=i.response,x(n.statusText),e.next=31;break;case 26:e.prev=26,e.t1=e.catch(18),console.log(e.t1),n=e.t1.error.response,x(e.t1.error.response.data.message+" : "+e.t1.error.response.data.details);case 31:200===n.status&&!0===window.confirm("Back to resource page?")&&c("/"+t);case 32:case"end":return e.stop()}}),e,null,[[4,12],[18,26]])})));return function(t){return e.apply(this,arguments)}}();return Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsxs)("header",{className:"page-header",children:["Add resource \xa0",Object(ne.jsx)("b",{children:t})]}),Object(ne.jsxs)("main",{className:"page-content",children:[Object(ne.jsxs)(ut.a,{justify:!0,variant:"tabs",className:"justify-content-center",onSelect:function(e){return f(e)},defaultActiveKey:"form",children:[$[t].includes("form")&&Object(ne.jsx)(ut.a.Item,{children:Object(ne.jsx)(ut.a.Link,{eventKey:"form",children:"Form"})}),$[t].includes("file")&&null===s.get("from")&&Object(ne.jsx)(ut.a.Item,{children:Object(ne.jsx)(ut.a.Link,{eventKey:"file",children:"File"})})]}),Object(ne.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"2px",borderStyle:"solid",borderColor:"rgba(18, 54, 81, 0.9)",borderWidth:"1px",width:"100%",height:"fit-content"},children:["form"===h&&Object(ne.jsxs)("div",{style:{margin:"5px"},children:[Object(ne.jsx)(rt,{values:_,resource:t,functionalFields:X,disabledFields:{},handleChangesCallback:function(e,a){var n,r=bt(_),s=r,i=-1;for(n=0;n<a.length-1;n++)s=s[a[n]],"number"===typeof a[n]&&(i=n);s[a[n]]=e,"number"===typeof a[n]&&(i=n),-1!==i&&(r=ot(r,a.slice(0,i),X,t)),C(r)},arrayDeleteCallback:function(e){var a,n=bt(_),r=n;for(a=0;a<e.length-1&&void 0!==e[a];a++)r=r[e[a]];r.splice(e[a],1),n=ot(n,e.slice(0,a),X,t),C(n)},submitFunction:q,backFunction:K}),Object(ne.jsx)("br",{}),Object(ne.jsx)("font",{style:{marginLeft:"5px"},children:v})]}),"file"===h&&Object(ne.jsxs)("div",{style:{margin:"5px"},children:[Object(ne.jsx)(jt,{submitFunction:V,backFunction:K,setContentBody:B,setContentHeader:T,setContentPlain:M,setFile:I,contentPlain:H,contentHeader:R,contentBody:L}),Object(ne.jsx)("font",{style:{marginLeft:"5px"},children:v})]})]})]})]})}je.a.library.add(be.h);a(109);var ht=function(e){if(void 0===e.values||void 0===e.submitFunction||void 0===e.handleAddItemArray||void 0===e.handleRemoveItemArray||void 0===e.items||void 0===e.getAddress||void 0===e.msg||void 0===e.handleChanges||void 0===e.refreshLocation||void 0===e.addrMsg)return"Loading";return Object(ne.jsxs)(He.a,{fluid:!0,style:{paddingRight:"20px",paddingLeft:"20px"},children:[function t(a,n){return r.a.Children.toArray(Object.entries(a).map((function(a){var s=Object(u.a)(n);if(s.push(a[0]),"address"===a[0]||"indirizzo"===a[0])return Object(ne.jsxs)(Me.a,{style:{paddingBottom:"10px"},children:[Object(ne.jsx)(Ue.a,{xs:9,children:Object(ne.jsxs)(se.a.Group,{children:[Object(ne.jsx)(se.a.Control,{type:"text",value:a[1],onChange:function(t){t.preventDefault(),e.handleChanges(t.target.value,s)},placeholder:ae().enter+" "+a[0]}),Object(ne.jsx)(se.a.Text,{className:"text-muted",children:e.addrMsg})]})}),Object(ne.jsx)(Ue.a,{xs:!0,children:Object(ne.jsx)(h.a,{variant:"link",onClick:Object(d.a)(Object(l.a)().mark((function t(){return Object(l.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.refreshLocation();case 2:case"end":return t.stop()}}),t)}))),children:Object(ne.jsx)("i",{className:"fa fa-map-pin","aria-hidden":"true",title:"Refresh Position",style:{width:"20px",height:"20px",marginRight:"10px",opacity:.85}})})})]});if("et\xe0"===a[0])return Object(ne.jsx)(Me.a,{style:{paddingBottom:"10px"},children:Object(ne.jsx)(Ue.a,{xs:9,children:Object(ne.jsx)(se.a.Group,{children:Object(ne.jsx)(se.a.Control,{type:"number",min:14,max:150,value:isNaN(a[1])?"":a[1],onChange:function(t){t.preventDefault(),e.handleChanges(parseInt(t.target.value,10),s)},"aria-label":ae().enter+" "+a[0],placeholder:ae().enter+" "+a[0]})})})});if("time"===a[0]||"ora"===a[0])return Object(ne.jsx)(Me.a,{style:{paddingBottom:"10px"},children:Object(ne.jsx)(Ue.a,{xs:9,children:Object(ne.jsx)(se.a.Group,{children:Object(ne.jsx)(se.a.Control,{type:"time",className:"modalTextField",value:a[1],onChange:function(t){t.preventDefault(),e.handleChanges(t.target.value,s)},"aria-label":ae().enter+" "+a[0],placeholder:ae().enter+" "+a[0]})})})});if("index"===a[0])return"";if("note"===a[0])return Object(ne.jsx)(Me.a,{style:{paddingBottom:"10px"},children:Object(ne.jsx)(Ue.a,{xs:12,children:Object(ne.jsx)(se.a.Group,{children:Object(ne.jsx)(se.a.Control,{as:"textarea",rows:3,type:"text",value:a[1],onChange:function(t){t.preventDefault(),e.handleChanges(t.target.value,s)},placeholder:ae().enter+" "+a[0]})})})});if("date"===a[0]||"data"===a[0]){var i=new Date;return Object(ne.jsx)(Me.a,{style:{paddingBottom:"10px"},children:Object(ne.jsx)(Ue.a,{xs:9,children:Object(ne.jsx)(se.a.Control,{type:"date",defaultValue:[i.toLocaleString("default",{year:"numeric"}),i.toLocaleString("default",{month:"2-digit"}),i.toLocaleString("default",{day:"2-digit"})].join("-"),onChange:function(t){var a=new Date(t.target.value).getTime();e.handleChanges(a,s)},"aria-label":ae().enter+" "+a[0]})})})}var c=e.items.filter((function(e){return"enum"===e.type&&e.name===a[0]}))[0],o=null;return void 0!==c&&(o=c.range),null!==o?Object(ne.jsx)(Me.a,{style:{paddingBottom:"10px"},children:Object(ne.jsx)(Ue.a,{xs:9,children:Object(ne.jsxs)(se.a.Select,{xs:9,"aria-label":ae().select+" "+a[0],value:a[1],onChange:function(t){t.preventDefault(),e.handleChanges(t.target.value,s)},children:[Object(ne.jsx)("option",{value:"",children:ae().select+" "+a[0]}),r.a.Children.toArray(o.map((function(e){return Object(ne.jsx)("option",{value:e,children:e})})))]})})}):Array.isArray(a[1])?r.a.Children.toArray(a[1].map((function(r,s){var i=Object(u.a)(n);return i.push(a[0]),i.push(s),Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(we.a,{children:Object(ne.jsxs)(we.a.Item,{children:[Object(ne.jsxs)(we.a.Header,{children:["persone"===a[0]?"Persona":"Sostanza"," ",s+1]}),Object(ne.jsxs)(we.a.Body,{children:[Object(ne.jsx)(Me.a,{style:{paddingBottom:"10px"},children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(h.a,{variant:"outline-danger",onClick:function(t){t.preventDefault(),e.handleRemoveItemArray(i)},style:{textDecoration:"none"},children:[Object(ne.jsx)("i",{className:"fa fa-minus-circle","aria-hidden":"true",title:"Remove",style:{width:"25px",height:"25px",opacity:.85}}),"\xa0Rimuovi\xa0","persone"===a[0]?"persona":"sostanza","\xa0",s+1]})})}),t(r,i),s===a[1].length-1&&Object(ne.jsx)(Me.a,{children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsxs)(h.a,{variant:"link",onClick:function(t){t.preventDefault(),e.handleAddItemArray(i)},style:{textDecoration:"none"},children:[Object(ne.jsx)("i",{className:"fa fa-plus-circle","aria-hidden":"true",title:"Add",style:{width:"25px",height:"25px",opacity:.85}}),"\xa0Aggiungi\xa0","persone"===a[0]?"persona":"sostanza"]})})})]})]})})})}))):Object(ne.jsx)(Me.a,{children:a[0]+a[1]})})))}(e.values,[]),Object(ne.jsx)(Me.a,{style:{padding:"10px"},children:Object(ne.jsx)(Ue.a,{children:Object(ne.jsx)(h.a,{variant:"primary",onClick:e.submitFunction,children:ae().submit})})}),Object(ne.jsx)("font",{children:e.msg})]})};je.a.library.add(be.g);var ft=a(109),Ot="controllo",mt=[],vt=r.a.createRef();function xt(e){var t="measurements",a=Object(b.c)(),r=Object(j.a)(a,2),s=r[0],i=(r[1],Object(n.useState)([])),c=Object(j.a)(i,2),o=(c[0],c[1],Object(n.useState)([])),h=Object(j.a)(o,2),f=h[0],O=h[1],m=Object(n.useState)({}),v=Object(j.a)(m,2),x=v[0],g=v[1],y=Object(n.useState)(""),w=Object(j.a)(y,2),_=w[0],C=w[1],S=Object(p.n)(),N=Object(n.useState)(""),A=Object(j.a)(N,2),I=A[0],z=(A[1],Object(n.useContext)(tt).fetched),D=function(){var e=Object(d.a)(Object(l.a)().mark((function e(t){var a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===z.data[t]){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,P(t,{limit:100});case 5:a=e.sent,z.UpdateData(a.docs.map((function(e){return e._id})),t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();if(Object(n.useEffect)((function(){void 0!==te[t]&&Object.values(te[t]).forEach((function(e){return D(e)}))}),[]),Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t,a,n,r,s,i,c,o,d;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={_id:Ot},a={filter:JSON.stringify(t)},e.prev=2,e.next=5,P("features",a);case 5:n=e.sent,r=n.docs[0],s=B(),i=r.items,c=new Date,o=c.getHours().toString().padStart(2,"0")+":"+c.getMinutes().toString().padStart(2,"0"),d={indirizzo:s,note:"",data:Date.now(),ora:o,veicolo:"",persone:[{index:0,"et\xe0":NaN,genere:"","nazionalit\xe0":"",risultato:""}]},g(d),O(i),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),console.log(e.t0);case 19:return e.abrupt("return");case 20:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(){return e.apply(this,arguments)}}();e()}),[e,s]),Object(n.useEffect)((function(){null!==vt.current&&g(vt.current)})),void 0===X[t])return Object(ne.jsx)("div",{children:"This entity cannot be posted"});var R=function e(t,a,n){var r=Object(u.a)(a),s=!0;return t.constructor===Object&&Object.values(t).forEach((function(t){Array.isArray(t)?(s=!1,t.forEach((function(t){return e(t,r,n)}))):r.push(t)})),!0===s&&n.push(r),n},T=function(){var e=Object(d.a)(Object(l.a)().mark((function e(a){var n,r,s,i,c,o,d,u;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n=void 0,r=f.filter((function(e){return"sostanza"===e.name}))[0].range,""!==(s=ft(x)).note&&void 0!==s.note&&null!==s.note||(s.note="--"),!(s.persone.filter((function(e){return isNaN(e["et\xe0"])||e["et\xe0"]<14||e["et\xe0"]>150})).length>0)){e.next=9;break}return window.alert("Errore, non \xe8 stato possibile salvare i dati. Controllare di aver specificato tutte le voci correttamente"),e.abrupt("return");case 9:return s.persone.forEach((function(e){r.forEach((function(t){void 0===e.sostanze&&(e.sostanze=[]),!1===e.sostanze.map((function(e){return e.sostanza})).includes(t)&&e.sostanze.push({sostanze:t,livello:"nullo"})}))})),i=R(s,[],[]),c=i.map((function(e){return{values:e}})),(o={}).feature=Ot,o.tags=mt,o.thing="Genova",o.device="think-before-device",o.samples=c,void 0!==o.token&&(n=o.token,delete o.token),e.prev=19,e.next=22,k(t,JSON.stringify(o),n);case 22:u=e.sent,d=u.response,e.next=32;break;case 26:e.prev=26,e.t0=e.catch(19),console.log(e.t0),vt.current=x,d=e.t0.error.response,window.alert("Errore, non \xe8 stato possibile salvare i dati. Controllare di aver specificato tutte le voci correttamente");case 32:200===d.status&&(vt.current=null,window.alert("Controllo caricato con successo"),S("/add/measurements"));case 33:case"end":return e.stop()}}),e,null,[[19,26]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.geolocation?navigator.geolocation.getCurrentPosition(function(){var e=Object(d.a)(Object(l.a)().mark((function e(n){var r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.coords.latitude,a=n.coords.longitude,e.prev=2,e.next=5,F(t,a);case 5:r=L(),g(r),C(ae().geo_update),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("Error while connecting to Geolocalization APIs"),console.log(e.t0),C(ae().geo_failed);case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()):(console.log("Geolocation is not supported by this browser."),C(ae().geo_failed));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=ft(x);return void 0!==e.indirizzo&&(e.indirizzo=B()),void 0!==e.address&&(e.address=B()),e},B=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=localStorage.getItem("continent"),n=localStorage.getItem("continentCode"),r=localStorage.getItem("countryName"),s=localStorage.getItem("countryCode"),i=localStorage.getItem("principalSubdivision"),c=localStorage.getItem("city"),o=localStorage.getItem("locality");return!0===e?!0===t?n+" - "+s+" - "+i+" - "+c+" - "+o:a+" - "+r+" - "+i+" - "+c+" - "+o:c+" - "+o};return Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsxs)("header",{className:"page-header",children:["Aggiungi\xa0",Object(ne.jsx)("b",{children:"Controllo"})]}),Object(ne.jsx)("main",{children:Object(ne.jsx)(ht,{values:x,items:f,submitFunction:T,backFunction:function(e){e.preventDefault(),S(-1)},getAddress:B,msg:I,handleAddItemArray:function(e){vt.current=null;for(var t=ft(x),a=t,n=null,r=0;r<e.length-1;r++)a=a[e[r]],n=e[r];"sostanze"===n&&a.push({sostanza:"",livello:""}),"persone"===n&&a.push({index:a.length,"et\xe0":NaN,genere:"","nazionalit\xe0":"",risultato:""}),g(t)},handleRemoveItemArray:function(e){vt.current=null;var t,a=ft(x),n=a;for(t=0;t<e.length-1&&void 0!==e[t];t++)n=n[e[t]];1!==n.length&&(n.splice(e[t],1),g(a))},handleChanges:function(e,t){vt.current=null;var a,n=ft(x),r=n;for(a=0;a<t.length-1;a++)r=r[t[a]],"number"===typeof t[a]&&a;t[a],r[t[a]]=e,"risultato"===t[a]&&"positivo"===e&&(r.sostanze=[{sostanza:"",livello:""}]),g(n)},refreshLocation:E,addrMsg:_})})]})}var gt=a(231);a(122);je.a.library.add(be.j,be.d);var yt=["Luogo","Mezzo","Anni","Sesso","Nazionalit\xe0","Data","Ora","Risultato","Sostanza","Livello","Note"];function wt(e){var t="measurements",a=Object(b.c)(),r=Object(j.a)(a,2),s=r[0],i=r[1],c=Object(n.useState)(void 0),o=Object(j.a)(c,2),u=o[0],p=o[1],f=Object(n.useState)(void 0),O=Object(j.a)(f,2),m=O[0],v=O[1],x=Object(n.useState)(void 0),g=Object(j.a)(x,2),y=g[0],w=g[1],_=Object(n.useState)(1),k=Object(j.a)(_,2),C=k[0],S=k[1],N=Object(n.useState)(1),A=Object(j.a)(N,2),I=(A[0],A[1]),z=Object(n.useState)(),R=Object(j.a)(z,2),T=R[0],F=R[1],E=Object(n.useState)(),L=Object(j.a)(E,2),B=L[0],G=L[1],W=Object(n.useState)(),H=Object(j.a)(W,2),M=H[0],U=H[1],J=Object(n.useState)(),K=Object(j.a)(J,2),q=(K[0],K[1]),V=Object(n.useState)(),Y=Object(j.a)(V,2),Q=Y[0],X=Y[1],Z=Object(n.useState)(""),$=Object(j.a)(Z,2),ee=$[0],te=$[1],ae=Object(n.useState)(!1),re=Object(j.a)(ae,2),se=re[0],ie=re[1];Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var a,n,r,s,i,c=arguments;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>0&&void 0!==c[0]?c[0]:{},e.prev=1,e.next=4,P(t,a);case 4:n=e.sent,r=n.docs.map((function(e){return e.samples})),s=r.map((function(e){if("positivo"===e[0].values[9]){var t=e.filter((function(e){return"nullo"!==e.values[11]}));if(0===t.length){var a=e[0];return a.values[10]="Non specificato",a.values[11]="Non specificato",a}return t}var n=e[0];return n.values[10]="--",n.values[11]="NA",[n]})),i=s.flat().map((function(e){return e.values})).map((function(e){return{Luogo:e[0],Mezzo:e[4],Anni:e[6],Sesso:e[7],"Nazionalit\xe0":e[8],Data:e[2],Ora:e[3],Risultato:e[9],Sostanza:e[10],Livello:e[11],Note:e[1]}})),console.log(i),v(yt),p(i),w([]),F(n.hasNextPage),G(n.hasPrevPage),X(n.totalPages),U(n.prevPage),q(n.nextPage),e.next=29;break;case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0),v(void 0),p(void 0),F(void 0),G(void 0),X(void 0),U(void 0),q(void 0);case 29:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(){return e.apply(this,arguments)}}(),a=null!==s.get("page")?s.get("page"):1;S(a);var n=null!==s.get("limit")?s.get("limit"):10;I(n);var r=null!==s.get("sortBy")?s.get("sortBy"):"",i=null!==s.get("order")?s.get("order"):"";""!==r&&(r="samples.values."+["Luogo","Note","Data","Ora","Mezzo","ID","Anni","Sesso","Nazionalit\xe0","Risultato","Sostanza","Livello"].indexOf(r)),e({page:a,limit:n,sort:{order:i,by:r}}).catch(console.error)}),[e,t,s]);var ce=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t,a,n,r,s,i;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("measurements",{});case 2:t=e.sent,a=new RegExp(/}{/g),n=t.data.replace(a,"},{"),r=JSON.parse("["+n+"]").map((function(e){return e.samples})).map((function(e){if("positivo"===e[0].values[9]){var t=e.filter((function(e){return"nullo"!==e.values[11]}));if(0===t.length){var a=e[0];return a.values[10]="Non specificato",a.values[11]="Non specificato",a}return t}var n=e[0];return n.values[10]="--",n.values[11]="NA",[n]})).flat().map((function(e){return e.values})).map((function(e){return{Luogo:e[0],Mezzo:e[4],Anni:e[6],Sesso:e[7],"Nazionalit\xe0":e[8],Data:e[2],Ora:e[3],Risultato:e[9],Sostanza:e[10],Livello:e[11],Note:e[1]}})),s=Re(r,yt),i=new Blob([s],{type:"text/plain;charset=utf-8"}),Object(gt.saveAs)(i,"Dati_Pensaci_Prima.csv");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=parseInt(C,10)-2>0,t=parseInt(C,10)+2<Q;return Object(ne.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:Object(ne.jsxs)(Ge.a,{style:{alignSelf:"center",marginLeft:"auto",marginRight:"auto"},children:[Object(ne.jsx)(Ge.a.First,{disabled:1===C,onClick:function(){s.set("page",1),i(s)}}),Object(ne.jsx)(Ge.a.Prev,{disabled:!B,onClick:function(){s.set("page",M),i(s)}}),e&&Object(ne.jsx)(Ge.a.Ellipsis,{}),parseInt(C,10)-1>0&&Object(ne.jsx)(Ge.a.Item,{onClick:function(){s.set("page",parseInt(C,10)-1),i(s)},children:parseInt(C,10)-1}),Object(ne.jsx)(Ge.a.Item,{children:Object(ne.jsx)("b",{children:C})}),parseInt(C,10)+1<=Q&&Object(ne.jsx)(Ge.a.Item,{onClick:function(){s.set("page",parseInt(C,10)+1),i(s)},children:parseInt(C,10)+1}),t&&Object(ne.jsx)(Ge.a.Ellipsis,{}),Object(ne.jsx)(Ge.a.Next,{disabled:!T,onClick:function(){s.set("page",parseInt(C,10)+1),i(s)}}),Object(ne.jsx)(Ge.a.Last,{disabled:C===Q,onClick:function(){s.set("page",Q),i(s)}})]})})};return Object(ne.jsxs)("div",{className:"page",children:[Object(ne.jsxs)("header",{className:"page-header",children:[Object(ne.jsx)("b",{children:"Analizza dati raccolti"}),Object(ne.jsx)(h.a,{variant:"link",size:"sm",onClick:function(e){e.preventDefault(),ce()},children:Object(ne.jsx)("i",{className:"fa fa-download","aria-hidden":"true",title:"Download",style:{width:"30px",height:"30px",opacity:.85}})})]}),Object(ne.jsxs)("main",{className:"page-content",children:[Object(ne.jsx)("br",{}),Object(ne.jsx)(Te,{resType:t,header:m,resources:u,actions:y,takeSingle:function(e){return u.find((function(t){return t._id===e}))},removeSingle:function(e){var t=u.filter((function(t){return t._id!==e}));p(t)},orderBy:ee,ascending:se,sortHandler:function(e){var t=s.get("order"),a=!1;null===t||"ascending"===t?t="descending":(t="ascending",a=!0),s.set("sortBy",e),s.set("order",t),te(e),ie(a),i(s)}}),Object(ne.jsx)(oe,{})]})]})}var _t=function(){var e=Object(n.useState)([]),t=Object(j.a)(e,2),a=t[0],s=t[1],i=Object(n.useState)(),h=Object(j.a)(i,2),f=h[0],O=h[1],m=Object(n.useState)({}),v=Object(j.a)(m,2),x=v[0],y=v[1],w=(r.a.useRef(),localStorage.getItem("token")),_=localStorage.getItem("city");function k(e){s((function(t){return[e].concat(t)}))}function C(e){var t=Object(u.a)(a);t.splice(e,1),s(t)}function S(){s([])}var N={notifications:a,PushNotification:k,RemoveNotification:C,ClearNotifications:S};g.ClearNotifications=S,g.PushNotification=k,g.RemoveNotification=C,Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.geolocation){e.next=12;break}return navigator.geolocation.getCurrentPosition((function(e){t=e.coords.latitude,a=e.coords.longitude})),e.prev=2,e.next=5,F(t,a);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log("Error while connecting to Geolocalization APIs");case 10:e.next=13;break;case 12:console.log("Geolocation is not supported by this browser.");case 13:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}();if(null===_)try{e()}catch(t){console.log(t)}}),[]),Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(Object(l.a)().mark((function e(){var t;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P("types",{},"");case 3:t=e.sent,O(t.response.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();if(void 0===f)try{e()}catch(t){console.log(t)}}),[]);var A={types:f,data:x,UpdateData:function(e,t){y((function(a){return Object(o.a)(Object(o.a)({},a),{},Object(c.a)({},t,Object(u.a)(e)))}))}};return null===w?Object(ne.jsx)("div",{className:"app",children:Object(ne.jsx)(b.a,{children:Object(ne.jsxs)(p.d,{children:[Object(ne.jsx)(p.b,{path:"/",element:Object(ne.jsx)(le,{})}),Object(ne.jsx)(p.b,{path:"/passwordrecovery",element:Object(ne.jsx)(Qe,{})}),Object(ne.jsx)(p.b,{path:"/passwordreset",element:Object(ne.jsx)(et,{})}),Object(ne.jsx)(p.b,{path:"/add/tenants",element:Object(ne.jsx)(pt,{resource:"tenants"})})]})})}):Object(ne.jsx)(tt.Provider,{value:{notifications:N,fetched:A},children:Object(ne.jsx)(b.a,{children:Object(ne.jsx)(He.a,{fluid:!0,style:{paddingLeft:"0px",paddingRight:"0px",minHeight:"100vh"},children:Object(ne.jsxs)(Me.a,{style:{padding:"0px",height:1==/Mobi/i.test(window.navigator.userAgent)?"auto":"100vh"},children:[Object(ne.jsx)(Ue.a,{md:"auto",style:{padding:"0px"},children:Object(ne.jsx)(ge,{})}),Object(ne.jsx)(Ue.a,{style:{paddingLeft:"0px",paddingRight:"0px"},children:Object(ne.jsxs)(p.d,{children:[Object(ne.jsx)(p.b,{path:"/",element:Object(ne.jsx)(p.a,{replace:!0,to:"/add/measurements"})}),Object(ne.jsx)(p.b,{path:"/home",element:Object(ne.jsx)(de,{})}),Object(ne.jsx)(p.b,{path:"/viewProfile",element:Object(ne.jsx)(Ke,{})}),Object(ne.jsx)(p.b,{path:"/analyzedata",element:Object(ne.jsx)(wt,{})}),Object(ne.jsx)(p.b,{path:"/add/measurements/",element:Object(ne.jsx)(xt,{})}),Object(ne.jsx)(p.b,{path:"/edit/:resource/:id",element:Object(ne.jsx)(dt,{})}),Object(ne.jsx)(p.b,{path:"/add/:resource/",element:Object(ne.jsx)(pt,{})}),Object(ne.jsx)(p.b,{path:"/:page",element:Object(ne.jsx)(We,{res:":page"})}),Object(ne.jsx)(p.b,{path:"/unauthorized",element:Object(ne.jsx)(qe,{})}),Object(ne.jsx)(p.b,{path:"/404",element:Object(ne.jsx)(ue,{})}),Object(ne.jsx)(p.b,{path:"*",element:Object(ne.jsx)(p.a,{to:"/404",replace:!0})})]})})]})})})})};i.a.render(Object(ne.jsx)(r.a.StrictMode,{children:Object(ne.jsx)(_t,{})}),document.getElementById("root"))}},[[371,1,2]]]);
//# sourceMappingURL=main.1f4ca6a0.chunk.js.map